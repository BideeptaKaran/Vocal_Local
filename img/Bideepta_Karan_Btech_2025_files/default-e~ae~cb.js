"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[7961,2350],{1808:(e,t,i)=>{i.d(t,{$n:()=>v,Ch:()=>y,LO:()=>w,aT:()=>k,oo:()=>b,z9:()=>C,HC:()=>S});var s=i(10334),n=i(17171),r=i(69384),a=i(50659),o=i(80074),l=i(87574),c=i(19840),d=i(62723),h=i(7813),p=i(22835),u=i(93712),m=i(22409);const g=JSON.parse('{"clearfix":"_de888339-button-clearfix","button":"_d86f7794-button-button","inline":"_f8f10003-button-inline","red":"_78aa7372-button-red","blue":"_e90c689b-button-blue","buttonSpinner":"_62c49ae1-button-buttonSpinner","hasSpinner":"_c76ec4d3-button-hasSpinner","large":"_1c786aa6-button-large","medium":"_747b3bf4-button-medium","small":"_9e07cc2c-button-small","transparent":"_554b3c64-button-transparent","disabled":"_98c6ad03-button-disabled"}'),_=({onClick:e=(()=>{}),disabled:t=!1,propagateClick:i=!1})=>{const s=function(e){return"boolean"!=typeof e?e:o.s.create(e)}(t),n=o.s.create(!1),r=function(e,t,i,r){return i=>{if(r||i.stopPropagation(),s.get()||n.get())return Promise.resolve();let a;t(!0);try{a=e(i)}catch(i){throw t(!1),i}const o=Promise.resolve(a);return o.then((e=>t(!1))).catch((e=>t(!1))),o}}(e,(e=>n.set(e)),0,i);return{onClick:r,isDisabled:s.pipe(d.z(n,((e,t)=>e||t)))}},f=["size","color","transparent","className"],y=e=>{var{children:t=null,onClick:i=(()=>{}),onMouseOver:o=(()=>{}),onMouseLeave:d=(()=>{}),onMouseOut:p=(()=>{}),disabled:u=!1,className:m="",role:f="button",name:y,id:v,style:b={},tabIndex:S=0,propagateClick:k,ariaLabel:C,ariaLabelledBy:w,mount:E,inline:x}=e,M=(0,r._)(e,["children","onClick","onMouseOver","onMouseLeave","onMouseOut","disabled","className","role","name","id","style","tabIndex","propagateClick","ariaLabel","ariaLabelledBy","mount","inline"]);const T=_({onClick:i,disabled:u,propagateClick:k});return a.createElement(l.F.div,(0,n._)((0,s._)((0,n._)((0,s._)({},M),{mount:E,"aria-label":C,"aria-labelledby":w,"data-name":y,style:b}),(0,c.Ly)(m,Boolean(x)?g.inline:void 0)),{disabled:T.isDisabled,onClick:T.onClick,onKeyPress:e=>{[h.D.ENTER_CODE,h.D.SPACE_CODE].includes(e.charCode)&&(e.preventDefault(),T.onClick(e))},onMouseOver:o,onMouseLeave:d,onMouseOut:p,role:f,tabIndex:S}),t)},v=e=>{const{children:t=null,className:i=""}=e,s=Object.assign(p.$i(e,f),x(i,e)),n=E(e);return a.createElement(y,s,t,n)},b=({className:e="",onClick:t=(()=>{}),disabled:i=!1,value:s="",style:n={},children:r=null,propagateClick:o})=>{const c=_({onClick:t,disabled:i,propagateClick:o});return a.createElement(l.F.button,{type:"submit",style:n,disabled:c.isDisabled,className:e,onClick:c.onClick},s,r)},S=e=>{const{children:t=null,className:i=""}=e,s=Object.assign(p.$i(e,f),x(i,e)),n=E(e);return a.createElement(b,s,t,n)},k=({name:e,id:t,ariaLabelledBy:i,href:s="",target:n="",children:r=null,className:o="",onClick:c=(()=>{}),disabled:d=!1,style:h={},download:p,propagateClick:m})=>{const{onClick:g,isDisabled:f}=_({onClick:c,disabled:d,propagateClick:m}),y=a.useContext(u.OH.Context),v=!0!==p||y.has(u.OH.Flag.canUseDownloadAttr)?n:"_blank";return a.createElement(l.F.a,{"data-name":e,"aria-labelledby":i,id:t,href:s,target:v,style:h,disabled:f,className:o,onClick:g,download:p},r)},C=e=>{const{children:t=null,className:i=""}=e,s=Object.assign(p.$i(e,f),x(i,e)),n=E(e);return a.createElement(k,s,t,n)},w=e=>{var{checked:t,children:i}=e,o=(0,r._)(e,["checked","children"]);return a.createElement(y,(0,n._)((0,s._)({},o),{role:"checkbox","aria-checked":t,onClick:()=>t.modify((e=>!e))}),i)};function E({showSpinnerWhenDisabled:e=!1,transparent:t=!1,size:i="medium"}){return e?a.createElement(m.y,{color:t?void 0:"#fff",className:g.buttonSpinner,size:"small"===i?14:18}):null}function x(e,{size:t="medium",color:i="red",transparent:s=!1,showSpinnerWhenDisabled:n=!1}){return(0,c.Ly)(g.button,g[t],g[i],s&&g.transparent,n&&g.hasSpinner,e)}},11871:(e,t,i)=>{i.d(t,{k:()=>h});var s=i(23988),n=i(50659),r=i(86922),a=i(5692),o=i(81870),l=i(74056),c=i(98719);const d=JSON.parse('{"P":"_630bf5cf-upload-uploadContainer","S":"_2c13a91d-upload-upload"}');class h extends o.$G{componentWillUnmount(){this.props.documentUpload.navigated()}render(){const{hideTooltip:e,ariaHidden:t}=this.props;return n.createElement(l.OH.Context.Consumer,null,(i=>n.createElement(r.S.Context.Consumer,null,(s=>{return n.createElement("input",{ref:this._onMount,id:"upload","data-name":"upload-element",type:"file",tabIndex:-1,accept:(r=i.info.browser,"safari"===r?c.jj.Pm.join(","):c.jj.$G.join(",")),title:s.tooltipUploadElementInput,multiple:this.props.multiple,className:Boolean(e)?d.S:d.P,onChange:this._onChange(),"aria-label":s.tooltipUploadElementInput,"aria-hidden":t});var r}))))}constructor(...e){super(...e),(0,s._)(this,"_inputElement",void 0),(0,s._)(this,"_onMount",(e=>{var t,i;null===(t=(i=this.props).mount)||void 0===t||t.call(i,e),null!=e&&(this._inputElement=e,this._inputElement.onchange=e=>this._onChange()(e))})),(0,s._)(this,"_onChange",(()=>e=>{Boolean(e.persist)&&e.persist();const t="dataTransfer"in e?e.dataTransfer.files:e.target.files;if(!Boolean(t)||!t.length||a.j.isInProgress(this.props.documentUpload.state.get()))return;const i=this.props.documentUpload.upload({files:t,notify:1===t.length,allowMultiple:this.props.multiple,isDragNDrop:!1}).then((()=>{this._inputElement.value=""}));void 0!==this.props.onUpload&&this.props.onUpload(i)}))}}},63839:(e,t,i)=>{i.d(t,{M:()=>_});var s=i(10334),n=i(17171),r=i(69384),a=i(50659),o=i(30040),l=i(19840),c=i(36840),d=i(44297),h=i(38908),p=i(35426);const u=e=>null!=e.href&&e.href.startsWith("/"),m=e=>null!=e.href&&e.href.includes(document.location.host)||u(e),g=e=>"_blank"===e.target,_=(0,l.yY)((e=>{var{children:t}=e,i=(0,r._)(e,["children"]);const{link:{description:l}}=a.useContext(p.k.Context),_=u(i)?new URL(i.href,document.location.href).href:i.href;return(0,o.pipe)(i,(()=>(0,c.M4)(m,g)(i)?d.some(l.internalNewWindow):(0,c.M4)((0,o.not)(m),g)(i)?d.some(l.externalNewWindow):(0,o.not)(m)(i)?d.some(l.external):d.none),d.map((e=>{const r=h.G7(5);return a.createElement(a.Fragment,null,a.createElement("span",{hidden:!0,id:r},e),a.createElement("a",(0,n._)((0,s._)({},i),{"aria-describedby":r}),t))})),d.getOrElse((()=>a.createElement("a",(0,n._)((0,s._)({},i),{href:_}),t))))}))},86780:(e,t,i)=>{i.d(t,{l:()=>c});var s=i(41797),n=i(53354),r=i(6987),a=i(3346),o=i(69063),l=i(74056);function c(e,t){const i=t.has(l.OH.Flag.useSetDataOnCopy);return(t,l)=>s.H(n.B.copy(t,i)).pipe(r.n((()=>e.enqueue("copySuccess",{copyType:l}))),a.W((t=>(n.B.copyApiAvailable.next(!1),o.Bx.Logging.getLogger("clipboard").warn("Copy to clipboard failed",t),e.enqueue("copyToClipboardFailed"))))).toPromise()}},35384:(e,t,i)=>{i.d(t,{gw:()=>z});var s=i(10334),n=i(17171),r=i(50659),a=i(30040),o=i(87574),l=i(19840),c=i(78323),d=i(86922),h=i(19967),p=i(14973),u=i(65873),m=i(91987),g=i(19772),_=i(84714),f=i(44297),y=i(86562),v=i(69063),b=i(16721),S=i(98719),k=i(18286),C=i(704),w=i(80152),E=i(77167),x=i(11864),M=i(72747),T=i(27199),A=i(64723);const I={position:"absolute",right:0,bottom:0,zIndex:M.C9,display:"flex",margin:`0 ${x.Ks.rem(.5)} ${x.Ks.rem(1)} 0`,padding:x.Ks.rem(2),width:x.Ks.rem(27),background:T.Q1.CoreNeutral0,alignItems:"flex-start"},B={width:x.Ks.rem(17)},P={marginTop:x.Ks.rem(1)},F={color:w.Q.Text.Base.Subdued,fontWeight:"normal"},N={$nest:{"& button:not(:last-of-type)":{marginRight:x.Ks.rem(E.v$)}}},R={display:"flex",flexDirection:"column",margin:`${x.Ks.rem(2)} 0 ${x.Ks.rem(-1)} ${x.Ks.rem(1)}`,width:x.Ks.rem(5),height:x.Ks.rem(5),borderRadius:x.Ks.percent(50),boxShadow:"0 0 48px 0 rgba(96, 101, 123, .08)",justifyContent:"center",alignItems:"center"},L={position:"fixed",right:x.Ks.rem(4)},D={marginRight:x.Ks.rem(-.5)},O={position:"fixed",right:x.Ks.rem(14),bottom:"auto"},H={$nest:{"@media (max-height: 767px)":(0,s._)({},D),"@media (min-height: 768px)":(0,s._)({},O)}},K=(0,n._)((0,s._)({},O),{bottom:0}),$=(0,n._)((0,s._)({},K),{marginRight:x.Ks.rem(2),right:x.Ks.rem(4)}),V={$nest:{"@media (min-height: 768px)":(0,n._)((0,s._)({},O),{top:x.Ks.rem(24)})}},U={$nest:{"@media (min-height: 768px)":(0,n._)((0,s._)({},O),{top:x.Ks.rem(28)})}},G={$nest:{"@media (min-height: 768px)":(0,n._)((0,s._)({},O),{top:x.Ks.rem(32)})}},Q=(0,n._)((0,s._)({},O),{bottom:0}),W=(0,n._)((0,s._)({},Q),{marginRight:x.Ks.rem(2),right:x.Ks.rem(4)}),q=x.Ks.stylesheet({wrapper:[{position:"relative",width:0,height:0}],container:[A.nK,I],messageContainer:[B],buttonsContainer:[P],laterButton:[F],imageContainer:[R],baseTitle:[{fontWeight:"bold"}],closedSidebar:[L],fixedNotification:[H],outcomesPlagiarismSidebarOpen:[K],outcomesPlagiarismSidebarClosed:[$],engagement:[V],delivery:[U],gbVoxUphook:[G],proofitSidebarOpen:[Q],proofitSidebarClosed:[W],footerButtons:[N]}),z=e=>r.createElement(o.F.div,{className:e.isSidebarOpen.view((e=>e?"":q.closedSidebar))},e.navigationViewModel.popover.view((0,a.flow)(f.map((t=>{switch(t){case _.Qh.ProofitHook:return r.createElement(Y,(0,n._)((0,s._)({},e),{key:"proofit"}));case _.Qh.PlagiarismHook:return r.createElement(Z,(0,n._)((0,s._)({},e),{key:"plagiarism"}));default:return(0,y.xb)(t)}})),f.toNullable))),j=({title:e,description:t,visible:i,children:n,footer:a,className:c,overlayType:d})=>r.createElement(o.F.div,{className:q.wrapper},r.createElement(p.hJ,{positionType:"fixed",visible:i,alignment:"none",overlayType:d}),i.view((i=>i&&r.createElement(o.F.div,(0,s._)({key:"container",role:"status","aria-live":"polite","data-name":"freemium-notification"},(0,l.Ly)(q.container,c)),r.createElement("div",{className:q.messageContainer},r.createElement(u.tu,{className:q.baseTitle},e),r.createElement(u.C6,null,t),r.createElement(h.$n.Group,{className:q.buttonsContainer},a)),r.createElement("div",{className:q.imageContainer},n))))),J=e=>{const{gnarSpec:t,pageId:i}=r.useContext(b.Y.Context),a={pageId:i,upgradeHookName:C.P.UpgradeHookName.Tooltip,upgradeHookSlot:e.metricSlot,upgradeHookVariant:e.upgradeViewModel.isEligibleForPro?C.P.UpgradeHookVariant.pro:e.upgradeViewModel.isEligibleForFreeTrial?C.P.UpgradeHookVariant.premiumTrial:C.P.UpgradeHookVariant.premium},o=v.Bx.TimeSeries.rootFemetrics.getMetric(C.P.Metrics.GetPremiumButton).getCounter(C.P.MetricsActions.Show).setContext(a),l=v.Bx.TimeSeries.rootFemetrics.getMetric(C.P.Metrics.GetPremiumButton).getCounter(C.P.MetricsActions.Click).setContext(a),d=k.J.create(t),p={pageId:i,bannerType:"goPremium",placement:e.trackingPlacement,upgradeHookName:"tooltip",upgradeHookSlot:e.metricSlot,upgradeHookVariant:e.upgradeViewModel.isEligibleForPro?"pro":e.upgradeViewModel.isEligibleForFreeTrial?"premiumTrial":"premium"},u=g.R.useVisibilityObserverOnce((()=>{o.increment(),d.trackShow(p),e.upgradeViewModel.isEligibleForFreeTrialEuUk&&e.upgradeViewModel.assignToFreeTrialEuUkExperiment(),e.upgradeViewModel.assignToProVsPremiumExperiment()})),_=e.navigationViewModel.popover.lens(c.J2.create(f.exists((t=>t===e.type)),(e=>((0,y.V1)(!Boolean(e),"Positive values shouldn't be set through Option.clear lens"),f.none))));return r.createElement(j,(0,n._)((0,s._)({},e),{visible:_,className:e.className,overlayType:null!=e.overlayType?e.overlayType:"transparent",footer:r.createElement("div",{ref:u,className:q.footerButtons},r.createElement(m.R,{size:"small",isEligibleForFreeTrial:e.upgradeViewModel.isEligibleForFreeTrial,isEligibleForPro:e.upgradeViewModel.isEligibleForPro,upgradeAction:()=>{l.increment(),d.trackClick(p),e.upgradeViewModel.openUpgradeUrl(e.place)}}),r.createElement(h.$n.Ghost,{name:"later",className:q.laterButton,onClick:()=>{d.trackDismiss(p),_.set(!1)}},"Maybe later"))}))},Y=e=>{const t=r.useContext(d.S.Context);return r.createElement(J,{isSidebarOpen:e.isSidebarOpen,type:_.Qh.ProofitHook,upgradeViewModel:e.upgradeViewModel,navigationViewModel:e.navigationViewModel,title:t.proofitTitle,description:t.proofitDescription,place:S.YT.Place.DenaliDocument.editorDenaliProofit,className:Boolean(e.className)?e.className:e.isSidebarOpen.view((e=>e?q.proofitSidebarOpen:q.proofitSidebarClosed)),overlayType:e.overlayType,trackingPlacement:"proofreadingTooltip",metricSlot:C.P.UpgradeHookSlot.ProofreadingTooltip},r.createElement(X,null))},Z=e=>{const t=r.useContext(d.S.Context);return r.createElement(J,{isSidebarOpen:e.isSidebarOpen,type:_.Qh.PlagiarismHook,upgradeViewModel:e.upgradeViewModel,navigationViewModel:e.navigationViewModel,title:t.plagiarism.title,description:t.freemiumNotifications.plagiarism,place:S.YT.Place.DenaliDocument.editorDenaliPlagiarism,className:Boolean(e.className)?e.className:e.isSidebarOpen.view((e=>e?q.outcomesPlagiarismSidebarOpen:q.outcomesPlagiarismSidebarClosed)),overlayType:e.overlayType,trackingPlacement:"plagiarismTooltip",metricSlot:C.P.UpgradeHookSlot.PlagiarismTooltip},r.createElement(ee,null))},X=()=>r.createElement("svg",{"aria-hidden":!0,width:"78",height:"79",viewBox:"0 0 78 79"},r.createElement("defs",null,r.createElement("path",{d:"M30.333 58.933c16.753 0 30.334-13.192 30.334-29.466S47.086 0 30.333 0C13.581 0 0 13.193 0 29.467s13.58 29.466 30.333 29.466z",id:"profproofreadersimg-path"})),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("g",{transform:"translate(2 2)"},r.createElement("path",{d:"M6.33 44.008c2.564 7.611 16.385 17.525 29.127 17.525C51.773 61.533 65 48.53 65 32.488 65 16.447 48.648 4.311 36.516 2.983c-8.395-.919-11.41-.345-18.512 3.497-4.216 2.28-7.884 6.083-10.256 9.605-2.569 3.814-4.281 11.482-4.281 16.403 0 3.514 1.719 8.403 2.863 11.52z",fill:"#B8D3FA"}),r.createElement("mask",{id:"profproofreadersimg-mask",fill:"#fff"},r.createElement("use",{xlinkHref:"#profproofreadersimg-path"})),r.createElement("path",{stroke:"#555C6A",strokeWidth:"2",d:"M30.333 59.933C13.035 59.933-1 46.3-1 29.467-1 12.634 13.035-1 30.333-1c17.299 0 31.334 13.634 31.334 30.467S47.632 59.933 30.333 59.933z"}),r.createElement("path",{d:"M29.843 47.74L31 51.519 26.81 67c-8.664-1.11-15.147-2.6-19.45-4.473 0 0-1.308-.306-1.36-3.263 0 0 .47-5.809 4.499-11.621 0 0 1.15-1.53 3.87-2.55l8.696-3.687a5.183 5.183 0 0 0 1.345-1.17c.041-.053.099-.131.172-.236l-.172 10.523 5.433-2.783zm24.59-.228c4.09 5.858 4.568 11.71 4.567 11.71-.053 2.98-1.38 3.29-1.38 3.29-2.61 1.126-9.133 2.622-19.573 4.488L34 51.523l1.24-3.84 4.908 2.836L40.366 40c.281.357.518.602.71.735.086.097.352.277.437.37.193.145.407.288.637.431 2.902 1.806 8.352 3.408 8.352 3.408 2.763 1.027 3.931 2.568 3.931 2.568zM40 36.076V37c0 2.5-4.5 8-7.688 8-3.188 0-7.312-5.5-7.263-8 .016-.5.016-.643 0-.924-1.271-1.628-2.286-2.805-2.845-4.803-1.451 0-1.82-5.804-1.451-6.707-.043-.098-.078-3.484.35-7.296 0 0 .204-7.073 7.397-8.27 1.005 1.073 9.547-2.5 9.547 3.5C45 9 44.453 24.284 44.358 24.566c.31.478 0 6.707-1.695 6.707-.562 1.537-1.64 3.463-2.663 4.803z",fill:"#FFF",mask:"url(#profproofreadersimg-mask)"})),r.createElement("g",{transform:"translate(43 44)"},r.createElement("ellipse",{stroke:"#555C6A",strokeWidth:"2",fill:"#FFF",strokeLinecap:"square",cx:"15.714",cy:"15.963",rx:"16.714",ry:"16.963"}),r.createElement("ellipse",{fill:"#68DEC2",style:{mixBlendMode:"multiply"},cx:"18.571",cy:"17.414",rx:"16.429",ry:"16.688"}),r.createElement("path",{stroke:"#FFF",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",d:"M7.857 17.274l5.501 5.724L25 10.884"})))),ee=()=>r.createElement("svg",{"aria-hidden":!0,width:"32",height:"32",viewBox:"0 0 32 32"},r.createElement("defs",null,r.createElement("rect",{id:"plariarismoutcomesimg-rect",width:"22",height:"22",rx:"4"}),r.createElement("path",{id:"plariarismoutcomesimg-path",d:"M22 10v8a4 4 0 0 1-4 4h-8v-8a4 4 0 0 1 4-4h8z"}),r.createElement("filter",{id:"plariarismoutcomesimg-filter",width:"350%",height:"350%",x:"-125%",y:"-125%",filterUnits:"objectBoundingBox"},r.createElement("feOffset",{in:"SourceAlpha",result:"shadowOffsetOuter1"}),r.createElement("feGaussianBlur",{in:"shadowOffsetOuter1",result:"shadowBlurOuter1",stdDeviation:"5"}),r.createElement("feColorMatrix",{in:"shadowBlurOuter1",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.5 0"}))),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("use",{fill:"#5CDAE6",transform:"translate(10 10)",xlinkHref:"#plariarismoutcomesimg-rect"}),r.createElement("mask",{id:"plariarismoutcomesimg-mask",fill:"#fff"},r.createElement("use",{xlinkHref:"#plariarismoutcomesimg-rect"})),r.createElement("use",{fill:"#99F6FF",xlinkHref:"#plariarismoutcomesimg-rect"}),r.createElement("g",{mask:"url(#plariarismoutcomesimg-mask)"},r.createElement("use",{fill:"#000",filter:"url(#plariarismoutcomesimg-filter)",xlinkHref:"#plariarismoutcomesimg-path"}),r.createElement("use",{fill:"#79E8F2",xlinkHref:"#plariarismoutcomesimg-path"}))))},24476:(e,t,i)=>{i.d(t,{wY:()=>J});var s=i(10334),n=i(17171),r=i(50659),a=i(30040),o=i(87574),l=i(11864),c=i(86922),d=i(64191),h=i(56122),p=i(77272),u=i(92954),m=i(78799),g=i(16624),_=i(15491),f=i(35426),y=i(27917),v=i(83683);const b=JSON.parse('{"iE":"_bcdd7f0f-change-plan-wrapper","Qs":"_df5b0caf-change-plan-content","Kk":"_91fa5628-change-plan-icon","zJ":"_fa313941-change-plan-iconPremium","Qq":"_17f5ec07-change-plan-text","aF":"_7ed7ecad-change-plan-changePlanBtn","q9":"_cd54690c-change-plan-price"}');var S;!function(e){const t={content:{wrapper:b.iE,icon:b.Kk}};e.View=({notification:e,savedPrice:i,onClose:a,onChangePlan:o})=>{const l=r.useContext(c.S.Context).changePlan.hook;return r.createElement(d.Rx.Wrapper,{notification:e,onClose:a,theme:t},r.createElement(d.Rx.Content,null,r.createElement("div",{className:b.Qs},r.createElement(y.In.Paid,{width:18,className:b.zJ}),r.createElement("div",{className:b.Qq},l.title,r.createElement(u.U,{onClick:o,name:"changePlanNotification",className:b.aF},r.createElement("b",null,l.button.switchTo,r.createElement("span",{className:b.q9},l.button.price(r.createElement(v.J9,(0,n._)((0,s._)({},i.pricePerYear),{periodInMonths:12}))))))))))}}(S||(S={}));var k=i(19967),C=i(65873),w=i(19772),E=i(72747),x=i(27199);l.Ks.style({display:"flex",flexDirection:"column",width:"100vw",height:"100vh",background:x.Q1.CoreNeutral1,justifyContent:"center",alignItems:"center"});const M=l.Ks.style({padding:l.Ks.rem(1.5),width:l.Ks.rem(E.NE-E.PG),borderRadius:l.Ks.rem(E.Am),background:x.Q1.CoreNeutral0,boxShadow:x.eu.Z300,transform:`translateX(${l.Ks.rem(-1*(E.xS-E.xu+E.PG))})`,$nest:{[`@media (${E.P9})`]:{width:l.Ks.rem(E.rQ-E.PG)}}}),T=l.Ks.style({display:"flex",marginBottom:l.Ks.rem(1)}),A=(l.Ks.style({marginBottom:l.Ks.rem(1)}),l.Ks.style({marginBottom:l.Ks.rem(1),fontWeight:700})),I=(l.Ks.style({marginLeft:l.Ks.rem(.5)}),l.Ks.style({maxWidth:"100%"})),B=l.Ks.style({paddingRight:l.Ks.rem(.5),paddingLeft:l.Ks.rem(.5)}),P=l.Ks.joinClasses([l.Ks.style({marginRight:l.Ks.rem(.5),marginLeft:l.Ks.rem(-.5),textTransform:"none",letterSpacing:"normal",fontSize:l.Ks.rem(x.EY.BodySize)}),B]);var F;!function(e){e.View=({name:e,title:t,description:i,cta:s,dismiss:n,topPart:a,rightPart:o,onCTA:l,onDismiss:c,onShow:d})=>(w.R.useEffectOnDidMount((()=>d&&d())),r.createElement("section",{className:M},a,r.createElement("div",{className:T},r.createElement("div",null,r.createElement(C.C6,{className:A},t),r.createElement(C.C6,null,i)),o),r.createElement("div",{className:I},r.createElement(k.$n.Ghost,{name:e,className:P,onClick:l},s),r.createElement(k.$n.Flat,{name:`dismiss.${e}`,className:B,onClick:c},n))))}(F||(F={}));var N=i(90883),R=i(34717);const L=({expiryDate:e,notification:t,onShow:i,onDismiss:s,onUpdateBilling:n})=>{const a=r.useContext(c.S.Context).gbBillingMigration,o=R.Local.fullDate(R.Local.Timestamp.toLocal(e.getTime()));return r.useEffect(i),r.createElement(d.Rx.Wrapper,{notification:t,onClose:s},r.createElement("div",null,r.createElement(C.H4,{className:D.title},a.title),r.createElement(N.h,null),r.createElement(C.C6,{className:D.description},a.description(o)),r.createElement(N.h,null),r.createElement(u.U,{name:"addBillingInformation",onClick:n,className:D.cta},a.cta)))},D=l.Ks.prefixedStylesheet("gb_billing_migration_notification",{title:[{color:x.Q1.CoreNeutral0,lineHeight:l.Ks.rem(1.5)}],description:[{color:x.Q1.CoreNeutral0}],cta:[{fontWeight:600}]});var O=i(63839);const H=({notification:e,onClose:t,link:i})=>{const s=r.useContext(c.S.Context).gbRuleCreated;return r.createElement(d.q0.Wrapper,{notification:e,onClose:t},r.createElement(d.Rx.Content,null,r.createElement("div",{className:U.wrapper},r.createElement("div",{className:U.content},r.createElement("div",null,s.ruleSaved),r.createElement(O.M,{href:i,target:"_blank",className:U.link},s.viewStyleGuide)))))},K={display:"flex",marginTop:l.Ks.rem(-1.1),marginBottom:l.Ks.rem(-.8),alignItems:"center",justifyContent:"space-between"},$={maxWidth:l.Ks.rem(14),wordWrap:"break-word",flexBasis:"auto",flexGrow:1,paddingTop:l.Ks.rem(.5),paddingRight:l.Ks.rem(2)},V={color:x.Q1.CoreBlue40,textDecoration:"none"},U=l.Ks.stylesheet({wrapper:[K],content:[$],link:[V]}),G=JSON.parse('{"iE":"_2e5a3ce8-mute_onboarding-wrapper","$_":"_a28a5f5f-mute_onboarding-media","h_":"_1473303e-mute_onboarding-description","HM":"_7b75030f-mute_onboarding-btn"}');var Q;!function(e){e.CardMute=({onClose:e,onShow:t})=>{const s=i(92935),n=i(76387),a=r.useContext(c.S.Context).mutedAlerts.onboarding.cardMute;return r.useEffect((()=>t())),r.createElement("div",{className:G.iE},r.createElement("video",{className:G.$_,muted:!0,autoPlay:!0,loop:!0,src:s,poster:n}),r.createElement(C.C6,{className:G.h_},a.description),r.createElement(u.U,{name:"gotItMutedOnboarding",className:G.HM,onClick:e},a.buttonText))}}(Q||(Q={}));var W=i(92198);const q=JSON.parse('{"iE":"_d758f5a3-premium_ungating_renewal-wrapper","Qs":"_9401003f-premium_ungating_renewal-content","Kk":"_69d16f6c-premium_ungating_renewal-icon","Qp":"_42a43110-premium_ungating_renewal-iconInfo","iU":"_098c5236-premium_ungating_renewal-message","DD":"_6cb71434-premium_ungating_renewal-title","TD":"_3487f016-premium_ungating_renewal-manageSubscriptionBtn"}');var z;!function(e){const t={content:{wrapper:q.iE,icon:q.Kk}};e.View=({trialEndDate:e,notification:i,onManageSubscription:s,onClose:n})=>{const o=r.useContext(c.S.Context).premiumUngatingRenewalNotification,l=R.Local.fullDate(R.Local.Timestamp.toLocal(e.getTime())),h=(0,a.flow)(s,n);return r.createElement(d.Rx.Wrapper,{notification:i,onClose:n,theme:t},r.createElement(d.Rx.Content,null,r.createElement("div",{className:q.Qs},r.createElement(y.In.Info,{width:18,className:q.Qp}),r.createElement("div",{className:q.iU},r.createElement("div",{className:q.DD},o.title),o.message(l),r.createElement(u.U,{onClick:h,name:"manageSubscription",className:q.TD},o.cta)))))}}(z||(z={}));const j=()=>r.createElement("svg",{"aria-hidden":!0,width:"300",height:"120",viewBox:"0 0 200 100",xmlns:"http://www.w3.org/2000/svg"},r.createElement("defs",null,r.createElement("radialGradient",{cy:"51.039%",fx:"50%",fy:"51.039%",r:"53.934%",gradientTransform:"matrix(0 1 -.99155 0 1.006 .01)",id:"a"},r.createElement("stop",{stopColor:"#03C1E2",offset:"0%"}),r.createElement("stop",{stopColor:"#0279D8",offset:"100%"}))),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M180.34 114.801c0 25.152-20.564 45.544-45.933 45.544-25.366 0-45.932-20.392-45.932-45.544 0-25.154 20.566-45.544 45.932-45.544 25.369 0 45.933 20.39 45.933 45.544",fill:"#15C39A"}),r.createElement("path",{d:"M143.47 120.973c-1.91 0-3.417 1.705-3.06 3.662.272 1.49 1.686 2.513 3.214 2.513h4.813l2.79-.389c-4.464 6.493-12.214 9.481-20.688 8.163-6.898-1.074-12.823-5.701-15.323-12.165-5.676-14.67 5.13-28.678 19.211-28.678 7.34 0 13.774 4.259 17.465 9.403.002 0 .004.107.004.111.98 1.4 2.92 1.802 4.333.83a3.03 3.03 0 0 0 .905-4.053h.022c-5.105-7.901-14.277-12.957-24.592-12.272-13.43.893-24.298 11.79-25.07 25.115-.898 15.505 11.506 28.164 26.933 28.164 8.104 0 15.36-3.499 20.302-9.16l-.585 3.247v2.935c0 1.513 1.029 2.917 2.533 3.186 1.975.352 3.692-1.143 3.692-3.036v-17.576H143.47",fill:"#FFF",fillRule:"nonzero"}),r.createElement("g",{transform:"translate(3 69.257)"},r.createElement("ellipse",{stroke:"#FFF",strokeWidth:"2.649",fill:"url(#a)",cx:"45.765",cy:"45.378",rx:"47.089",ry:"46.703"}),r.createElement("path",{fill:"#EDEDED",d:"M40.217 39.83l33.05-21.955-21.955 33.05-33.05 21.956z"}),r.createElement("path",{fill:"#FE4E4D",d:"M40.217 39.83l33.05-21.955-21.955 33.05z"}),r.createElement("path",{fillOpacity:".199",fill:"#1C1E29",d:"M73.268 17.875l-21.956 33.05-33.05 21.956z"}),r.createElement("path",{d:"M46.637 77.791v6.483H45.11V77.79h1.526zm-17.783-4.666l1.321.756-3.269 5.614-1.32-.756 3.268-5.614zm33.822 0l3.269 5.614-1.322.756-3.268-5.614 1.32-.756zM17.128 61.023l.763 1.31-5.662 3.242-.763-1.31 5.662-3.242zm57.273 0l5.662 3.242-.762 1.31-5.662-3.242.762-1.31zm10.59-16.293v1.513h-6.537V44.73h6.538zm-71.915 0v1.513H6.538V44.73h6.538zM79.41 25.369l.762 1.31-5.662 3.241-.762-1.31 5.662-3.241zm-67.29 0l5.662 3.241-.763 1.31-5.662-3.241.763-1.31zm52.692-14l1.321.757-3.269 5.614-1.32-.756 3.268-5.615zm-38.094 0l3.268 5.615-1.32.756-3.27-5.614 1.322-.757zm19.919-4.886v6.482H45.11V6.483h1.526z",fill:"#F3F5FA"})),r.createElement("g",null,r.createElement("path",{d:"M76.732 36.02h35.03a2.55 2.55 0 0 0 2.205-3.833L96.452 2.074a2.55 2.55 0 0 0-4.409 0L74.528 32.187a2.55 2.55 0 0 0 2.204 3.832z",fill:"#EA1537"}),r.createElement("path",{d:"M95.86 17.988l-.695 6.792h-1.859l-.694-6.792v-5.483h3.247v5.483zm.024 12.028h-3.272v-3.285h3.272v3.285z",fill:"#FFF",fillRule:"nonzero"})))),J=(0,n._)((0,s._)({},p.k),{alertUndo:(e,t)=>r.createElement(m.Q.Flexible,{notification:e,onClose:t("closedByUser"),action:t("undo"),params:e.args.params}),textRemoved:(e,t)=>r.createElement(ee,{action:t("undo")}),cardMuteOnboarding:(e,t)=>r.createElement(Q.CardMute,{onShow:t("shown"),onClose:t("closedByUser")}),premiumOnboardingSurvey:(e,t)=>r.createElement(g.a,{viewModel:e.args.viewModel,onClose:t("closedByUser")}),changePlanCta:(e,t)=>r.createElement(S.View,{notification:e,savedPrice:e.args.model.savedPrice,onClose:t("closedByUser"),onChangePlan:t("changePlan")}),gbBillingMigration:(e,t)=>r.createElement(L,{notification:e,expiryDate:e.args.expiryDate,onShow:t("shown"),onUpdateBilling:t("cta"),onDismiss:t("closedByUser")}),changePlanSuccess:e=>r.createElement(te,{planName:e.args.planName}),premiumUngatingRenewal:(e,t)=>r.createElement(z.View,{trialEndDate:e.args.trialEndDate,notification:e,onClose:t("closedByUser"),onManageSubscription:t("ctaManageSubscription")}),gbSatisfactionSurvey:(e,t)=>r.createElement(h.w,{viewModel:e.args.viewModel,onClose:t("closedByUser"),onComplete:t("completeSurvey")}),safariExtActivation:(e,t)=>r.createElement(X,{cta:t("activate"),close:t("closedByUser"),onShow:t("shown")}),obtainGrades:(e,t)=>r.createElement(W.j.ObtainGrades,{onShow:t("shown"),onClose:t("closedByUser"),notification:e,viewModel:e.args.viewModel}),citationStyleChange:e=>r.createElement(ie,{citationStyle:e.args.citationStyle}),gbRuleCreated:(e,t)=>r.createElement(H,{notification:e,onClose:t("closedByUser"),link:e.args.link}),safari12EndSupport:()=>r.createElement(Y,null),logoutError:e=>r.createElement(Z,e.args)}),Y=()=>{const e=r.useContext(c.S.Context);return r.createElement(d.Rx.TitledContent,{title:e.safari12EndSupport.title},e.safari12EndSupport.description(l.Ks.style({color:"#fff"})))},Z=({timeToRetry:e,resetHandler:t})=>{const i=r.useContext(f.k.Context);return r.createElement(d.Rx.TitledContent,{title:i.account.logoutError.title},r.createElement(o.F.Fragment,null,(0,a.pipe)(e,_.T((e=>-1!==e?r.createElement("div",{key:"logoutErrorNotification"},i.account.logoutError.subtitle,r.createElement("br",null),r.createElement(u.U,{onClick:t},i.account.logoutError.retrying(e))):r.createElement("div",{key:"logoutErrorNotification"},i.account.logoutError.fatalDescription))))))},X=({cta:e,close:t,onShow:i})=>{const{safariExtActivationNotification:s,actions:n}=r.useContext(c.S.Context);return r.createElement(F.View,{title:s.title,description:s.description,cta:s.cta,dismiss:n.close,name:"safariExtActivationNotification",onCTA:e,onDismiss:t,onShow:i,rightPart:r.createElement(j,null)})},ee=({action:e})=>{const t=r.useContext(c.S.Context);return r.createElement(d.Rx.Content,null,r.createElement(m.Q.Content,{action:e,content:t.textRemoved}))},te=({planName:e})=>{const t=r.useContext(c.S.Context).changePlan;return r.createElement(d.Rx.Content,null,t.successfulNotificationCopy(e))},ie=({citationStyle:e})=>{const t=r.useContext(c.S.Context);return r.createElement(d.Rx.Content,null,t.citation.citationStyleChangeNotification.content(t.goals.sections.format.formatTitle(e)))}},85921:(e,t,i)=>{i.d(t,{L:()=>p});var s=i(10334),n=i(17171),r=i(50659),a=i(19840),o=i(86922),l=i(11864),c=i(36840),d=i(27199),h=i(1808);const p=({checked:e,name:t,className:i,ariaLabelledBy:l})=>{const d=r.useContext(o.S.Context);return r.createElement(h.LO,(0,n._)((0,s._)({name:t,"aria-checked":e,ariaLabelledBy:l},(0,a.Ly)(e.view((0,c.Sw)(u.switchButtonOn,u.switchButtonOff)),i)),{checked:e}),r.createElement("span",{"aria-hidden":!0,className:u.on},d.on),r.createElement("span",{"aria-hidden":!0,className:u.off},d.off))};var u;!function(e){const t=l.Ks.rem(1.25),i=e=>({"&:hover":{backgroundColor:e},"&:hover::before":{borderColor:e}}),r=l.Ks.rem(.15),a={$debugName:"switchButton",position:"relative",display:"inline-flex",minWidth:l.Ks.rem(3),height:l.Ks.rem(1.25),borderRadius:t,backgroundColor:d.Q1.CoreNeutral50,color:d.Q1.CoreNeutral0,letterSpacing:l.Ks.rem(.04625),fontSize:l.Ks.rem(.625),cursor:"pointer",transition:l.Ks.seconds(.4),alignItems:"center",userSelect:"none",outline:"none",$nest:(0,s._)({"&::before":{position:"absolute",left:0,width:t,height:t,borderWidth:r,borderStyle:"solid",borderColor:d.Q1.CoreNeutral50,borderRadius:l.Ks.percent(50),backgroundColor:d.Q1.CoreNeutral0,content:"''",transition:l.Ks.seconds(.4),boxSizing:"border-box"},"&:focus":{boxShadow:`0 0 0 1px ${d.Q1.CoreNeutral0}, 0 0 0 3px ${d.Q1.CoreBlue40}`,zIndex:1},"&:focus:not(:focus-visible)":{boxShadow:"none",$unique:!0},"&:focus-visible":{boxShadow:`0 0 0 1px ${d.Q1.CoreNeutral0}, 0 0 0 3px ${d.Q1.CoreBlue40}`,zIndex:1,$unique:!0}},i(d.Q1.CoreNeutral40))},o={position:"relative",textAlign:"center",textTransform:"uppercase",fontWeight:"bold"};var c=e.on=l.Ks.style(o,{width:l.Ks.rem(2.125)}),h=e.off=l.Ks.style(o,{width:l.Ks.rem(1.5),marginLeft:t});const p=(e,t)=>({[`& .${c}`]:e,[`& .${h}`]:t}),u={display:"none"},m={display:"inline-block"};e.switchInput=l.Ks.style({position:"absolute",opacity:0}),e.switchButtonOn=l.Ks.style(a,{backgroundColor:d.Q1.CoreBlue50,$nest:(0,s._)((0,n._)((0,s._)({},p(m,u)),{"&::before":{transform:`translateX(${l.Ks.rem(1.75)})`,borderColor:d.Q1.CoreBlue50}}),i(d.Q1.CoreBlue40))}),e.switchButtonOff=l.Ks.style(a,{$nest:p(u,m)})}(u||(u={}))},92444:(e,t,i)=>{i.d(t,{x:()=>y});var s=i(10334),n=i(17171),r=i(11864),a=i(29120),o=i(27199);const l=e=>({[`&-${e}`]:{marginLeft:r.Ks.rem(3+1.5*e)}}),c=(e,t)=>({counterIncrement:`list${e}`,counterReset:t}),d=(e,t)=>({"&:before":{content:`counter(list${e}, ${t}) '. '`}}),h=(e,t,i)=>({[`&-${e}`]:(0,n._)((0,s._)({},c(e,i)),{$nest:d(e,t)})}),p="editor-",u={editorContainer:`${p}editorContainer`,rtfLink:`${p}rtfLink`,bigSize:`${p}bigSize`},m=`0 0 ${r.Ks.rem(.5)}`,g=(e,t,i)=>({margin:m,fontSize:r.Ks.rem(e),lineHeight:r.Ks.rem(t),$nest:{"&:not(:first-child)":{marginTop:r.Ks.rem(i)}}}),_={position:"relative",overflow:"hidden",minHeight:r.Ks.rem(5),outline:"none",border:"none",resize:"none",$nest:{"& p":{margin:0,padding:0},"& h1":g(1.375,2,2),"& h2":g(1.125,1.7,1),"& ol, & ul":{margin:`0 0 ${r.Ks.rem(.5)}`,paddingLeft:0},"& ol:not(:first-child), & ul:not(:first-child)":{marginTop:r.Ks.rem(.5)},"& li":{margin:`0 0 0 ${r.Ks.rem(3)}`,paddingRight:0,listStyleType:"none",$nest:{"&:before":{display:"inline-block",marginRight:r.Ks.rem(.5),marginLeft:r.Ks.rem(-3),width:r.Ks.rem(2.5),textAlign:"right",whiteSpace:"nowrap",lineHeight:r.Ks.rem(1.375)},[`.${u.bigSize} &`]:{$nest:{"&:before":{lineHeight:r.Ks.rem(1.65)}}}}},"& .ql-indent":{$nest:(0,s._)({},l(1),l(2),l(3),l(4),l(5),l(6),l(7),l(8))},'& ol li[data-list="bullet"]':{$nest:{"&:before":{content:"'\\2022'"}}},"& ol li[data-list='dashed']":{$nest:{"&:before":{content:"'-'"}}},'& ol li[data-list="ordered"]':(0,n._)((0,s._)({},c(0,"list1 list2 list3 list4 list5 list6 list7 list8")),{listStyleType:"none",$nest:(0,n._)((0,s._)({},d(0,"decimal")),{"&.ql-indent":{$nest:(0,s._)({},h(1,"lower-alpha","list2 list3 list4 list5 list6 list7 list8"),h(2,"lower-roman","list3 list4 list5 list6 list7 list8"),h(3,"decimal","list4 list5 list6 list7 list8"),h(4,"lower-alpha","list5 list6 list7 list8"),h(5,"lower-roman","list6 list7 list8"),h(6,"decimal","list7 list8"),h(7,"lower-alpha","list8"),h(8,"lower-roman","none"))}})}),[`& .${u.rtfLink}`]:{color:o.Q1.CoreBlue50,$nest:{"&:visited":{color:o.Q1.CoreBlue50}}}}},f={fontSize:r.Ks.rem(1.375),lineHeight:r.Ks.rem(2.5),$nest:{"& h1":{fontSize:r.Ks.rem(1.65),lineHeight:r.Ks.rem(3)},"& h2":{fontSize:r.Ks.rem(1.375),lineHeight:r.Ks.rem(2.5)}}},y={editorContainer:r.Ks.joinClasses([u.editorContainer,r.Ks.style(_),r.Ks.style({paddingBottom:"40vh"}),a.b.style(_)]),bigSize:r.Ks.joinClasses([u.bigSize,r.Ks.style(f),a.b.style(f)]),rtfLink:r.Ks.joinClasses([u.rtfLink])}},64723:(e,t,i)=>{i.d(t,{nK:()=>a});var s=i(11864),n=i(72747),r=i(27199);r.eu.Z100,s.Ks.rem(n.H0),r.eu.Z200;const a={borderRadius:s.Ks.rem(n.H0),boxShadow:r.eu.Z300}},67804:(e,t,i)=>{i.d(t,{RG:()=>y,nF:()=>n,xg:()=>s});var s,n,r=i(23988),a=i(10334),o=i(17171),l=i(89606),c=i(30040),d=i(63336),h=i(98384),p=i(10047),u=i(44297),m=i(34717),g=i(58889),_=i(29052),f=i(36840);!function(e){e.Monthly="Monthly",e.Quarterly="Quarterly",e.Annual="Annual"}(s||(s={})),function(e){const t=p.TS({annual:u.none,quarterly:u.none,monthly:u.none},((e,t)=>{switch(t.periodMonths){case 1:return(0,o._)((0,a._)({},e),{monthly:u.some(t)});case 3:return(0,o._)((0,a._)({},e),{quarterly:u.some(t)});case 12:return(0,o._)((0,a._)({},e),{annual:u.some(t)});default:return e}}));function i(e,t){return{pricePerYear:{value:e-t.value,currency:t.currency},percent:`${Math.round(100*(e-t.value)/e)}%`}}e.createOfferBasedOnAnnual=(0,c.flow)(t,(0,l.J)(u.Applicative),u.map((({annual:e,quarterly:t,monthly:s})=>({price:e.priceMoney,regularPrice:e.regularPriceMoney,discountPercent:"0%",periodInMonths:12,title:"Annual",savePricedBySwitchingFrom:{monthly:i(12*s.priceMoney.value,e.priceMoney),quarterly:i(4*t.priceMoney.value,e.priceMoney)}}))))}(n||(n={}));class y{get isMonthly(){return 1===this.currentPlan.periodMonths}get isQuarterly(){return 3===this.currentPlan.periodMonths}get savedPrice(){return this.isMonthly?this.offer.savePricedBySwitchingFrom.monthly:this.offer.savePricedBySwitchingFrom.quarterly}get currentPlanType(){return this.isMonthly?s.Monthly:this.isQuarterly?s.Quarterly:s.Annual}get daysToRenewal(){const e=this.nextPaymentDate.getTime(),t=m.Local.now().getTime();return Math.floor(Math.max(0,e-t)/m.ei)}get shouldShowOffer(){return!!y.enableDebugModeToShowOffer||this.willSubscriptionRenewSoon&&!this.hasAlreadyChangedToAnnual&&!this._isOnTrial}get hasAlreadyChangedToAnnual(){return(0,d.pipe)(this._queuedPlan,u.exists((({periodMonths:e})=>12===e)))}get willSubscriptionRenewSoon(){const e=this.daysToRenewal<2*m.f9;return(this.isMonthly||this.isQuarterly)&&e}static create({currentPlan:e,queuedPlan:t,nextPayDate:i,expirationDate:s,isCancelled:r,plans:a,isOnTrial:o},l){if(null==e)return g.left("Cannot load plans for change plan when user is freemium");if(!i&&!s)return g.left("Cannot change plan when nextPayDate and expirationDate are null");const c={renew:()=>l.renew(),changePlan:e=>l.changePlan(e),getPlans:()=>l.getPlans()},h=n.createOfferBasedOnAnnual(a);return(0,d.pipe)(h,g.fromOption((()=>"Cannot create offer, plans are incomplete, monthly or quarterly or annual are not presented in subscription status")),g.map((n=>new y(n,e,new Date(null!=i?i:s),null!=r&&r,null!=o&&o,u.fromNullable(t),c))))}constructor(e,t,i,s,n,a,o){(0,r._)(this,"offer",void 0),(0,r._)(this,"currentPlan",void 0),(0,r._)(this,"nextPaymentDate",void 0),(0,r._)(this,"_isCancelled",void 0),(0,r._)(this,"_isOnTrial",void 0),(0,r._)(this,"_queuedPlan",void 0),(0,r._)(this,"_subscriptionOps",void 0),(0,r._)(this,"_renew",void 0),(0,r._)(this,"_getPlans",void 0),(0,r._)(this,"_changePlan",void 0),(0,r._)(this,"_extractAnnualPlan",void 0),(0,r._)(this,"changePlan",void 0),this.offer=e,this.currentPlan=t,this.nextPaymentDate=i,this._isCancelled=s,this._isOnTrial=n,this._queuedPlan=a,this._subscriptionOps=o,this._renew=e=>_.TX((()=>!0===e?this._subscriptionOps.renew():Promise.resolve()),(e=>({reason:"Renew failed",originalError:e}))),this._getPlans=()=>_.TX((()=>this._subscriptionOps.getPlans()),(e=>({reason:"Could not get plans",originalError:e}))),this._changePlan=e=>_.TX((()=>this._subscriptionOps.changePlan(e)),(e=>({reason:"Changing plan failed",originalError:e}))),this._extractAnnualPlan=(0,c.flow)(p.i8((e=>12===e.periodMonths)),g.fromOption((()=>({reason:"Expectation failed, we did not receive the annual plan"}))),g.filterOrElse((e=>h.v0.eq.equals(e.priceMoney,this.offer.price)),(()=>({reason:"Expectation failed, we did not receive the annual plan with offered price"}))),g.map((e=>e.id)),_.Mr),this.changePlan=(0,d.pipe)(this._renew(this._isCancelled),_.cy(this._getPlans),_.cy(this._extractAnnualPlan),_.cy(this._changePlan)),(0,f.hJ)("changePlanHookShowOffer",(()=>y.enableDebugModeToShowOffer=!0))}}(0,r._)(y,"enableDebugModeToShowOffer",!1)},61200:(e,t,i)=>{i.d(t,{FN:()=>B,lu:()=>s});var s,n=i(83531),r=i(23988),a=i(83293),o=i(30040),l=i(63336),c=i(80074),d=i(61389),h=i(32062),p=i(30720),u=i(88105),m=i(78216),g=i(76005),_=i(62597),f=i(41949),y=i(68594),v=i(42543),b=i(80837),S=i(78339),k=i(58347),C=i(15491),w=i(36094),E=i(44297),x=i(77396),M=i(58193),T=i(78018),A=i(80189);class I{_updateValue(e,t){this._changes.modify((i=>Object.assign({},i,{[e]:t})))}get template(){return this._changes.get().template}set template(e){this._updateValue("template",e)}get outcomes(){return this._changes.get().outcomes}set outcomes(e){this._updateValue("outcomes",e)}get checkedPlagiarism(){return this._changes.view("checkedPlagiarism").get()}set checkedPlagiarism(e){this._updateValue("checkedPlagiarism",e)}constructor(e){(0,r._)(this,"_changes",void 0),(0,r._)(this,"changes",void 0),this._changes=c.s.create(e),this.changes=this._changes.pipe(y.i(1))}}class B{get isInitialRevision(){return this._doxInit.remoteDocument.isInitialRevision}get isDemoDocument(){return this._doxInit.meta.isDemoDocument}get documentText(){return this._ded.getText()}downloadOriginal(e){return(0,l.pipe)(this.flush,a.map((()=>e)),a.chain(E.fold((()=>()=>this._doxApi.downloadOriginal(this.id,this._enableTrackingOnDownload)),(e=>()=>this._doxApi.downloadInFormat(this.id,e,this._enableTrackingOnDownload)))),a.map(d.F.saveToFS))()}downloadProofread(){var e=this;return(0,n._)((function*(){yield e._doxApi.downloadProofread(e.id).then(d.F.saveToFS)}))()}generateReport(e,t){var i=this;return(0,n._)((function*(){yield i._doxApi.generateReport(i.id,e,t).then(d.F.saveToFS)}))()}calculateStats(){return x.hq(this._getStats).then((e=>(this.recentDocumentStats.set(E.some(e)),e)))}dispose(){this._subs.dispose()}constructor(e,t,i,s,n,a,d,m){(0,r._)(this,"id",void 0),(0,r._)(this,"_doxInit",void 0),(0,r._)(this,"_ded",void 0),(0,r._)(this,"_getStats",void 0),(0,r._)(this,"_doxApi",void 0),(0,r._)(this,"_enableTrackingOnDownload",void 0),(0,r._)(this,"rtfMode",void 0),(0,r._)(this,"saved",void 0),(0,r._)(this,"checkingState",void 0),(0,r._)(this,"asyncChecksState",void 0),(0,r._)(this,"counters",void 0),(0,r._)(this,"title",void 0),(0,r._)(this,"context",void 0),(0,r._)(this,"defaultContext",void 0),(0,r._)(this,"contextCompleteness",void 0),(0,r._)(this,"score",void 0),(0,r._)(this,"scoreStatus",void 0),(0,r._)(this,"textInfo",void 0),(0,r._)(this,"proofit",void 0),(0,r._)(this,"recentDocumentStats",void 0),(0,r._)(this,"documentLength",void 0),(0,r._)(this,"extraSettings",void 0),(0,r._)(this,"_subs",void 0),(0,r._)(this,"originalFilename",void 0),(0,r._)(this,"flush",void 0),(0,r._)(this,"updateContext",void 0),(0,r._)(this,"updateDefaultContext",void 0),(0,r._)(this,"getCheckingForState",void 0),this.id=e,this._doxInit=t,this._ded=i,this._getStats=s,this._doxApi=n,this._enableTrackingOnDownload=a,this.rtfMode=d,this.saved=new v.B7,this.checkingState=c.s.create("full"),this.asyncChecksState=c.s.create({plagiarism:"full",ai_detector:"full",writing_expert_check:"full"}),this.counters=c.s.create(f.fn.group.empty),this.defaultContext=c.s.create(E.none),this.score=c.s.create(E.none),this.scoreStatus=c.s.create(E.none),this.textInfo=c.s.create(E.none),this.recentDocumentStats=c.s.create(E.none),this.extraSettings=new I((0,l.pipe)(this._doxInit.meta.settings.extraSettings,E.getOrElse((()=>h.O.Extra.empty)))),this._subs=new b.y.Keeper,this.flush=()=>(this._ded.flushChanges(),this._doxInit.remoteDocument.flush()),this.updateContext=e=>{const t=!p.T0.eq.equals(this.context.get(),e);return this.context.set(e),t},this.updateDefaultContext=e=>{const t=!(0,l.pipe)((0,o.tuple)(this.defaultContext.get(),e),(0,o.tupled)(M.fP(p.T0.Default.eq.equals)),E.getOrElse(o.constFalse));return this.defaultContext.set(e),t},this.getCheckingForState=e=>e!==_.J.SpecialId.Plagiarism?this.checkingState.view((e=>({kind:f.kr.CheckingKind.Document,type:e}))):c.s.combine(this.checkingState,this.asyncChecksState.view("plagiarism"),((e,t)=>"full"===e?{kind:f.kr.CheckingKind.Document,type:e}:"idle"!==t?{kind:f.kr.CheckingKind.Plagiarism,type:t}:{kind:f.kr.CheckingKind.Document,type:e})),this.title=c.s.create(t.meta.title),this.proofit=m(this.title),this.context=c.s.create((0,l.pipe)(t.meta.settings.context,E.getOrElse((()=>p.T0.unset))));const y=t.initialDelta.length-1;this.documentLength=c.s.create({full:y,trimmed:u.E.isInsertString(t.initialDelta.delta)?u.E.getTrimmedInsertLength(t.initialDelta.delta):y}),this.contextCompleteness=this.context.view(f.AB.calculateCompleteness),this._subs.push(i.contentUpdated.pipe(S.p(g.D_.isTextMaybeWithFormatting),k.B(200),C.T((()=>i.getText())),C.T((e=>({full:e.length-1,trimmed:e.trim().length})))).subscribe(w.H9(this.documentLength)))}}!function(e){e.Mock=class{getCheckingForState(){return c.s.create({type:"idle",kind:f.kr.CheckingKind.Document})}constructor(){var e;(0,r._)(this,"id",void 0),(0,r._)(this,"rtfMode",T.l1.FormattingMode.on),(0,r._)(this,"originalFilename",void 0),(0,r._)(this,"isInitialRevision",void 0),(0,r._)(this,"score",c.s.create(E.none)),(0,r._)(this,"scoreStatus",c.s.create(E.none)),(0,r._)(this,"textInfo",c.s.create(E.none)),(0,r._)(this,"title",c.s.create("")),(0,r._)(this,"downloadOriginal",(e=(0,n._)((function*(e){return Promise.resolve()})),function(t){return e.apply(this,arguments)})),(0,r._)(this,"downloadProofread",(0,n._)((function*(){return Promise.resolve()}))),(0,r._)(this,"documentText",""),(0,r._)(this,"documentLength",c.s.create({full:0,trimmed:0})),(0,r._)(this,"counters",c.s.create(f.fn.group.empty)),(0,r._)(this,"saved",c.s.create(!0)),(0,r._)(this,"checkingState",c.s.create("idle")),(0,r._)(this,"asyncChecksState",c.s.create({plagiarism:"idle",ai_detector:"idle",writing_expert_check:"idle"})),(0,r._)(this,"isDemoDocument",!1),(0,r._)(this,"calculateStats",(()=>Promise.resolve(m.R.generateStats(210,1601)))),(0,r._)(this,"flush",(()=>Promise.resolve())),(0,r._)(this,"context",c.s.create(p.T0.fromDomain("general"))),(0,r._)(this,"defaultContext",c.s.create(E.some(p.T0.defaultContextFallback))),(0,r._)(this,"contextCompleteness",c.s.create(0)),(0,r._)(this,"updateContext",(()=>!0)),(0,r._)(this,"updateDefaultContext",(()=>!0)),(0,r._)(this,"proofit",new A.YJ.Mock),(0,r._)(this,"extraSettings",new I(h.O.Extra.empty)),(0,r._)(this,"recentDocumentStats",c.s.create(E.none)),(0,r._)(this,"generateReport",(()=>Promise.resolve()))}}}(s||(s={}))},29145:(e,t,i)=>{i.d(t,{N:()=>s});var s,n=i(30040),r=i(24031),a=i(91242),o=i(42543),l=i(78339),c=i(43308),d=i(89769),h=i(95168),p=i(54988),u=i(29052),m=i(77396),g=i(69063),_=i(12486);!function(e){e.create=(e,t,i)=>{const s=g.Bx.Logging.getLogger("DOXConnector",_.$.DEBUG,_.I.Model.getColor("DOXConnector")),p=new o.B7;return{pushChanges:t=>{i.demoMode||(s.debug("Outgoing DeltaChange to DOX",t),p.next(t),(0,n.pipe)(e.remoteDocument.pushChanges(t),u.qE((e=>{a.Xb.isNotConnectedError(e.error)?s.warn("Could not push changes to DOX",e):s.error("Error on pushing changes to DOX",e)})),m.hq).catch(n.constVoid))},changes:(0,n.pipe)(t,l.p(r.U.is("change")),c.E("change"),d.Z(e.initialDelta),h.M((e=>s.debug("Incoming Change from DOX",e)))),outgoingChanges:p}},e.Mock=e=>{var t;return{pushChanges:n.constVoid,changes:(null===(t=e)||void 0===t?void 0:t.changes)||p.w,outgoingChanges:p.w}}}(s||(s={}))},14e3:(e,t,i)=>{i.d(t,{A:()=>n,B:()=>s});var s,n,r=i(10334),a=i(17171),o=i(30040),l=i(63336),c=i(80074),d=i(66799),h=i(54463),p=i(74416),u=i(78339),m=i(15491),g=i(36094),_=i(86562),f=i(58889),y=i(44297),v=i(55172),b=i(23121);!function(e){let t;!function(e){e.Like="Like",e.Dislike="Dislike"}(t=e.FeedbackType||(e.FeedbackType={}))}(s||(s={})),function(e){function t(e){switch(e){case s.FeedbackType.Like:return d.Zq.EMOTION_LIKE;case s.FeedbackType.Dislike:return d.Zq.EMOTION_DISLIKE;default:return(0,_.xb)(e)}}function i(e){return(0,l.pipe)(p.w.fromNumber(e.confidence),f.map((t=>({emoji:e.emoji,name:e.name,confidence:t,feedback:y.none}))))}function n(e){return e.reduce(((e,t)=>(e[t.name]=t,e)),{})}e.toCapiFeedback=t,e.create=function(e,s,d){const _=c.s.create({}),S=[e.pipe(u.p(h.o.is("emotions")),m.T((e=>(0,l.pipe)(function(e){const[t,s]=v.jB(e.map(i),f.isRight);return t.length===e.length?f.right(t.map(b.$v)):f.left((0,l.pipe)(s.map(f.swap).map(b.$v).join(";")))}(e.emotions),f.map(n),f.fold((e=>(d.error("Failed to parse emotions from capi",{rejectionReason:e}),{})),o.identity))))).subscribe(g.H9(_))];return{emotions:_.view((e=>Object.values(e).sort(((e,t)=>p.w.ord.compare(t.confidence,e.confidence))))),sendEmotionFeedback:(e,i)=>(0,l.pipe)(function(e,t){return void 0===e[t]?f.left(new Error("Tried to send feedback for non-existing emotion")):(0,l.pipe)(e[t].feedback,y.fold((()=>f.right(void 0)),(()=>f.left(new Error("Tried to send feedback for an emotion which already has one")))))}(_.get(),e),f.map((()=>{s.sendFeedback({emotionName:e,kind:t(i)})(),_.modify((t=>(0,a._)((0,r._)({},t),{[e]:(0,a._)((0,r._)({},t[e]),{feedback:y.some(i)})})))}))),dispose:()=>S.forEach((e=>e.unsubscribe()))}}}(n||(n={}))},12495:(e,t,i)=>{i.d(t,{L:()=>p,N:()=>s});var s,n=i(83531),r=i(23988),a=i(80074),o=i(78339),l=i(19711),c=i(6987),d=i(36094),h=i(36840);class p{enable(){return this._isEnabled.set(!0),this._enable(),()=>{this._isEnabled.set(!1),this._disable()}}recheck(){var e=this;return(0,n._)((function*(){const t=!e._isEnabled.get();t&&e._enable(),yield e._plagiarismCheckingState.pipe(o.p((e=>"idle"===e)),l.$()).toPromise(),t&&e._plagiarismCapiClient.disablePlagiarismSearch()}))()}dispose(){this._subs.forEach((e=>e.unsubscribe()))}constructor(e,t,i){(0,r._)(this,"_documentModel",void 0),(0,r._)(this,"_events",void 0),(0,r._)(this,"_plagiarismCapiClient",void 0),(0,r._)(this,"_plagiarismCheckingState",void 0),(0,r._)(this,"plagiarismCheckedInSession",void 0),(0,r._)(this,"checkingState",void 0),(0,r._)(this,"_subs",void 0),(0,r._)(this,"_isEnabled",void 0),(0,r._)(this,"_enable",void 0),(0,r._)(this,"_disable",void 0),this._documentModel=e,this._events=t,this._plagiarismCapiClient=i,this._plagiarismCheckingState=this._documentModel.asyncChecksState.lens("plagiarism"),this.plagiarismCheckedInSession=this._plagiarismCheckingState.view((e=>"full"!==e)),this.checkingState=this._plagiarismCheckingState,this._subs=[],this._isEnabled=a.s.create(!1),this._enable=()=>{this._plagiarismCheckingState.modify((e=>"idle"===e?"checking":e)),this._documentModel.extraSettings.checkedPlagiarism=!0,this._plagiarismCapiClient.enablePlagiarismSearch()},this._disable=()=>{this._plagiarismCapiClient.disablePlagiarismSearch()},this._subs.push(this._isEnabled.pipe(c.n(d.vh(this._events.pipe(o.p((e=>"session_started"===e.kind)))))).subscribe(this._enable))}}!function(e){e.Mock=class{constructor(){(0,r._)(this,"enable",(()=>h.Yi)),(0,r._)(this,"recheck",(()=>new Promise(h.Yi))),(0,r._)(this,"dispose",h.Yi),(0,r._)(this,"checkingState",a.s.create("idle")),(0,r._)(this,"plagiarismCheckedInSession",a.s.create(!0))}}}(s||(s={}))},80189:(e,t,i)=>{i.d(t,{YJ:()=>r,Yi:()=>s,y5:()=>y});var s,n,r,a=i(23988),o=i(30040),l=i(80074),c=i(83062),d=i(35413),h=i(15491),p=i(44297),u=i(58889),m=i(77396),g=i(29052),_=i(34717),f=i(69063);!function(e){function t(e){return"sending"===e.kind}e.isSending=t,e.isSendingState=p.exists(t)}(s||(s={})),function(e){e.isSuccess=function(e){return e.status===c.c.StatisticsStatus.Success}}(n||(n={}));class y{getPlans(){return this._doc.getProofitPlans().then(u.fold((e=>Promise.reject(e)),(e=>e.status===c.c.PlanStatus.Forbidden?Promise.reject({status:c.c.PlanStatus.Forbidden}):Promise.resolve(e))))}getStatistics(){return d.v(this._proofitStatisticsIO).pipe(h.T(p.fromEither))}placeOrder(e,t,i,s,n){return this.state.set(p.some({kind:"sending"})),m.hq(this._doc.placeProofitOrder({turnaround:e.turnaround,tier:e.tier,userInputs:t,priceOfferId:i,payWithCredits:n},s)).then((e=>this._updateStatus(e.status))).catch((e=>{f.Bx.Logging.getLogger("ProofitModel").warn("Error placing proofit order",e),this.state.set(p.some({kind:"error",errorType:"unknown"}))}))}updateState(e){this._updateStatus(e.status),this.jobDetails.set(p.some({startTime:e.submitted,dueTime:e.due}))}_updateStatus(e){switch(e){case c.c.JobStatus.building:break;case c.c.JobStatus.newJob:this.state.set(p.some({kind:"submitted"}));break;case c.c.JobStatus.completed:this.state.set(p.some({kind:"finished"}));break;case c.c.JobStatus.cancelled:this.state.set(p.some({kind:"cancelled"}));break;case c.c.JobStatus.emptyDocument:this.state.set(p.some({kind:"error",errorType:"emptyDocument"}));break;case c.c.JobStatus.duplicate:this.state.set(p.some({kind:"error",errorType:"alreadyProofread"}));break;case c.c.JobStatus.complexInternalStructure:this.state.set(p.some({kind:"error",errorType:"complexInternalStructure"}));break;case c.c.JobStatus.paymentError:this.state.set(p.some({kind:"error",errorType:"payment"}));break;case c.c.JobStatus.forbidden:case c.c.JobStatus.unknown:default:this.state.set(p.none)}}constructor(e,t){(0,a._)(this,"_doc",void 0),(0,a._)(this,"documentTitle",void 0),(0,a._)(this,"_statisticsCache",void 0),(0,a._)(this,"_proofitStatisticsIO",void 0),(0,a._)(this,"state",void 0),(0,a._)(this,"jobDetails",void 0),this._doc=e,this.documentTitle=t,this._statisticsCache=p.none,this._proofitStatisticsIO=()=>(0,o.pipe)(this._statisticsCache,p.fold((0,o.pipe)(this._doc.getProofitStatistics,g.cy(g.aN(n.isSuccess,(e=>new Error(e.status)))),g.W6((e=>g.L9((()=>{this._statisticsCache=p.some(e)}))))),(e=>Promise.resolve(u.right(e))))),this.state=l.s.create(p.none),this.jobDetails=l.s.create(p.none)}}!function(e){e.Mock=class extends y{constructor(e=c.c.JobStatus.newJob,t=p.none){var i,s,n;super((i=e,s={status:c.c.StatisticsStatus.Success,lastCompletedJobDate:t},n=e=>{this.updateState(e)},{getProofitPlans:()=>Promise.resolve(u.right({status:c.c.PlanStatus.Success,turnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:p.of(1440),hoursToProcess:p.none,perWord:.14,price:140,turnaround:c.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:c.c.PlanTier.Base,credits:p.none},{enabled:!0,label:"3 hours",minutesToProcess:p.of(180),hoursToProcess:p.none,perWord:.18,price:180,turnaround:c.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:c.c.PlanTier.Base,credits:p.none},{enabled:!0,label:"30 minutes",minutesToProcess:p.of(30),hoursToProcess:p.none,perWord:.3,price:300,turnaround:c.c.PlanType.Instant,requirePaymentCheck:!1,tier:c.c.PlanTier.Base,credits:p.none}],clarityTurnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:p.of(1440),hoursToProcess:p.none,perWord:.14,price:140,turnaround:c.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:c.c.PlanTier.Clarity,credits:p.none},{enabled:!0,label:"3 hours",minutesToProcess:p.of(180),hoursToProcess:p.none,perWord:.18,price:180,turnaround:c.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:c.c.PlanTier.Clarity,credits:p.none}],words:100,userInputs:{nativeLanguage:p.none,dialect:p.none,quotationType:p.none,spaceType:p.none,noteToEditor:p.none},priceOfferId:c.c.PriceOfferId.create(424242)})),placeProofitOrder:()=>()=>new Promise((e=>{const t=_.Local.Timestamp.now(),s=_.Local.Timestamp.toLocal(_.Local.Timestamp.add(t,3*_.WU)),r={submitted:_.Local.Timestamp.toLocal(t),corrections:5,due:s,price:666,name:"",completed:p.none,id:1,status:c.c.stringToJobStatus(i),is_dox_applied:!0};setTimeout((()=>e(u.right(r))),0),setTimeout((()=>n(r)),500)})),getProofitStatistics:()=>Promise.resolve(u.right(s))}),l.s.create(""))}}}(r||(r={}))},58538:(e,t,i)=>{i.d(t,{_g:()=>n,uL:()=>k,yp:()=>r});var s,n,r,a=i(83531),o=i(23988),l=i(10334),c=i(17171),d=i(63336),h=i(80074),p=i(28986),u=i(9198),m=i(66799),g=i(40711),_=i(42543),f=i(77396),y=i(34717),v=i(44297),b=i(58889),S=i(69063);!function(e){e.Querying="querying",e.SynonymsReady="ready",e.SynonymsEmpty="empty",e.SynonymApplied="applied",e.SynonymsError="error",e.SynonymsNone="none"}(s||(s={})),function(e){e.isReady=function(e){return null!==e&&e.kind===s.SynonymsReady},e.isEmpty=function(e){return null!==e&&e.kind===s.SynonymsEmpty},e.isQuerying=function(e){return null!==e&&e.kind===s.Querying},e.isApplied=function(e){return null!==e&&e.kind===s.SynonymApplied},e.defaultState={kind:s.SynonymsNone,query:{id:-1,start:-1,word:""}}}(n||(n={}));class k{query(e){var t=this;return(0,a._)((function*(){return t._log.trace("SynonymsQuery: "+e.word),t.state.set({kind:s.Querying,query:e}),f.hq(t._capi.requestSynonyms(e.start,e.word)).then((i=>{const n=y.Local.Timestamp.now(),a=(0,d.pipe)(i.synonymsOrGroups,v.fold((()=>({kind:s.SynonymsEmpty,query:e,synonyms:{id:i.id},readyAt:n,stats:r.emptySynonymsStats,pname:i.pname})),(t=>({kind:s.SynonymsReady,query:e,synonyms:(0,c._)((0,l._)({},i),{synonymsOrGroups:t}),readyAt:n,stats:r.getSynonymsStats(t),pname:i.pname}))));return t._onResponse(a),a})).catch((i=>(t.abortQuery(),Boolean(i.message)&&-1!==i.message.indexOf("Timeout")?t._log.info("Synonyms timeout",i):t._log.warn("Error getting synonyms",i),{kind:s.SynonymsError,query:e})))}))()}abortQuery(){const e=this.state.get();n.isQuerying(e)&&this.state.set(n.defaultState)}_onResponse(e){const t=window.SQT;setTimeout((()=>{this._log.trace("_onResponse() newState: "+e);const t=this.state.get();n.isQuerying(t)&&t.query.word===e.query.word?this.state.set(e):this._log.trace("Discarding result for "+e.query.word)}),t)}applySynonym(e,t){this._log.debug(`_applySynonym(#${e.id})`);const i=e.range,n=i.start,r=i.end-i.start;this._ded.flushChanges();let a=this.positionManager.getTextLength();const o=(0,d.pipe)((new p.R).retain(n).delete(r).insert(t),g.N.getEnrichedWithFormattingDelta(this._getContent())),l=u.lY.delta(o,a),c=o.invert(this._getContent());return this.changes.next(l),b.getOrElse((e=>this._log.error("Failed to set cursor on synonym apply.",e,{position:n})))(this._ded.setCursor(n,0)),this.state.set({kind:s.SynonymApplied,target:e}),this._capi.sendFeedback({id:e.id,kind:m.Fc.SYNONYM_ACCEPTED,replacementText:t})(),this._ded.flushChanges(),a=this.positionManager.getTextLength(),{action:m.Fc.SYNONYM_ACCEPTED,replacement:t,commit:()=>{this._log.debug(`_applySynonym(#${e.id}):commit()`),e.dispose()},undo:()=>{this._log.debug(`_applySynonym(#${e.id}):undo()`);const t=this.positionManager.getTextLength();if(t===a){const e=u.lY.delta(c,t);this.changes.next(e)}else this._log.error("Text has changed while uncommitted apply is present");return e.dispose(),[]}}}ignore(e){const t=this.state.get();(n.isEmpty(t)||n.isReady(t))&&t.synonyms.id===e?this._capi.sendFeedback({id:e,kind:m.Fc.SYNONYM_DISMISSED})():this._log.error("Tried to report ignore for an unknown synonyms id",{reportedId:e,currentState:t})}constructor(e,t,i,s){(0,o._)(this,"positionManager",void 0),(0,o._)(this,"_getContent",void 0),(0,o._)(this,"_capi",void 0),(0,o._)(this,"_ded",void 0),(0,o._)(this,"state",void 0),(0,o._)(this,"changes",void 0),(0,o._)(this,"_log",void 0),this.positionManager=e,this._getContent=t,this._capi=i,this._ded=s,this.state=h.s.create(n.defaultState),this.changes=new _.B7,this._log=S.Bx.Logging.getLogger("editor.SynonymsModelImpl")}}!function(e){var t=e.emptySynonymsStats={numberOfMeanings:0,numberOfSynonymsByMeanings:[],numberOfSynonymsTotal:0};const i=e=>({numberOfMeanings:1,numberOfSynonymsByMeanings:[e.length],numberOfSynonymsTotal:e.length}),s=e=>e.reduce(((e,t)=>({numberOfMeanings:e.numberOfMeanings+1,numberOfSynonymsByMeanings:[...e.numberOfSynonymsByMeanings,t.words.length],numberOfSynonymsTotal:e.numberOfSynonymsTotal+t.words.length})),t);e.getSynonymsStats=e=>(0,d.pipe)(e,b.fold(i,s));const n=(e,t)=>{const i=t.findIndex((t=>t===e));return{meaningIndex:0,synonymIndexInGroup:i,synonymIndexAbs:i}},r={meaningIndex:-1,synonymIndexInGroup:-1,synonymIndexAbs:-1};e.getSynonymStats=(e,t)=>(0,d.pipe)(t,b.fold((t=>n(e,t)),(t=>((e,t)=>t.reduce((({result:t,numberOfLookedSynonyms:i},s,r)=>{const a=n(e,s.words).synonymIndexInGroup;return a>-1?{result:{meaningIndex:r,synonymIndexInGroup:a,synonymIndexAbs:i+a},numberOfLookedSynonyms:i}:{result:t,numberOfLookedSynonyms:i+s.words.length}}),{result:r,numberOfLookedSynonyms:0}).result)(e,t)))),e.getTimeToClose=e=>(0,d.pipe)(e,(e=>y.Local.Timestamp.subtract(y.Local.Timestamp.now(),e)),(e=>e/1e3))}(r||(r={}))},63911:(e,t,i)=>{i.d(t,{K:()=>_});var s=i(23988),n=i(50659),r=i(30040),a=i(63336),o=i(87574),l=i(78674),c=i(44297),d=i(72900),h=i(5828),p=i(13801),u=i(9506),m=i(54322);class g extends n.Component{componentDidMount(){const e=this._el.children;this.props.onElementsReady({header:e[0].outerHTML,stats:e[1].outerHTML,text:e[2].outerHTML,footer:e[3].outerHTML})}render(){const{model:e}=this.props,t=(i=e.plagiarism,(0,a.pipe)(i,c.filter((e=>e.state===l.p.PlagiarismCheckingState.CHECKED)),c.map((e=>e.sortedAlerts)),c.getOrElse((()=>[]))));var i;return n.createElement("div",{ref:e=>{null!==e&&(this._el=e)}},n.createElement(h.cA,{title:e.title}),n.createElement(h.Su,{model:e}),n.createElement("div",null,n.createElement(u._,{html:e.dedHTML,title:e.title,alerts:e.sortedAlerts,plagiarism:t}),n.createElement(p.l,{alerts:e.sortedAlerts,plagiarism:t})),n.createElement(h.ol,null))}constructor(...e){super(...e),(0,s._)(this,"_el",void 0)}}class _ extends n.Component{_prepareHTML(e){return'<!doctype html><html lang="en" style="--rem: 23.8;"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Report</title><style>'+(0,m.X3)()+"</style></head>"+`<body>${e}</body></html>`}render(){const{reportViewModel:e}=this.props;return n.createElement(o.F.div,{className:d.xn.invisible},e.reportData.view((0,r.flow)(c.map((t=>n.createElement(g,{model:t,onElementsReady:({header:t,footer:i,stats:s,text:n})=>e.generateReport(this._prepareHTML(s+n),t,i)}))),c.toNullable)))}}},72900:(e,t,i)=>{i.d(t,{hz:()=>y,xn:()=>k});var s=i(11864),n=i(29120),r=i(27199),a=i(14754);const o=44*a.D,l=144*a.D,c=700*a.D,d=12*a.D,h=16*a.D,p=14*a.D,u=p+(h-p)/2-4,m=8.25*a.D,g=.6*a.D;n.b.cssRule("html",{fontSize:s.Ks.px(p)});const _="report-",f={invisible:`${_}invisible`,markBase:`${_}markBase`,markSuccess:`${_}markSuccess`,akkuratWrapper:`${_}akkuratWrapper`,content:`${_}content`,textContent:`${_}textContent`,text:`${_}text`,superscriptContainer:`${_}superscriptContainer`,superscript:`${_}superscript`,alertTableContainer:`${_}alertTableContainer`,alertTable:`${_}alertTable`,alertTableTd:`${_}alertTableTd`,alertTableTdIndex:`${_}alertTableTdIndex`,alertTableTdExample:`${_}alertTableTdExample`,alertTableTdPlagiarismSource:`${_}alertTableTdPlagiarismSource`,alertTableHighlightText:`${_}alertTableHighlightText`,separatorRemover:`${_}separatorRemover`,plagiarismLink:`${_}plagiarismLink`},y=f.superscriptContainer,v={borderBottomColor:s.Ks.important("transparent"),textDecoration:s.Ks.important("none"),fontWeight:s.Ks.important("normal"),fontStyle:s.Ks.important("normal")},b={boxSizing:"border-box",margin:"0 -8px",paddingRight:s.Ks.px(o),paddingLeft:s.Ks.px(l),width:s.Ks.px(c),$nest:{thead:{display:"table-row-group"}}},S={padding:`${s.Ks.px(11*a.D)} ${s.Ks.px(16*a.D)} ${s.Ks.px(11*a.D)} 0`,borderTop:`1px solid ${r.Q1.CoreNeutral20}`,verticalAlign:"top",fontSize:s.Ks.px(d),lineHeight:s.Ks.px(h),breakInside:"avoid",$nest:{"&:last-of-type":{paddingRight:0}}},k={akkuratWrapper:s.Ks.joinClasses([f.akkuratWrapper,n.b.style({fontWeight:"normal",fontFamily:"'Akkurat Std', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif, Arial","-webkit-font-smooting":"antialiased","-moz-osx-font-smoothing":"grayscale"})]),content:s.Ks.joinClasses([f.content,n.b.style(b)]),textContent:s.Ks.joinClasses([f.textContent,n.b.style(b,{fontSize:s.Ks.px(p),pageBreakBefore:"always"})]),text:s.Ks.joinClasses([f.text,n.b.style({lineHeight:s.Ks.px(48),$nest:{"& *":{animation:s.Ks.important("none")},"& .ql-container [class*=-placeholder]":{display:"none"},"& .ql-clipboard":{display:"none"}}})]),superscriptContainer:s.Ks.joinClasses([f.superscriptContainer,n.b.style({position:"relative",bottom:s.Ks.px(u),display:"inline-block",width:0,height:0,whiteSpace:"nowrap",fontSize:s.Ks.px(m)})]),superscript:s.Ks.joinClasses([f.superscript,n.b.style(v,{padding:`0 ${s.Ks.px(g)}`,whiteSpace:"nowrap",$nest:{"&:not(:last-child):after":{content:"','"}}})]),alertTableContainer:s.Ks.joinClasses([f.alertTableContainer,n.b.style(b,{paddingLeft:0,pageBreakBefore:"always"})]),alertTable:s.Ks.joinClasses([f.alertTable,n.b.style({width:s.Ks.percent(100),borderCollapse:"collapse",$nest:{[`& tr:first-of-type .${f.alertTableTd}`]:{borderTopWidth:0},"& [class*=-or]":{marginRight:s.Ks.px(4*a.D),marginLeft:0,fontSize:s.Ks.px(d)},"& [class*=-removeOrContainer]":{flexBasis:"auto",$nest:{"& [class*=-itemRemove]":{marginRight:s.Ks.px(4*a.D),marginBottom:0,padding:0,$nest:{"& [class*=-deleteAll]":{verticalAlign:"middle"}}},"& [class*=-itemContext]":{marginRight:s.Ks.px(4*a.D),color:r.Q1.CoreNeutral60,fontStyle:"italic",fontSize:s.Ks.px(d)}}},"& [class*=-itemOriginal], & [class*=-itemRemove]":{backgroundColor:"transparent",color:r.Q1.CoreRed50,fontSize:s.Ks.px(d),lineHeight:s.Ks.px(h),paddingLeft:0,marginBottom:0},"& [class*=-itemOriginal]":{marginRight:0},"& [class*=-itemOriginal]:after":{margin:"-5px 4px 0",color:r.Q1.CoreNeutral60,fontSize:s.Ks.px(d),lineHeight:s.Ks.px(h)},"& [class*=-itemInsert]":{margin:0,padding:0,backgroundColor:"transparent",color:r.Q1.CoreGreen60,fontSize:s.Ks.px(d),lineHeight:s.Ks.px(h)},"& [class*=-itemInsert]:not(:last-child):after":{display:"inline-block",marginRight:"4px",color:r.Q1.CoreNeutral60,content:"','",fontSize:s.Ks.px(d),lineHeight:s.Ks.px(h)},"& [class*=-replacements_labels-diff]":{fontWeight:"normal"},"& [class*=-replacements_labels-list]":{marginBottom:0}}})]),alertTableTd:s.Ks.joinClasses([f.alertTableTd,n.b.style(S)]),alertTableTdIndex:s.Ks.joinClasses([f.alertTableTdIndex,n.b.style(S,{width:s.Ks.px(l),borderTopWidth:0,color:r.Q1.CoreNeutral50,textAlign:"right"})]),alertTableTdExample:s.Ks.joinClasses([f.alertTableTdExample,n.b.style(S,{maxWidth:s.Ks.px(350*a.D)})]),alertTableTdPlagiarismSource:s.Ks.joinClasses([f.alertTableTdPlagiarismSource,n.b.style(S,{maxWidth:s.Ks.px(190*a.D),wordWrap:"break-word"})]),alertTableHighlightText:s.Ks.joinClasses([f.alertTableHighlightText,n.b.style({color:r.Q1.CoreNeutral60,fontStyle:"italic",lineHeight:s.Ks.px(h)})]),markBase:s.Ks.joinClasses([f.markBase,n.b.style({$nest:{"@media print":{borderBottomWidth:s.Ks.important(s.Ks.px(3))}}})]),markSuccess:s.Ks.joinClasses([f.markSuccess,n.b.style({$nest:{"@media print":{backgroundColor:r.Q1.CoreNeutral0}}})]),separatorRemover:s.Ks.joinClasses([f.separatorRemover,n.b.style({position:"fixed",top:0,width:s.Ks.percent(100),height:s.Ks.px(3),backgroundColor:r.Q1.CoreNeutral0})]),plagiarismLink:s.Ks.joinClasses([f.plagiarismLink,n.b.style({display:"block",color:r.Q1.CoreBlue50})]),invisible:s.Ks.joinClasses([f.invisible,s.Ks.style({position:"absolute",visibility:"hidden"})])},C=e=>({position:"fixed",left:s.Ks.px(160),zIndex:-1,width:e});n.b.cssRule("[data-vertical-underline-start]:before",C(s.Ks.px(60)),{height:s.Ks.percent(100),borderRight:`${s.Ks.px(4)} solid`,content:"' '"},{"-webkit-print-color-adjust":"exact !important"}),n.b.cssRule("[data-vertical-underline-body]",C(s.Ks.px(60))),n.b.cssRule("[data-vertical-underline-body]:after",C(s.Ks.px(60)),{height:s.Ks.percent(100),borderRight:`${s.Ks.px(4)} solid`,background:r.Q1.CoreNeutral0,content:"' '"},{"-webkit-print-color-adjust":"exact !important"}),n.b.cssRule("[data-vertical-underline-index]",v,C(s.Ks.px(55)),{height:"inherit",backgroundColor:r.Q1.CoreNeutral0,textAlign:"right",fontSize:s.Ks.px(m),lineHeight:s.Ks.px(m)},{"-webkit-print-color-adjust":"exact !important"}),n.b.cssRule("[data-vertical-underline-index]:before",{display:"block",boxSizing:"border-box",width:s.Ks.px(65),height:s.Ks.px(6),borderTop:`${s.Ks.px(6)} solid ${r.Q1.CoreNeutral0}`,content:"' '"},{"-webkit-print-color-adjust":"exact !important"}),n.b.cssRule("[data-vertical-underline-end]:after",{position:"fixed",left:0,zIndex:-1,display:"block",width:s.Ks.px(229),height:s.Ks.percent(100),background:r.Q1.CoreNeutral0,content:"' '"},{"-webkit-print-color-adjust":"exact !important"})},5828:(e,t,i)=>{i.d(t,{Su:()=>u,cA:()=>m,ol:()=>g,qq:()=>p});var s=i(50659),n=i(63336),r=i(57616),a=i(50581),o=i(44297),l=i(22835),c=i(72900),d=i(32717);const{classes:h}=a,p=e=>s.createElement("div",{className:h(c.xn.akkuratWrapper,e.className),style:e.style},e.children),u=({model:e})=>s.createElement(p,{className:c.xn.content},s.createElement("div",{className:c.xn.separatorRemover}),s.createElement(d.Cc,{title:e.title,author:o.some(e.author)}),s.createElement(d.BP,{stats:e.stats}),s.createElement(d.yY,{score:e.score,critical:e.criticalIssues,advanced:e.advancedIssues}),(0,n.pipe)(e.plagiarism,o.map((e=>s.createElement(d.d6,{plagiarismData:e}))),o.toNullable),!l.RI(e.issues)&&s.createElement(d.MG,{issues:e.issues}),s.createElement(d.Y1,{stats:e.stats})),m=({title:e})=>s.createElement(p,{style:{width:"100%",marginLeft:"17.4857px",marginRight:"38.4686px",color:"#becafa",letterSpacing:"0.1px",position:"absolute",top:0}},s.createElement("div",{style:{width:144,position:"absolute",top:24,left:8}},s.createElement(r.e,{style:{height:"auto",width:120}})),s.createElement("p",{style:{position:"absolute",left:150,width:1060,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",borderBottom:"2px solid #e4e6f2",transform:"scale(0.563)",transformOrigin:"top left",paddingBottom:"21px",top:12,fontSize:"19px"}},"Report:",e)),g=()=>s.createElement(p,{style:{marginLeft:"128.8807px",marginRight:"25.4686px",width:"100%",fontSize:"19px",color:"#becafa",letterSpacing:"0.1px",lineHeight:"90px"}},s.createElement("div",{style:{position:"absolute",bottom:0,left:-65,transform:"scale(0.563)",width:1060,zIndex:1e3,borderTop:"1px solid #e4e6f2"}},"Report was generated on",(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),s.createElement("span",{style:{float:"right"}},"Page",s.createElement("span",{className:"pageNumber"}),"of",s.createElement("span",{className:"totalPages"}))))},13801:(e,t,i)=>{i.d(t,{l:()=>g});var s=i(10334),n=i(50659),r=i(63336),a=i(62597),o=i(26251),l=i(325),c=i(88219),d=i(58889),h=i(36840),p=i(44297),u=i(72900),m=i(5828);const g=({alerts:e,plagiarism:t})=>t.length+e.length===0?null:n.createElement(m.qq,{className:u.xn.alertTableContainer},n.createElement("table",{className:u.xn.alertTable},n.createElement("tbody",null,e.map(((e,t)=>n.createElement(_,{key:e.id,alert:e,index:t}))),t.map(((t,i)=>n.createElement(f,{key:t.id,alert:t,index:i+e.length})))))),_=({alert:e,index:t})=>n.createElement("tr",null,n.createElement("td",{className:u.xn.alertTableTdIndex},t+1,"."),n.createElement("td",{className:u.xn.alertTableTdExample},(0,r.pipe)(e.content,d.fold((e=>n.createElement("span",{className:u.xn.alertTableHighlightText},v(b(e)))),(e=>n.createElement(c.gs,{replacementsLabels:e,onClick:()=>h.Yi,layoutDensity:o.p.Density.cozy,a11yContrast:!1}))))),n.createElement("td",(0,s._)({className:u.xn.alertTableTd},l.v.renderToHtml(e.categoryHuman))),n.createElement("td",{className:u.xn.alertTableTd},a.J.OutcomeId.fromOutcomeId(e.lensId))),f=({alert:e,index:t})=>n.createElement("tr",null,n.createElement("td",{className:u.xn.alertTableTdIndex},t+1,"."),n.createElement("td",{className:u.xn.alertTableTdExample},n.createElement("span",{className:u.xn.alertTableHighlightText},v(b(e.highlightTexts)))),n.createElement("td",{className:u.xn.alertTableTdPlagiarismSource},n.createElement(S,{alert:e})),n.createElement("td",{className:u.xn.alertTableTd},a.J.OutcomeId.fromOutcomeId(e.lensId))),y=300;function v(e){return e.length>y?n.createElement(n.Fragment,null,e.substr(0,y-1),""):n.createElement(n.Fragment,null,e)}function b(e){return 1===e.length?e[0]:Array.from(new Set(e)).join("; ")}const S=({alert:e})=>n.createElement(n.Fragment,null,e.title,"web"===e.plagiarismType.source&&(0,r.pipe)(e.plagiarismType.url,p.map((e=>n.createElement("a",{href:e,className:u.xn.plagiarismLink},e))),p.toNullable))},9506:(e,t,i)=>{i.d(t,{_:()=>c});var s=i(50659),n=i(44297),r=i(72900),a=i(5828),o=i(32717),l=i(54322);const c=({html:e,title:t,alerts:i,plagiarism:l})=>s.createElement(a.qq,{className:r.xn.textContent},s.createElement(o.Cc,{title:t,author:n.none}),s.createElement(d,{alerts:i,plagiarism:l,html:e})),d=({html:e,alerts:t,plagiarism:i})=>{const n=(0,l.W4)(e,t,i);return s.createElement("div",{className:r.xn.text,dangerouslySetInnerHTML:{__html:n}})}},12109:(e,t,i)=>{i.d(t,{k5:()=>b,Y1:()=>S,UA:()=>v});var s=i(10334),n=i(17171),r=i(69384),a=i(50659),o=i(86922),l=i(11864),c=i(29120),d=i(27199),h=i(14754),p=i(82287);const u="report-sections-document_insights-",m={insightsSection:`${u}insightsSection`,insightTable:`${u}insightTable`,insightHeader:`${u}insightHeader`,insightBody:`${u}insightBody`,insightTextCell:`${u}insightTextCell`,insightTextHeader:`${u}insightTextHeader`,insightScoreCell:`${u}insightScoreCell`,insightScore:`${u}insightScore`},g={paddingRight:l.Ks.px(32*h.D),width:l.Ks.px(321*h.D)},_={width:l.Ks.px(191*h.D),verticalAlign:"top",textTransform:"lowercase"},f={insightsSection:l.Ks.joinClasses([m.insightsSection,c.b.style(p.f1,{$nest:{"&:not(:first-child)":{marginTop:l.Ks.px(24*h.D)}}})]),insightTable:l.Ks.joinClasses([m.insightTable,c.b.style(p.bi,{marginTop:l.Ks.px(24*h.D),width:l.Ks.px(512*h.D)})]),insightHeader:l.Ks.joinClasses([m.insightHeader,c.b.style({letterSpacing:0,fontWeight:"bold",fontSize:l.Ks.px(18*h.D),lineHeight:l.Ks.px(32*h.D)})]),insightBody:l.Ks.joinClasses([m.insightBody,c.b.style({color:d.Q1.CoreNeutral50,letterSpacing:l.Ks.px(.11*h.D),fontSize:l.Ks.px(13*h.D),lineHeight:l.Ks.px(20*h.D)})]),insightTextCell:l.Ks.joinClasses([m.insightTextCell,c.b.style(g)]),insightTextHeader:l.Ks.joinClasses([m.insightTextHeader,c.b.style(g,{textTransform:"capitalize"})]),insightScoreCell:l.Ks.joinClasses([m.insightScoreCell,c.b.style(_)]),insightScore:l.Ks.joinClasses([m.insightScore,c.b.style(_,{color:d.Q1.CoreBlue50,letterSpacing:l.Ks.px(-.1*h.D)})])},y=({header:e,description:t,measure:i,score:s})=>a.createElement("section",{className:f.insightsSection},a.createElement("table",{className:f.insightTable},a.createElement("tbody",null,a.createElement("tr",{className:f.insightHeader},a.createElement("td",{className:f.insightTextHeader},e),a.createElement("td",{className:f.insightScore},s)),a.createElement("tr",{className:f.insightBody},a.createElement("td",{className:f.insightTextCell},t),a.createElement("td",{className:f.insightScoreCell},i))))),v=e=>{var{score:t}=e,i=(0,r._)(e,["score"]);return a.createElement(y,(0,n._)((0,s._)({},i),{score:`${"number"!=typeof t||t<0?0:t>100?100:Math.round(t)}%`}))},b=e=>{var{score:t}=e,i=(0,r._)(e,["score"]);return a.createElement(y,(0,n._)((0,s._)({},i),{score:""+("number"!=typeof t?0:Math.round(10*t)/10)}))},S=({stats:e})=>{const t=a.useContext(o.S.Context);return a.createElement("div",null,a.createElement(v,{header:t.performance.uniqueWordsTitle,description:t.performance.report.uniqueWordsDescription,measure:t.performance.uniqueWordsTitle,score:e.uniqueWords}),a.createElement(v,{header:t.performance.rareWordsTitle,description:t.performance.rareWords,measure:t.performance.rareWordsTitle,score:e.rareWords}),a.createElement(b,{header:t.performance.wordLengthTitle,description:t.performance.report.wordLengthDescription,measure:t.performance.report.wordLengthMeasure,score:e.wordLength}),a.createElement(b,{header:t.performance.sentenceLengthTitle,description:t.performance.report.sentenceLengthDescription,measure:t.performance.report.sentenceLengthMeasure,score:e.sentenceLength}))}},32717:(e,t,i)=>{i.d(t,{Y1:()=>te.Y1,BP:()=>b,d6:()=>W,yY:()=>H,Cc:()=>m,MG:()=>ee});var s=i(50659),n=i(30040),r=i(44297),a=i(11864),o=i(29120),l=i(27199),c=i(14754);const d="report-sections-title-",h={author:`${d}author`,titleSection:`${d}titleSection`,title:`${d}title`,largeTitle:`${d}largeTitle`,mediumTitle:`${d}mediumTitle`,smallTitle:`${d}smallTitle`,titleContainer:`${d}titleContainer`},p={display:"-webkit-box",overflow:"hidden",color:l.Q1.CoreNeutral90,wordWrap:"break-word",hyphens:"auto",fontWeight:"bold","-webkit-line-clamp":5,"-webkit-box-orient":"vertical"},u={author:a.Ks.joinClasses([h.author,o.b.style({color:l.Q1.CoreNeutral50,letterSpacing:0,fontSize:a.Ks.px(15*c.D),lineHeight:a.Ks.px(24*c.D)})]),titleSection:a.Ks.joinClasses([h.titleSection,o.b.style({marginBottom:a.Ks.px(22*c.D),pageBreakInside:"avoid"})]),title:a.Ks.joinClasses([h.title,o.b.style(p)]),largeTitle:a.Ks.joinClasses([h.largeTitle,o.b.style(p,{marginBottom:a.Ks.px(22*c.D),fontSize:a.Ks.px(28*c.D),lineHeight:a.Ks.px(40*c.D)})]),mediumTitle:a.Ks.joinClasses([h.mediumTitle,o.b.style(p,{fontSize:a.Ks.px(22*c.D),lineHeight:a.Ks.px(32*c.D)})]),smallTitle:a.Ks.joinClasses([h.smallTitle,o.b.style(p,{fontSize:a.Ks.px(18*c.D),lineHeight:a.Ks.px(32*c.D)})]),titleContainer:a.Ks.joinClasses([h.titleContainer,o.b.style({overflow:"hidden",textOverflow:"ellipsis"})])},m=({title:e,author:t})=>s.createElement("section",{className:u.titleSection},s.createElement("h1",{className:e.length<100?u.largeTitle:e.length<200?u.mediumTitle:u.smallTitle},e),(0,n.pipe)(t,r.map((e=>s.createElement("p",{className:u.author},"by ",e))),r.toNullable));var g=i(34717),_=i(82287);const f="report-sections-general_metrics-",y={generalMetricsSection:`${f}generalMetricsSection`,generalMetricsHeader:`${f}generalMetricsHeader`,metrics:`${f}metrics`},v={generalMetricsSection:a.Ks.joinClasses([y.generalMetricsSection,o.b.style(_.f1,{marginBottom:a.Ks.px(14*c.D),$nest:{"& table":{width:a.Ks.percent(100),whiteSpace:"nowrap"},"& tbody":{verticalAlign:"top"}}})]),generalMetricsHeader:a.Ks.joinClasses([y.generalMetricsHeader,o.b.style(_.Co,{margin:`${a.Ks.px(23*c.D)} 0 ${a.Ks.px(4*c.D)}`})]),metrics:a.Ks.joinClasses([y.metrics,o.b.style({color:l.Q1.CoreBlue50,letterSpacing:0,fontWeight:"bold",fontSize:a.Ks.px(15*c.D),lineHeight:a.Ks.px(23*c.D),$nest:{"& td":{width:a.Ks.percent(21.875)}}})])},b=({stats:e})=>s.createElement("section",{className:v.generalMetricsSection},s.createElement("h2",{className:v.generalMetricsHeader},"General metrics"),s.createElement("table",null,s.createElement("tbody",null,s.createElement("tr",{className:v.metrics},s.createElement("td",null,e.chars.toLocaleString("en-US")),s.createElement("td",null,e.words.toLocaleString("en-US")),s.createElement("td",null,e.sentences),s.createElement("td",null,g.Xq(e.readingTime)),s.createElement("td",null,g.Xq(e.speakingTime))),s.createElement("tr",{className:_.xn.text},s.createElement("td",null,"characters"),s.createElement("td",null,"words"),s.createElement("td",null,"sentences"),s.createElement("td",null,"reading",s.createElement("br",null),"time"),s.createElement("td",null,"speaking",s.createElement("br",null),"time")))));var S,k=i(27917),C=i(90660);!function(e){e.checkMark="report-components-checkMark"}(S||(S={})),a.Ks.joinClasses([S.checkMark,o.b.style({display:"inline-block",marginRight:a.Ks.px(7*c.D),marginBottom:a.Ks.px(4*c.D),width:a.Ks.px(16*c.D),height:a.Ks.px(16*c.D),verticalAlign:"middle"})]);const w="report-components-radial_progress-";var E;!function(e){e.radialProgressBar=`${w}radialProgressBar`,e.radialProgressText=`${w}radialProgressText`,e.radialProgressDescription=`${w}radialProgressDescription`}(E||(E={}));const x={radialProgressBar:a.Ks.joinClasses([E.radialProgressBar,o.b.style({width:a.Ks.px(71*c.D),height:a.Ks.px(71*c.D),fontWeight:"bold",transform:`translateX(${a.Ks.px(-6*c.D)})`,fill:l.Q1.CoreNeutral90})]),radialProgressText:a.Ks.joinClasses([E.radialProgressText,o.b.style({fontSize:"20px"})]),radialProgressDescription:a.Ks.joinClasses([E.radialProgressDescription,o.b.style({fontWeight:"normal",fontSize:"11px",fill:l.Q1.CoreNeutral60})])},M=({percentage:e,colorType:t,iconSize:i,description:n})=>s.createElement(C._,{percentage:e,colorType:t,iconSize:i,description:n,theme:{radialProgressBar:x.radialProgressBar,radialProgressText:x.radialProgressText,radialProgressDescription:x.radialProgressDescription}}),T="report-sections-score-",A={scoreTable:`${T}scoreTable`,issuesSummary:`${T}issuesSummary`,issueCounters:`${T}issueCounters`,issueCounter:`${T}issueCounter`,issuesLeftBlock:`${T}issuesLeftBlock`,total:`${T}total`,score:`${T}score`,writingIssues:`${T}wrtitingIssues`,critical:`${T}critical`,advanced:`${T}advanced`},I={display:"flex",verticalAlign:"top",alignItems:"center",$nest:{"& span":{paddingLeft:a.Ks.rem(.8)}}},B={display:"inline-block"},P={scoreTable:a.Ks.joinClasses([A.scoreTable,o.b.style(_.bi,{margin:`${a.Ks.px(22*c.D)} 0 ${a.Ks.px(5*c.D)}`,$nest:{"& th":{paddingBottom:a.Ks.px(7*c.D)},[`& .${A.score}`]:{width:a.Ks.percent(43.75)},[`& .${A.writingIssues}`]:{width:a.Ks.percent(56.25)}}})]),issuesSummary:a.Ks.joinClasses([A.issuesSummary,o.b.style(_.J9,I)]),issueCounters:a.Ks.joinClasses([A.issueCounters,o.b.style(_.J9,I,{paddingTop:a.Ks.px(30*c.D),whiteSpace:"nowrap"})]),issueCounter:a.Ks.joinClasses([A.issueCounter,o.b.style({letterSpacing:a.Ks.px(.2*c.D),fontWeight:"bold",fontSize:a.Ks.px(15*c.D),lineHeight:a.Ks.px(19*c.D)})]),issuesLeftBlock:a.Ks.joinClasses([A.issuesLeftBlock,o.b.style(B)]),total:a.Ks.joinClasses([A.total,o.b.style(B,{width:a.Ks.percent(38.88),$nest:{[`& .${A.issueCounter}`]:{color:l.Q1.CoreNeutral90,letterSpacing:0,fontSize:a.Ks.px(18*c.D)}}})]),critical:a.Ks.joinClasses([A.critical,o.b.style(B,{width:a.Ks.percent(38.88),$nest:{[`& .${A.issueCounter}`]:{color:l.Q1.CoreRed40}}})]),advanced:a.Ks.joinClasses([A.advanced,o.b.style(B,{width:a.Ks.percent(22.24),$nest:{[`& .${A.issueCounter}`]:{color:l.Q1.CoreYellow60}}})]),score:a.Ks.joinClasses([A.score]),writingIssues:a.Ks.joinClasses([A.writingIssues])};function F(e){return e>85?C._.ColorType.eggBlue:e>60?C._.ColorType.dandelion:C._.ColorType.radicalRed}const N=({issues:e,className:t,text:i})=>s.createElement("div",{className:t},s.createElement("div",{className:P.issueCounter},e||s.createElement(k.In.Checkmark,null)),i),R=({critical:e,advanced:t})=>s.createElement("td",{className:P.issueCounters},s.createElement(N,{className:P.total,issues:e+t,text:"Issues left"}),s.createElement(N,{className:P.critical,issues:e,text:"Critical"}),s.createElement(N,{className:P.advanced,issues:t,text:"Advanced"})),L=({score:e})=>s.createElement("td",null,s.createElement(M,{colorType:F(e),iconSize:C._.IconSize.pdf,percentage:e}),s.createElement("p",{className:_.xn.text},"This text scores better than ",e,"%",s.createElement("br",null),"of all texts checked by Grammarly")),D=()=>s.createElement("section",{className:_.xn.section,"data-name":"no-writing-issues"},s.createElement("table",{className:P.scoreTable},s.createElement("thead",{className:_.xn.sectionHeader},s.createElement("tr",null,s.createElement("th",{className:P.writingIssues},"Writing Issues"))),s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:P.issuesSummary},s.createElement(k.In.Checkmark,null),s.createElement("span",null,"No issues found")))))),O=({score:e,critical:t,advanced:i})=>s.createElement("section",{className:_.xn.section,"data-name":"section-score-"+e},s.createElement("table",{className:P.scoreTable},s.createElement("thead",{className:_.xn.sectionHeader},s.createElement("tr",null,s.createElement("th",{className:P.score},"Score"),s.createElement("th",{className:P.writingIssues},"Writing Issues"))),s.createElement("tbody",null,s.createElement("tr",null,s.createElement(L,{score:e}),s.createElement(R,{critical:t,advanced:i}))))),H=({score:e,critical:t,advanced:i})=>t||i?s.createElement(O,{score:e,critical:t,advanced:i}):s.createElement(D,null);var K=i(86922),$=i(74416),V=i(78674);const U="report-sections-plagiarism-",G={plagiarismSection:`${U}plagiarismSection`,plagiarismSectionHeader:`${U}plagiarismSectionHeader`,original:`${U}original`,plagiarismMark:`${U}plagiarismMark`,score:`${U}score`,percent:`${U}percent`,sources:`${U}sources`,sourcesCount:`${U}sourcesCount`,scoreDescription:`${U}scoreDescription`},Q={plagiarismSection:a.Ks.joinClasses([G.plagiarismSection,o.b.style(_.f1,{pageBreakAfter:"always"})]),plagiarismSectionHeader:a.Ks.joinClasses([G.plagiarismSectionHeader,o.b.style(_.Co,{margin:`${a.Ks.px(23*c.D)} 0 ${a.Ks.px(10*c.D)}`})]),original:a.Ks.joinClasses([G.original,o.b.style(_.J9,{display:"flex",alignItems:"center"})]),plagiarismMark:a.Ks.joinClasses([G.plagiarismMark,o.b.style({marginRight:a.Ks.rem(.8)})]),score:a.Ks.joinClasses([G.score,o.b.style(_.J9,{width:a.Ks.percent(21.875)})]),percent:a.Ks.joinClasses([G.percent,o.b.style({marginTop:0,width:a.Ks.px(64*c.D),textAlign:"center"})]),sources:a.Ks.joinClasses([G.sources,o.b.style(_.J9,{paddingTop:a.Ks.px(28*c.D),paddingBottom:0,width:a.Ks.percent(78.125),verticalAlign:"top"})]),sourcesCount:a.Ks.joinClasses([G.sourcesCount,o.b.style({color:l.Q1.CoreNeutral90,letterSpacing:0,fontWeight:"bold",fontSize:a.Ks.px(18*c.D),lineHeight:a.Ks.px(18*c.D)})]),scoreDescription:a.Ks.joinClasses([G.scoreDescription,o.b.style(_.J9,{paddingTop:a.Ks.px(10*c.D),whiteSpace:"pre-line"})])},W=({plagiarismData:e})=>{const t=s.useContext(K.S.Context);return s.createElement("section",{className:Q.plagiarismSection,"data-name":"section-plagiarism-"+(e.state===V.p.PlagiarismCheckingState.CHECKED?e.score:-1)},s.createElement("h2",{className:Q.plagiarismSectionHeader},"Plagiarism"),e.state===V.p.PlagiarismCheckingState.NOT_CHECKED?s.createElement("p",{className:_.xn.text},"This text hasnt been checked for plagiarism"):$.Q.isMin(e.score)?s.createElement("p",{className:Q.original},s.createElement(k.In.Checkmark,{className:Q.plagiarismMark}),"This text seems 100% original. Grammarly found no matching text on",s.createElement("br",null),"the Internet or in ProQuests databases."):s.createElement("table",{className:_.xn.genericTable},s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:Q.score},s.createElement(M,{colorType:C._.ColorType.lightVisteria,iconSize:C._.IconSize.pdf,percentage:$.Q.prism.reverseGet(e.score),description:"%"})),s.createElement("td",{className:Q.sources},s.createElement("div",{className:Q.sourcesCount},e.sources),e.sources>1?"sources":"source")),s.createElement("tr",null,s.createElement("td",{colSpan:2,className:Q.scoreDescription},t.performance.report.plagiarismDescription(e.score,e.sources))))))},q="report-sections-writing_issues-",z={writingIssuesSection:`${q}writingIssuesSection`,writingIssuesTable:`${q}writingIssuesTable`,issueHeader:`${q}issueHeader`,categoryAmount:`${q}categoryAmount`,issueAmount:`${q}issueAmount`,circle:`${q}circle`,oval:`${q}oval`,generalTitle:`${q}generalTitle`,issueTitle:`${q}issueTitle`,categoryTitle:`${q}categoryTitle`,fakeHeader:`${q}fakeHeader`,progressBarCell:`${q}progressBarCell`,issueProgressBar:`${q}issueProgressBar`,issueContent:`${q}issueContent`,temporaryHeader:`${q}temporaryHeader`,progressBarBg:`${q}progressBarBg`},j={marginLeft:a.Ks.px(6*c.D),width:a.Ks.px(20*c.D),height:a.Ks.px(20*c.D),borderRadius:a.Ks.px(10*c.D),background:l.Q1.CoreRed40,color:l.Q1.CoreNeutral0,textAlign:"center",fontSize:a.Ks.px(12*c.D),lineHeight:a.Ks.px(20*c.D)},J={paddingLeft:a.Ks.px(22*c.D),width:a.Ks.px(293*c.D),color:l.Q1.CoreNeutral90,letterSpacing:0,fontSize:a.Ks.px(14*c.D),lineHeight:a.Ks.px(24*c.D)},Y={writingIssuesSection:a.Ks.joinClasses([z.writingIssuesSection,o.b.style({borderTop:`1px solid ${l.Q1.CoreNeutral30}`})]),writingIssuesTable:a.Ks.joinClasses([z.writingIssuesSection,o.b.style(_.bi,{position:"relative",marginBottom:a.Ks.px(22*c.D),width:a.Ks.px(437*c.D),$nest:{"& td, & th":{verticalAlign:"top",pageBreakInside:"avoid"}}})]),issueHeader:a.Ks.joinClasses([z.issueHeader,o.b.style({pageBreakAfter:"avoid"})]),categoryAmount:a.Ks.joinClasses([z.categoryAmount,o.b.style({width:a.Ks.px(32*c.D),fontWeight:"bold",lineHeight:a.Ks.px(22*c.D)})]),issueAmount:a.Ks.joinClasses([z.issueAmount,o.b.style({paddingRight:a.Ks.px(10*c.D),color:l.Q1.CoreRed40,textAlign:"right",fontWeight:"bold",fontSize:a.Ks.px(13*c.D),lineHeight:a.Ks.px(24*c.D)})]),circle:a.Ks.joinClasses([z.circle,o.b.style(j)]),oval:a.Ks.joinClasses([z.oval,o.b.style(j,{width:a.Ks.px(24*c.D)})]),generalTitle:a.Ks.joinClasses([z.generalTitle,o.b.style(J)]),issueTitle:a.Ks.joinClasses([z.issueTitle,o.b.style(J,{textTransform:"lowercase",fontWeight:"normal",$nest:{"&:first-letter":{textTransform:"capitalize"}}})]),categoryTitle:a.Ks.joinClasses([z.categoryTitle,o.b.style(J,{fontWeight:"bold"})]),fakeHeader:a.Ks.joinClasses([z.fakeHeader,o.b.style({position:"absolute",top:0,left:0,width:a.Ks.percent(100),background:l.Q1.CoreNeutral0,lineHeight:a.Ks.px(24*c.D)})]),progressBarCell:a.Ks.joinClasses([z.progressBarCell,o.b.style({width:a.Ks.px(112*c.D)})]),issueProgressBar:a.Ks.joinClasses([z.issueProgressBar,o.b.style({marginTop:a.Ks.px(12*c.D),minWidth:a.Ks.px(5*c.D),height:a.Ks.px(5*c.D),borderRadius:a.Ks.px(6*c.D),background:`linear-gradient(to right, ${l.Q1.CoreRed30}, ${l.Q1.CoreRed40})`,boxShadow:`0 0 0 ${a.Ks.px(3*c.D)} ${l.Q1.CoreNeutral0}`})]),issueContent:a.Ks.joinClasses([z.issueContent,o.b.style({pageBreakInside:"avoid"})]),temporaryHeader:a.Ks.joinClasses([z.temporaryHeader,o.b.style({pageBreakInside:"avoid"})]),progressBarBg:a.Ks.joinClasses([z.progressBarBg,o.b.style({width:a.Ks.percent(100),borderRadius:a.Ks.px(6*c.D),backgroundColor:l.Q1.CoreNeutral10})])},Z=({maxIssues:e,count:t})=>{let i=t/e*100;return i>94&&i<98?i=94:i>=98&&(i=100),s.createElement("div",{className:Y.progressBarBg},s.createElement("div",{className:Y.issueProgressBar,style:{width:`${i}%`}}))},X=({category:e,categoryIssues:t})=>s.createElement("tr",{className:Y.temporaryHeader},s.createElement("th",{className:Y.categoryAmount},s.createElement("div",{className:t>99?Y.oval:Y.circle},t)),s.createElement("th",{className:Y.categoryTitle},e),s.createElement("th",{className:Y.progressBarCell})),ee=({issues:e})=>{let t=0;return s.createElement("section",{className:Y.writingIssuesSection},s.createElement("h2",{className:_.xn.sectionHeader},"Writing Issues"),Object.entries(e).map((([e,i])=>{let s=0;return{category:e,issues:Object.entries(i).map((([e,i])=>(i>t&&(t=i),s+=i,{name:e,count:i}))),issuesCount:s}})).map((({category:e,issuesCount:i,issues:n})=>s.createElement("table",{key:e,className:Y.writingIssuesTable},s.createElement("thead",{className:Y.issueHeader},s.createElement(X,{category:e,categoryIssues:i})),s.createElement("tbody",null,n.map((({name:e,count:i})=>s.createElement("tr",{key:e,className:Y.issueContent},s.createElement("td",{className:Y.issueAmount},i),s.createElement("td",{className:Y.issueTitle},e),s.createElement("td",null,s.createElement(Z,{maxIssues:t,count:i}))))))))))};var te=i(12109)},82287:(e,t,i)=>{i.d(t,{Co:()=>d,J9:()=>p,bi:()=>h,f1:()=>c,xn:()=>u});var s=i(11864),n=i(29120),r=i(27199),a=i(14754);const o="report-sections-",l={section:`${o}section`,sectionHeader:`${o}sectionHeader`,genericTable:`${o}genericTable`,text:`${o}text`},c={borderTop:`1px solid ${r.Q1.CoreNeutral30}`,pageBreakInside:"avoid"},d={marginTop:s.Ks.px(24*a.D),color:r.Q1.CoreNeutral90,letterSpacing:0,fontWeight:"bold",fontSize:s.Ks.px(18*a.D),lineHeight:s.Ks.px(32*a.D)},h={width:s.Ks.percent(100),tableLayout:"fixed",textAlign:"left"},p={color:r.Q1.CoreNeutral50,letterSpacing:s.Ks.px(.11*a.D),fontSize:s.Ks.px(13*a.D),lineHeight:s.Ks.px(20*a.D)},u={section:s.Ks.joinClasses([l.section,n.b.style(c)]),sectionHeader:s.Ks.joinClasses([l.sectionHeader,n.b.style(d)]),genericTable:s.Ks.joinClasses([l.genericTable,n.b.style(h)]),text:s.Ks.joinClasses([l.text,n.b.style(p)])}},54322:(e,t,i)=>{i.d(t,{W4:()=>l,X3:()=>c});var s=i(63336),n=i(15114),r=i(889),a=i(29120),o=i(72900);function l(e,t,i){return(0,s.pipe)(e,d,h(t),p(i,t.length+1),m,(e=>e.innerHTML))}const c=()=>a.b.getStyles()+`\n.${n.Xz.markBulkApplied&&n.Xz.markBulkApplied.split(/\s/)[0]} { border-bottom-style: hidden !important }`+`\n.${n.Xz.markSelected&&n.Xz.markSelected.split(/\s/)[0]} { background-color: transparent !important }`,d=e=>{const t=document.createElement("div");return t.innerHTML=e,t},h=e=>t=>(e.reduce(function(e){return(t,i,s)=>(i.getHighlightRanges().filter(r.l.isMainView).forEach((i=>{const n=e.querySelectorAll(`[${g.MARK_ID}="${i.meta.id}"]`);if(n.length>0){const e=n[n.length-1],i=function(e,t){const i=document.createElement("span");return i.className=o.xn.superscriptContainer,i.innerHTML=`<span class="${e} ${o.xn.superscript}" data-superscript>${t+1}</span>`,i}(e.classList.value,s);e.appendChild(i),t.push(i)}})),t)}(t),[]).forEach(f),Array.from(t.querySelectorAll("span."+o.hz)).forEach(_),t),p=(e,t=0)=>i=>(e.forEach(((e,s)=>e.getHighlightRanges().filter(r.l.isMainView).forEach((e=>{const n=i.querySelectorAll(`[${g.MARK_ID}="${e.meta.id}"]`),r=(t+s).toString();n.forEach((e=>e.setAttribute(g.VERTICAL_UNDERLINE,r))),Boolean(n[0])&&(n[0].setAttribute(g.VERTICAL_START,""),u(n[0],r),n[n.length-1].setAttribute(g.VERTICAL_END,""))})))),i),u=(e,t)=>e.insertAdjacentHTML("afterbegin",`<span ${g.VERTICAL_INDEX}>${t}</span><span ${g.VERTICAL_BODY}><br /></span>`),m=e=>(e.querySelectorAll(`[${g.VERTICAL_INDEX}]`).forEach((t=>{const i=t.textContent;e.querySelectorAll(`[${g.VERTICAL_UNDERLINE}="${i}"] [${g.VERTICAL_END}]`).forEach((e=>{e.removeAttribute(g.VERTICAL_END)}))})),e);var g;function _(e,t,i){var s,n;i.length>t+1&&(s=e,n=i[t+1],s.textContent.length-function(e,t){const i=document.createRange();return i.setStartAfter(e),i.setEndBefore(t),i.toString().length}(s,n)>=0)&&function(e){e.style.width="auto",e.parentElement.insertAdjacentElement("afterend",e)}(e)}function f(e){if(e.children.length>0&&e.previousSibling){const t=Array.from(e.children);e.innerHTML="",y(e.previousSibling).concat(t).sort(((e,t)=>Number(e.textContent)-Number(t.textContent))).forEach((t=>e.appendChild(t)))}}function y(e){let t=[];return e instanceof Element?(e.matches(`[${g.MARK_ID}]`)&&e.lastElementChild&&e.lastElementChild.classList.contains(o.hz)&&(t=Array.from(e.lastElementChild.children),e.lastElementChild.remove()),e.lastElementChild?t.concat(y(e.lastElementChild)):t):t}!function(e){e.MARK_ID="data-mark-id",e.VERTICAL_UNDERLINE="data-vertical-underline",e.VERTICAL_START="data-vertical-underline-start",e.VERTICAL_BODY="data-vertical-underline-body",e.VERTICAL_END="data-vertical-underline-end",e.VERTICAL_INDEX="data-vertical-underline-index"}(g||(g={}))},14754:(e,t,i)=>{i.d(t,{D:()=>s});const s=1.7},78450:(e,t,i)=>{i.d(t,{g:()=>p});var s=i(23988),n=i(63336),r=i(41797),a=i(95168),o=i(6987),l=i(29052),c=i(77396),d=i(69063),h=i(94386);class p{get currentPlan(){return this._model.currentPlan}get offer(){return this._model.offer}get savedPrice(){return this._model.savedPrice}get nextPaymentDate(){return this._model.nextPaymentDate}constructor(e,t,i,p){(0,s._)(this,"_model",void 0),(0,s._)(this,"_modalOperations",void 0),(0,s._)(this,"_notificationsManager",void 0),(0,s._)(this,"_telemetry",void 0),(0,s._)(this,"_log",void 0),(0,s._)(this,"changePlan",void 0),(0,s._)(this,"_handleChangePlanError",void 0),(0,s._)(this,"close",void 0),this._model=e,this._modalOperations=t,this._notificationsManager=i,this._telemetry=p,this._log=d.Bx.Logging.getLogger("view.model.change.plan"),this.changePlan=()=>(this._telemetry.gnarSpec.changePlanConfirmationSwitchPlanButtonClick(this._model.daysToRenewal,this._model.currentPlanType,this._telemetry.pageId),r.H((0,n.pipe)(this._model.changePlan,l.qE(this._handleChangePlanError),c.hq)).pipe(a.M(this.close),o.n((()=>(this._telemetry.gnarSpec.changePlanFormSuccess(this._model.daysToRenewal,this._model.currentPlanType,this._telemetry.pageId),this._notificationsManager.enqueue("changePlanSuccess",{planName:this.offer.title}))))).toPromise()),this._handleChangePlanError=e=>{this._log.error(`Cannot change plan reason: ${e.reason}`,e.originalError);const t=h.sw.isErrorLike(e.originalError)&&e.originalError.message;this._telemetry.gnarSpec.changePlanFormFail(this._telemetry.pageId,`reason: ${e.reason}, error: ${t}`),this._notificationsManager.enqueue("error").toPromise()},this.close=()=>{this._modalOperations.onClose(),this._telemetry.gnarSpec.changePlanConfirmationCloseButtonClick(this._model.daysToRenewal,this._model.currentPlanType,this._telemetry.pageId)}}}},80949:(e,t,i)=>{var s,n;i.d(t,{f:()=>s,p:()=>n}),function(e){let t;!function(e){e.starting="starting",e.visuallyReady="visuallyReady",e.interactionReady="interactionReady",e.readyToDrag="readyToDrag",e.close="close",e.focusStateChanged="focusStateChanged"}(t=e.Kind||(e.Kind={})),e.isStarting=e=>e.kind===t.starting,e.isVisuallyReady=e=>e.kind===t.visuallyReady,e.isInteractionReady=e=>e.kind===t.interactionReady,e.isReadyToDrag=e=>e.kind===t.readyToDrag,e.isClose=e=>e.kind===t.close,e.isFocusStateChanged=e=>e.kind===t.focusStateChanged}(s||(s={})),function(e){let t,i;!function(e){e.FocusRequested="focusRequested",e.StatusChanged="statusChanged"}(t=e.Kind||(e.Kind={})),function(e){e.PremiumSuggestionsUphook="PremiumSuggestionsUphook",e.Plagiarism="Plagiarism"}(i=e.Source||(e.Source={}));var s=e.isStatusChanged=e=>e.kind===t.StatusChanged,n=e.isFocusRequested=e=>e.kind===t.FocusRequested;e.isIncoming=e=>s(e),e.isOutgoing=e=>n(e)}(n||(n={}))},70823:(e,t,i)=>{i.d(t,{C:()=>U,F2:()=>O,Fi:()=>D,H4:()=>Q,Ip:()=>K,Nc:()=>V,ii:()=>H,n$:()=>L,xs:()=>G});var s=i(83531),n=i(10334),r=i(17171),a=i(30040),o=i(13448),l=i(15466),c=i(6742),d=i(80074),h=i(12704),p=i(28986),u=i(62822),m=i(42543),g=i(35749),_=i(35413),f=i(41797),y=i(78339),v=i(15491),b=i(23121),S=i(29052),k=i(58889),C=i(36840),w=i(44297),E=i(86562),x=i(77396),M=i(76720),T=i(69063),A=i(80029),I=i(98719),B=i(40884),P=i(40005),F=i(18286),N=i(80949);const R=T.Bx.Logging.getLogger("Cheetah.TextInsertion"),L=(e,t,i,s,n,r)=>({getText:t=>(0,a.pipe)(b.zb((()=>e.getText().substring(t.start,t.end))),S.Mr),flush:()=>S.TX((()=>Promise.resolve(e.flushChanges())),k.toError),insertText:e=>(R.info("Inserting text"),(0,a.pipe)((new p.R).insert(e),(e=>t.replaceCurrentSelectionWith(e)),S.wu((e=>(R.error("Text insertion error",e),e)),(()=>{s(),R.info("Text inserted")})))),copyText:e=>r(e,"somethingCopied").then(C.Yi),setContextHighlight:(e,t)=>{i.setContextHighlight(e,t)},selectedRange:n,textUpdated:e.contentUpdated.pipe(u.u(void 0))}),D=(e,t)=>{const i=new m.B7;return e.registerExternalMessageHandler((e=>(i.next(e),(0,o.El)(e)?h.Q.Result.STOP_HANDLING:h.Q.Result.CONTINUE_HANDLING))),{capiService:new l.V({inboundCAPIMessages:g.x(_.v((()=>f.H(Object.values(t.get())))).pipe(y.p(o.Uv)),i),sendCAPIMessage:({action:t,data:i,shouldInjectRev:s,shouldInjectSessionId:a})=>{if("user_action"===t){const{componentId:t,userAction:s}=i;return e.sendUserAction(t,s)}return e.enqueueExternalCommand((({id:e,sessionId:o,currentRevision:l})=>(0,r._)((0,n._)({action:t,id:e},i),{rev:!0===s?l:void 0,sessionId:!0===a?o:void 0})))}}),capiMessages:i}},O=(e,t)=>({user:d.s.combine(e.profile,t.dialectOrDefault,((t,i)=>({kind:"signed-in",id:t.id,isPremium:B.DY.isPremium(e.features.denaliUserType),dialect:i,institution:(0,a.pipe)(t.institutionInfo,w.map((e=>({id:e.id,name:e.name,logoUrl:(0,a.pipe)(e.vox,w.chain((e=>e.logoUrl)),w.toUndefined),styleGuideEnabled:w.isSome(e.vox)})))),email:t.email,editorFeatures:{plagiarismDisabled:e.features.plagiarism.get()===B.Fh.disabled}}))),setDialect:e=>(0,a.pipe)(S.TX((()=>t.setDialect(e)),k.toError),S.Tj(C.Yi))}),H=e=>({deepLinkRequests:e.outgoing.pipe(v.T((e=>{switch(e.source){case N.p.Source.PremiumSuggestionsUphook:return"premiumSuggestionsUphook";case N.p.Source.Plagiarism:return"plagiarismView";default:return(0,E.AS)(e.source)}}))),notifyStatusChanged:(t,i)=>{switch(t){case"plagiarismView":e.push({kind:N.p.Kind.StatusChanged,source:N.p.Source.Plagiarism,available:i.available,focused:i.active});break;case"premiumSuggestionsUphook":e.push({kind:N.p.Kind.StatusChanged,source:N.p.Source.PremiumSuggestionsUphook,available:i.available,focused:i.active});break;case"performanceScoreView":break;default:(0,E.AS)(t)}}}),K=(e,t,i,s)=>{const o=F.J.create(e.gnarSpec),l={pageId:e.pageId,upgradeHookVariant:s.isEligibleForPro?"pro":s.isEligibleForFreeTrial?"premiumTrial":"premium"};return{trackUphookShown:t=>(0,a.pipe)(S.Gg((()=>{switch(t.name){case"grammarlyGoPrompts":return o.countShow((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackShow((0,r._)((0,n._)({},l),{sessionUuid:e.sessionUuid,placement:"grammarlyGoPrompts",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}));case"plagiarism":return o.countShow((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackShow((0,r._)((0,n._)({},l),{sessionUuid:e.sessionUuid,placement:"plagiarismView",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}));case"toneDetector":return o.countShow((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackShow((0,r._)((0,n._)({},l),{sessionUuid:e.sessionUuid,placement:"toneDetector",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}));default:(0,E.xb)(t.name)}})),x.hq),trackUphookClicked:t=>(0,a.pipe)(S.Gg((()=>{switch(t.name){case"grammarlyGoPrompts":return o.countClick((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackClick({pageId:e.pageId,sessionUuid:e.sessionUuid,placement:"grammarlyGoPrompts",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant});case"plagiarism":return o.countClick((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackClick((0,r._)((0,n._)({},l),{sessionUuid:e.sessionUuid,placement:"plagiarismView",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}));case"toneDetector":return o.countClick((0,r._)((0,n._)({},l),{upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant})),o.trackClick((0,r._)((0,n._)({},l),{sessionUuid:e.sessionUuid,placement:"toneDetector",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}));default:(0,E.xb)(t.name)}})),x.hq),trackUphookDismissed:t=>"plagiarism"===t.name?o.trackDismiss({pageId:e.pageId,sessionUuid:e.sessionUuid,placement:"plagiarismView",upgradeHookName:t.name,upgradeHookSlot:t.slot,upgradeHookVariant:t.variant}):(0,E.AS)(t.name),executeUphook:e=>(0,a.pipe)(S.L9((()=>{switch(e.name){case"grammarlyGoPrompts":return s.fromGrammarlyGO();case"advancedIssues":return s.openUpgradeUrl(I.YT.Place.DenaliDocument.editorDenaliAdvanced);case"plagiarism":case"toneDetector":return s.openUpgradeUrl(I.YT.Place.DenaliDocument.oggyPlagiarismUphook);default:(0,E.xb)(e.name)}})),x.hq),isEligibleForFreeTrial:s.isEligibleForFreeTrial}};var $;const V=e=>({domain:d.s.create(null),submitFeedback:t=>S.Gg((()=>e.gnarSpec.feedbackFormSubmit("",null!==($=t.message)&&void 0!==$?$:"",e.pageId,t.mood)))}),U=(e,t,i,n)=>{const{env:r}=(0,A.W)();return{hostInfo:{clientType:i.names.tracking,clientVersion:i.buildVersion.toString(),containerId:t,environment:"fb"===r||"dev"===r?"dev":r},sizeBehavior:P.w.fitContainer,dragBehavior:d.s.create({kind:"notDraggable"}),openUrl:(a=(0,s._)((function*(e){return b.$v(n.actions.openUrl(new M.U(e)))})),function(e){return a.apply(this,arguments)}),visuallyReady:()=>(e.push({kind:N.f.Kind.visuallyReady}),Promise.resolve()),interactionReady:t=>(e.push({kind:N.f.Kind.interactionReady,interactionReadyInfo:t}),Promise.resolve()),readyToDrag:t=>(e.push({kind:N.f.Kind.readyToDrag,readyToDragInfo:t}),Promise.resolve(void 0)),focusStateChanged:t=>(e.push({kind:N.f.Kind.focusStateChanged,focusState:t}),Promise.resolve()),starting:()=>(e.push({kind:N.f.Kind.starting}),Promise.resolve()),close:()=>(e.push({kind:N.f.Kind.close}),Promise.resolve())};var a},G=e=>({gates:c.V,experiments:c.r,getTreatment:(0,a.flow)(e.getTreatment,S.pG),peekTreatment:(0,a.flow)(e.peekTreatment,S.pG),logTreatment:(t,i)=>S.TX((()=>e.logTreatment(t,i)),(e=>String(e))),isGateEnabled:(0,a.flow)(e.isGateEnabled,S.pG)}),Q=(e,t)=>{const i=t.sendProfuseGnarEvents;return{performanceScoreReportShown:C.Yi,feedSuccessStateShown:t=>e.gnarSpec.sidebarSuccessStateShow(t,e.pageId,"applied",e.sessionUuid),feedFormChanged:(t,i,s)=>{switch(t){case"shortForm":e.gnarSpec.assistantSwitchToShortFormClick(e.pageId,null!=i?i:void 0,null!=s?s:void 0,e.sessionUuid);break;case"longForm":e.gnarSpec.assistantSwitchToLongFormClick(e.pageId,null!=i?i:void 0,null!=s?s:void 0,e.sessionUuid);break;default:(0,E.AS)(t)}},feedLensShown:t=>{e.gnarSpec.assistantLensShow(t,e.pageId,e.sessionUuid)},feedLensButtonClicked:t=>{e.gnarSpec.assistantLensButtonClick(t,e.pageId,e.sessionUuid)},actionButtonClicked:(t,i,s,n,r)=>{e.gnarSpec.assistantActionButtonClick(i,t,e.pageId,s,n,r,e.sessionUuid)},moreActionsButtonClicked:(t,i,s)=>{e.gnarSpec.assistantMoreActionsButtonClick(e.pageId,t,i,s,e.sessionUuid)},actionButtonRendered:(t,s,n,r,a)=>{i&&e.gnarSpec.assistantActionButtonRender(s,t,e.pageId,n,r,a,e.sessionUuid)},actionButtonShown:(s,n,r,a,o)=>{const l=t.isSmartPlagiarismUphookEnabled&&"plagiarism"===n;(i||l)&&e.gnarSpec.assistantActionButtonImpression(n,s,e.pageId,r,a,o,e.sessionUuid)},plagiarismCitationsStyleChanged:t=>{e.gnarSpec.assistantPlagiarismCitationsStyleChange(t,e.pageId,e.sessionUuid)},plagiarismCitationsStyleDropdownOpened:t=>{e.gnarSpec.assistantPlagiarismCitationsStyleDropdownOpen(e.pageId,t,e.sessionUuid)},toneReportShown:C.Yi,selectionContextHovered:()=>{e.gnarSpec.assistantSelectionContextHover(e.pageId,e.sessionUuid)},selectionContextClicked:()=>{e.gnarSpec.assistantSelectionContextClick(e.pageId,e.sessionUuid)},selectionContextRemoveButtonClicked:()=>{e.gnarSpec.assistantSelectionContextRemoveButtonClick(e.pageId,e.sessionUuid)},partialPageModeNotificationDismissed:C.Yi}}},40005:(e,t,i)=>{i.d(t,{w:()=>s});var s,n=i(21216),r=i(74168),a=i(43308),o=i(15491),l=i(58347),c=i(89769);!function(e){e.fitContainer=n.of({heightBehavior:{kind:"fitContainer"},widthBehavior:{kind:"fitContainer"}}),e.fitContent=e=>r.sc(e).pipe(a.E("height"),o.T((e=>e-100)),l.B(100),c.Z(550),o.T((e=>({heightBehavior:{kind:"fitContent",maxHeight:e},widthBehavior:{kind:"fitContainer"}}))))}(s||(s={}))},60083:(e,t,i)=>{i.d(t,{J:()=>k,x:()=>s});var s,n=i(23988),r=i(10334),a=i(17171),o=i(30040),l=i(63336),c=i(80074),d=i(90405),h=i(68594),p=i(15491),u=i(46669),m=i(65621),g=i(80837),_=i(47370),f=i(44297),y=i(58889),v=i(36840),b=i(58193),S=i(69063);!function(e){let t,i,n;!function(e){e.checking="checking",e.checkingIn="checkingIn",e.checkingOut="checkingOut"}(t=e.Type||(e.Type={})),function(e){e.loading="loading",e.processing="processing"}(i=e.TextType||(e.TextType={})),function(e){var t=e.eq=_.OW({text:f.getEq(_.kK),lens:f.getEq(_.kK),navigation:f.getEq(_.kK)}),i=(e.isIdle=e=>t.equals(e,i),e.idle={text:f.none,lens:f.none,navigation:f.none});e.text={text:f.some(s.TextType.loading),lens:f.none,navigation:f.none},e.processing={text:f.some(s.TextType.processing),lens:f.some(s.Type.checking),navigation:f.some(s.Type.checking)},e.navigationProcessing=(0,a._)((0,r._)({},i),{navigation:f.some(s.Type.checking)}),e.loading={text:f.some(s.TextType.loading),lens:f.some(s.Type.checking),navigation:f.some(s.Type.checking)},e.toString=function(e){const t=(0,l.pipe)(e.lens,f.filter((e=>"checkingOut"!==e)),f.fold((()=>"on"),(()=>"off"))),i=(0,l.pipe)(e.navigation,f.filter((e=>"checkingOut"!==e)),f.fold((()=>"on"),(()=>"off")));return`text: ${(0,l.pipe)(e.text,f.getOrElse((()=>"off")))}; lens: ${t}; nav: ${i}`}}(n=e.State||(e.State={}))}(s||(s={}));class k{dispose(){this._subs.dispose()}listenEngineErrors(e){this._subs.push(e.pipe(d.oE).subscribe(y.fold((()=>this.state.set(s.State.idle)),v.Yi)))}_listenLoading(){this._subs.push(this.state.subscribe((e=>{this._log.debug(`State is changed to ${s.State.toString(e)}`)})),this._listenTimeseries("text",(e=>(0,l.pipe)(e.text,b.y0)),!0),this._listenTimeseries("lens",(e=>(0,l.pipe)(e.lens,f.filter((e=>"checkingOut"!==e)),f.map((()=>"checking")),b.y0))),this._listenTimeseries("navigation",(e=>(0,l.pipe)(e.navigation,f.filter((e=>"checkingOut"!==e)),f.map((()=>"checking")),b.y0))))}_listenTimeseries(e,t,i=!1){return this.state.pipe(h.i(1),p.T((e=>t(e))),u.F(),p.T((t=>{if(void 0!==t)return i&&this._metric.getCounter(`${e}.${t}.start.counter`).increment(),{time:this._metric.getTimer(`${e}.${t}.time`).start(),counter:i?this._metric.getCounter(`${e}.${t}.stop.counter`):void 0}})),m.J()).subscribe((([e])=>{e&&(e.time.stop(),e.counter&&e.counter.increment())}))}constructor(e,t){(0,n._)(this,"_router",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"state",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_metric",void 0),(0,n._)(this,"_subs",void 0),this._router=e,this._features=t,this.state=c.s.create(s.State.idle),this._log=S.Bx.Logging.getLogger("denali_loader"),this._metric=S.Bx.TimeSeries.rootFemetrics.getMetric("denali_loader"),this._subs=new g.y.Keeper,this._listenLoading(),(0,l.pipe)(this._router.locationState,f.exists((e=>!0===e.openSidebar)))||this._features.sidebarOpenedByDefault?this.state.set(s.State.processing):this.state.set(s.State.text),(0,v.hJ)("setLoader",(e=>{switch(e){case"idle":return this.state.set(s.State.idle);case"text":return this.state.set(s.State.text);case"navigation":return this.state.set(s.State.navigationProcessing);case"all":return this.state.set(s.State.processing);default:return(0,o.absurd)(e)}}))}}},72404:(e,t,i)=>{i.d(t,{H:()=>s});var s,n=i(63336),r=i(80074),a=i(74416),o=i(22835),l=i(44297),c=i(36840),d=i(86562),h=i(14e3);!function(e){let t,i,s,p,u,m;function g(e,{emogenie:{popup:{intensities:i}}}){switch(e){case t.VeryStrong:return i.veryStrong;case t.Strong:return i.strong;case t.Moderate:return i.moderate;case t.Slight:return i.slight;default:return(0,d.xb)(e)}}!function(e){e[e.Low=1]="Low",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate",e[e.Strong=4]="Strong",e[e.VeryStrong=5]="VeryStrong"}(t||(t={})),e.intensitiesOrder=o.HP(t).map((e=>t[e])).filter((e=>"number"==typeof e)).sort(),function(e){e.fromConfidence=function(e,i){const s=a.w.unwrap(e);return s<.25?t.Slight:s<.5?t.Moderate:s/i>.5?t.VeryStrong:t.Strong}}(i||(i={})),function(e){e.fromModel=function({name:e,confidence:t,feedback:s,emoji:r},a,o,c){const d=i.fromConfidence(t,o);return{emoji:r,name:e,intensity:d,intensityCaption:g(d,c),feedback:s,actions:{like:{name:`${e}-like`,tooltip:c.emogenie.popup.actions.like,active:(0,n.pipe)(s,l.exists((e=>e===h.B.FeedbackType.Like))),disabled:l.isSome(s),handler:()=>a(e,h.B.FeedbackType.Like)},dislike:{name:`${e}-dislike`,tooltip:c.emogenie.popup.actions.dislike,active:(0,n.pipe)(s,l.exists((e=>e===h.B.FeedbackType.Dislike))),disabled:l.isSome(s),handler:()=>a(e,h.B.FeedbackType.Dislike)}}}}}(s=e.Item||(e.Item={})),function(e){let t;!function(e){e.Report="Report",e.ZeroState="ZeroState"}(t=e.Type||(e.Type={})),e.isReport=e=>e.type===p.Type.Report}(p=e.View||(e.View={})),function(e){e.fromModel=function(e,t,i){const n=e.reduce(((e,t)=>e+a.w.unwrap(t.confidence)),0),[r,...o]=e.map((e=>s.fromModel(e,t,n,i)));return{type:p.Type.Report,primaryItem:r,secondaryItems:o,onPopupClose:c.Yi,onPopupOpen:c.Yi}}}(u||(u={})),function(e){e.create=function(e,t,i){return{visualState:r.s.combine(e.emotions,t.documentLength.view("trimmed").view((e=>e<120)),((t,s)=>s||0===t.length?{type:p.Type.ZeroState,tooltipText:s?l.some(i.emogenie.popup.textIsTooShortMessage):l.none}:u.fromModel(t,e.sendEmotionFeedback,i)))}}}(m=e.ViewModel||(e.ViewModel={})),e.getIntensityTitle=g}(s||(s={}))},5731:(e,t,i)=>{i.d(t,{r:()=>g,B:()=>s});var s,n=i(50659),r=i(94673),a=i(30040),o=i(11089),l=i(90405),c=i(68594),d=i(95168),h=i(47370),p=i(58413),u=i(22835),m=i(59636);!function(e){let t;!function(e){e.editor="editor",e.checksFeed="checksFeed",e.navigation="navigation",e.menu="menu",e.title="title",e.support="support",e.formatting="formatting"}(t=e.Id||(e.Id={})),e.eq=h.OW({id:h.kK,order:h.US}),e.ord=(0,a.pipe)(p.ordNumber,p.contramap(u.Up("order"))),e.show=r.pJ({id:r.N4,order:r.Zo}),e.create=e=>({id:e,order:Object.values(t).findIndex((t=>t===e))});var i=e.Context=n.createContext(m.o.invariantContent("Focus"));e.createComponent=o.a.create(i),e.initTracking=(e,t)=>e.state.pipe(l.oE,c.i(1),d.M((e=>t.gnarSpec.focusSectionSwitched(t.pageId,e.id)))).subscribe()}(s||(s={}));var g,_=i(46669);!function(e){e.create=e=>({inFocus:e.isEditorFocused.pipe(c.i(1),_.F()),updateFocus:t=>t&&requestAnimationFrame((()=>e.restoreFocus("FocusManager")))})}(g||(g={}))},67014:(e,t,i)=>{i.d(t,{Pp:()=>Ei,E:()=>j.E,UO:()=>yi.U});var s,n=i(23988),r=i(10334),a=i(17171),o=i(30040),l=i(63336),c=i(80074),d=i(76005),h=i(61198),p=i(63967),u=i(62597),m=i(53717),g=i(69774),_=i(42543),f=i(80837),y=i(36094),v=i(89769),b=i(14342),S=i(15491),k=i(68594),C=i(38427),w=i(78339),E=i(54988),x=i(60269),M=i(29862),T=i(65141),A=i(46669),I=i(65621),B=i(69701),P=i(83541),F=i(28600),N=i(82718),R=i(95168),L=i(68101),D=i(21662),O=i(90405),H=i(62822),K=i(98514),$=i(22814),V=i(32260),U=i(6471),G=i(52267),Q=i(15966),W=i(37262),q=i(26251),z=i(79365),j=i(89011),J=i(44297),Y=i(36840),Z=i(58889),X=i(86562),ee=i(29052),te=i(58193),ie=i(41831),se=i(69063),ne=i(98719),re=i(40884);!function(e){e.create=()=>({doubleClickedWord:new _.B7})}(s||(s={}));var ae,oe=i(5731),le=i(91956),ce=i(45653),de=i(78884),he=i(87275),pe=i(6987),ue=i(61586),me=i(24946),ge=i(12486),_e=i(80949);!function(e){let t;e.focusAlertByClickedMark=e=>t=>({name:"focus alert by clicked mark",source:e.pipe(O.oE,w.p((e=>p.Fc.State.isRegistered(e.alert.state)&&!ce.A.isPremiumPreviewPlagiarism(e.alert))),R.M((e=>t.focusAlertHighlight((0,a._)((0,r._)({},e),{source:he.nl.forceText})))),S.T(Z.right))}),e.highlightMark=(e,t,i,s,n,r)=>a=>{const l=i.pipe(S.T(J.exists((e=>e.id===oe.B.Id.editor))),pe.n((e=>x.h(s.pipe(H.u(!0)),n.pipe(w.p((0,o.not)(o.identity)),H.u(!1))).pipe(S.T((t=>!t&&e)),A.F(),v.Z(!0)))));return{name:"highlight mark",source:a.alertHighlightChanges.pipe(pe.n(y._F.rafScheduler),P.skipBy(J.getEq(de.z.getEq())),S.T(J.filter((t=>J.isSome(e.getRegistered(t.alert.id))))),D.E(l,r),pe.n((([e,i,s])=>(0,o.pipe)(e,J.filter((e=>s||e.source===he.nl.forceText)),J.fold((()=>E.w),(e=>new ue.c((n=>(i&&s&&[he.nl.forceSidebar,p.Kz.api].includes(e.source)&&!ce.A.isPremium(e.alert)&&t.moveCursorToHighlight(e,"start"),(0,o.pipe)(t.focusAlertHighlight(e),Z.fold((t=>(n.next(Z.left({message:"Cannot focus mark",error:t,data:{alertId:e.alert.id,highlightIndex:e.highlightIndex}})),Y.Yi)),(t=>(n.next(Z.right(e)),()=>t.dispose())))))))))))))}},e.unfocusAlertHighlightOnSidebarClose=e=>t=>({name:"unfocus alert highlight on sidebar close",source:e.pipe(w.p((0,o.not)(o.identity)),R.M(t.unfocusAlertHighlight),S.T(Z.right))}),e.openInlineAlerts=(e,t)=>i=>({name:"open inline alert",source:e.state.pipe(pe.n((s=>s.isSidebarOpen?E.w:t.pipe(R.M((t=>{i.focusAlertHighlight({alert:t.alert,highlightIndex:t.highlightIndex,source:he.nl.forceText}),e.toggleSidebar(!0,p.Kz.text)})),S.T(Z.right)))))}),e.openAssistantWithActiveCard=(e,t)=>i=>({name:"open assistant with an active card",source:x.h(e.alertSwitchChanges.pipe(R.M((t=>{i.focusAlertHighlight((0,a._)((0,r._)({},t),{source:p.Kz.api})),t.source!==p.Kz.api&&e.toggleSidebar(!0,p.Kz.api)}))),e.activeLensId.pipe(D.E(e.state.view("isSidebarOpen")),pe.n((([s,n])=>(0,Y.Ub)(u.J.isPremiumId,u.J.isFreePremiumId)(s)?n?t.requestUphook():(e.toggleSidebar(!0,p.Kz.api),i.lifecycleEvents.pipe(w.p(_e.f.isVisuallyReady),me.s(1),pe.n(t.requestUphook))):E.w)))).pipe(S.T(Z.right))}),e.openAssistantWithPlagiarism=(e,t)=>i=>({name:"open assistant with plagiarism",source:e.activeLensId.pipe(D.E(e.state.view("isSidebarOpen")),pe.n((([s,n])=>u.J.isPlagiarismId(s)?n?t.requestPlagiarism():(e.toggleSidebar(!0,p.Kz.api),i.lifecycleEvents.pipe(w.p(_e.f.isVisuallyReady),me.s(1),pe.n(t.requestPlagiarism))):E.w)),S.T(Z.right))}),e.updateLoaderStateOnReady=e=>t=>({name:"update loader state on ready",source:t.lifecycleEvents.pipe(w.p(_e.f.isVisuallyReady),R.M((()=>e.state.modify((e=>(0,a._)((0,r._)({},e),{lens:J.none}))))),H.u(Z.right(void 0)))}),e.scrollAlertIntoView=(e,t)=>i=>({name:"scrollAlertIntoView",source:t.pipe(pe.n((t=>t?i.scrollIntoViewChanges.pipe(D.E(i.alertVisibilityFilter),w.p((([e,t])=>t(e.alert))),pe.n((([t])=>e.ensureAlertHighlightInViewport(t,200,d.nA.initial).pipe(S.T(Z.bimap((e=>({message:"Move focused mark into viewport: Cannot ensure alertHighlight in viewport",error:e,data:t})),(0,o.constant)(t))))))):E.w)))}),e.toggleAutoScroll=e=>t=>({name:"toggleAutoScroll",source:e.pipe(R.M(t.toggleAutoScroll),S.T(Z.right))}),function(e){e.create=(e,...t)=>i=>{const s=new f.y.Keeper,n=e.getLogger("Integration",ge.$.DEBUG,ge.I.ViewModel.base);return s.push(x.h(...t.map((e=>{const{name:t,source:s}=e(i);return s.pipe(R.M(Z.fold((e=>n.error(`${t}: ${e.message}`,e.error,e.data)),(e=>n.debug(t,e)))))}))).subscribe()),s}}(t=e.Factory||(e.Factory={}))}(ae||(ae={}));var fe=i(83531),ye=i(78323),ve=i(62723),be=i(58347),Se=i(48368),ke=i(21216),Ce=i(41797),we=i(19711),Ee=i(68533),xe=i(30744),Me=i(10047);function Te(e,t){return C.zV([e,t]).pipe(S.T((([e,t])=>e&&!t)))}function Ae(){return ke.of(!0)}function Ie(){return ke.of(!0)}function Be(e){const t=e.getText();return(0,l.pipe)(["Grammarly Premium can give you very helpful feedback on your writing. Passive voice can be fixed by Grammarly, and it can handle classical word-choice mistakes.","Grammarly Premium can give you very helpful feedback on your writing.","Passive voice can be fixed by Grammarly, and it can handle classical word-choice mistakes.","You'll find suggestions that can possibly help you revise a wordy sentence in an effortless manner."],Me.CX((e=>{const i=t.indexOf(e);return i>-1?J.some({index:i,length:e.length}):J.none})))}const Pe=[Se.f.Popup,Se.f.Popover];function Fe(e,t,i){e.modify((e=>{const s=e.slice(0);return s[t]=i,s}))}class Ne{_initSteps(e=new Set){this._stepsSubscriptions.forEach((e=>e.unsubscribe())),this._stepsSubscriptions=[],function(e,t,i,s,n,r,a,d){if(re.vI.isHidden(n))return[];const h=d.denali.showOnboardingTourA11yUpdates,p=h?function(e){return e.onboardingViewModels.pipe(pe.n((e=>(0,l.pipe)(e,J.fold((()=>ke.of(J.none)),(e=>e.onboarding.activeStep)))))).pipe(S.T((e=>(0,l.pipe)(e,J.fold((()=>!1),(e=>{var t;return"initial"===e.name||"initialBTS"===(null===(t=e)||void 0===t?void 0:t.name)}))))))}(r):ke.of(!1),u={id:j.E.StepId.Step11,switch:()=>function(e,t){return c.s.combine(t,e,((e,t)=>t&&J.isNone(e))).pipe(we.$())}(a.state.view("isSidebarOpen"),s),gnarName:"Step 1: Select active card",skipDot:h},m={id:j.E.StepId.Step4,switch:()=>{const e=function(e,t){return e.view(J.exists((e=>t.isRegistered(e.alert.id)&&ce.A.isDefault(e.alert)&&J.isSome(e.alert.getTransform()))))}(s,i);return Te(e,p)},gnarName:"Step 2: Apply alert",skipDot:h},g={id:j.E.StepId.GrammarlyGORewrite,switch:()=>function(e,t){return e.navigation.isGGOLensActive.pipe(xe.U(e.isGenAiAvailable.pipe(w.p(o.identity))),S.T((e=>(0,l.pipe)(t,J.fromPredicate((()=>!e)),J.chain(Be),J.fold(o.constFalse,o.constTrue)))))}(r,e),gnarName:"Step 3: Click GrammarlyGO Rewrite",skipDot:h,prepareStep:()=>(0,l.pipe)(r.navigation,J.fromPredicate((e=>!e.isGGOLensActive.get())),J.chain((()=>Be(e))),te.Mi((({index:t,length:i})=>{e.setCursor(t,i)})),J.fold(o.constFalse,o.constTrue))},_={id:j.E.StepId.GrammarlyGOIdeationAssistant,switch:()=>Te(function(e){return e.navigation.isGGOLensActive.pipe(S.T((e=>!e)))}(r),p),gnarName:"Step 4: Open GrammarlyGO Ideation Assistant",skipDot:h},f={id:j.E.StepId.Step1,switch:()=>Te(ke.of(!0),p),gnarName:"Step 5: Open Set Goals",skipDot:h},v={id:j.E.StepId.Step8,switch:()=>Te(ke.of(!0),p),gnarName:"Step 6: Open Performance",skipDot:h},b={id:j.E.StepId.Step9,switch:()=>{return i=e.contentUpdated.pipe(H.u(y.q6)),s=t.checkingState,Ce.H(s.pipe(w.p((e=>"idle"===e)),we.$(),H.u(!0))).pipe(Ee.h(i.pipe(we.$(),H.u(!1))));var i,s},gnarName:"Step 7: See synonyms",skipDot:h},k={id:j.E.StepId.Step10,switch:Ae,gnarName:"Step 8: Open left sidebar",skipDot:h},C={id:j.E.StepId.DocumentTitle,switch:Ie,gnarName:"Step 9: Edit title",skipDot:h};switch(n.content){case re.vI.Content.Oggy:return[m,f,v,k,C];case re.vI.Content.OggySplit:case re.vI.Content.WithoutInlineCards:return[m,g,_,f,v,k,C];case re.vI.Content.Full:return[u,m,g,_,f,v,b,k,C];default:return(0,X.xb)(n)}}(this._ded,this._sessionChecksModel,this._alertsReader,this._activeAlertHighlight,this._mode,this._cheetahViewModel,this._navigationViewModel,this._features).forEach(((t,i)=>this._addStep(t,i,e)))}isLastStep(e){return Boolean(this._steps[e].isLastStep)}isStepEnabled(e){return void 0!==this._steps[e]}subscribeForStep(e){const{state:t,gnarName:i}=this._steps[e];if(void 0===t)throw new Error("Illegal onboarding step id "+e);return{id:e,state:t,dotShown:()=>{this._telemetry.gnarSpec.onboardingStepDotOnboardingShow(this._telemetry.pageId,i)},dotClicked:()=>{(0,X.V1)(t.get()===Se.f.Dot,"Should be in dot state"),this._log.info("Dot clicked for: "+e),t.set(Se.f.Popup),this._telemetry.gnarSpec.onboardingStepOnboardingPass(this._telemetry.pageId,i)},popupIgnored:()=>{(0,X.V1)(this._isPopup(t.get()),"Should be in popup state"),this._log.info("Popup ignored for: "+e),t.set(Se.f.Hidden),this._updateStates()},popupClosed:()=>{(0,X.V1)(this._isPopup(t.get()),"Should be in popup state"),this._log.info("Popup closed for: "+e),t.set(Se.f.Passed),this._updateStates()},actionTaken:()=>{(0,X.V1)(this._isPopup(t.get())||t.get()===Se.f.Dot,"Should be in popup or dot state"),this._log.info("Action taken for: "+e),t.set(Se.f.Passed),this._updateStates(),this._telemetry.gnarSpec.onboardingStepOnboardingPass(this._telemetry.pageId,i)}}}unsubscribe(){this._subs.forEach((e=>e.unsubscribe())),this._stepsSubscriptions.forEach((e=>e.unsubscribe()))}getStepCompletionCallback(e){return()=>{if(this.isStepEnabled(e)){const t=this.subscribeForStep(e),i=t.state.get();(i===Se.f.Dot||this._isPopup(i))&&t.actionTaken()}}}changeState(e){this._enableState.set(e)}relaunchAllSteps(){this._initSteps()}_updateStates(){var e=this;return(0,fe._)((function*(){yield(0,Y.yy)(500);const t=e._switches.get();e._log.debug("Onboarding switches updated "+t);const i=e._states.get().slice();t.forEach(((e,t)=>{e||i[t]===Se.f.Hidden||i[t]===Se.f.Passed||(i[t]=Se.f.Hidden)}));const s=i.filter((t=>e._isPopup(t)||t===Se.f.Dot)).length;let n=Math.max(0,1-s);for(let s=0;s<i.length&&!(n<=0);++s)if(i[s]===Se.f.Hidden&&t[s]){var r,a,o;if(null!==(o=null===(r=(a=e._stepsByIdx[s]).prepareStep)||void 0===r?void 0:r.call(a))&&void 0!==o&&!o){i[s]=Se.f.Hidden;continue}e._stepsByIdx[s].skipDot?i[s]=e._features.denali.showOnboardingTourA11yUpdates?Se.f.Popover:Se.f.Popup:i[s]=Se.f.Dot,n--}const l=i.filter((t=>e._isPopup(t)||t===Se.f.Dot)).length;(0,X.V1)(l<=1,`Should be only 1 popups and dots visible, now ${l}`),e._states.set(i)}))()}constructor(e,t,i,s,r,a,l,d,h,p,u){(0,n._)(this,"_settings",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"_sessionChecksModel",void 0),(0,n._)(this,"_alertsReader",void 0),(0,n._)(this,"_mode",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_activeAlertHighlight",void 0),(0,n._)(this,"_getFirstTargetRect",void 0),(0,n._)(this,"_cheetahViewModel",void 0),(0,n._)(this,"_navigationViewModel",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_steps",void 0),(0,n._)(this,"_stepsByIdx",void 0),(0,n._)(this,"_switches",void 0),(0,n._)(this,"_states",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_stepsSubscriptions",void 0),(0,n._)(this,"_enableState",void 0),(0,n._)(this,"getFirstTargetRect",void 0),(0,n._)(this,"completionTrigger",void 0),(0,n._)(this,"_isPopup",void 0),(0,n._)(this,"_addStep",void 0),this._settings=e,this._ded=t,this._sessionChecksModel=i,this._alertsReader=s,this._mode=r,this._telemetry=a,this._activeAlertHighlight=l,this._getFirstTargetRect=d,this._cheetahViewModel=h,this._navigationViewModel=p,this._features=u,this._log=se.Bx.Logging.getLogger("OnboardingViewModelImpl",ge.$.TRACE),this._steps={},this._stepsByIdx=new Array,this._switches=c.s.create([]),this._states=c.s.create([]),this._subs=[],this._stepsSubscriptions=[],this._enableState=c.s.create(!0),this.getFirstTargetRect=this._getFirstTargetRect,this.completionTrigger=this._activeAlertHighlight.view(J.isSome),this._isPopup=e=>Pe.includes(e),this._addStep=(e,t,i)=>{Fe(this._switches,t,!1);const s=this._states.lens(ye.J2.index(t).compose(ye.J2.withDefault("dummy")));Fe(this._states,t,i.has(e.id)?Se.f.Passed:Se.f.Hidden),this._steps[e.id]={state:s,idx:t,gnarName:e.gnarName,isLastStep:e.isLastStep},this._stepsByIdx[t]=e,this._stepsSubscriptions.push(e.switch().pipe(ve.z(this._enableState,((e,t)=>e&&t))).subscribe((e=>Fe(this._switches,t,e)),(e=>{this._log.error("onboarding malfunction",e),Fe(this._states,t,Se.f.Passed)})))};const m=re.vI.isForced(r)?new Set:new Set(this._settings.onboardingPassed.get());this._initSteps(m),this._subs.push(this._switches.pipe(be.B(500)).subscribe((e=>this._updateStates()))),this._subs.push(this._states.pipe(k.i(1)).subscribe((e=>this._settings.updateOnboardingPassed(Object.keys(this._steps).filter((t=>e[this._steps[t].idx]===Se.f.Passed)))))),this._log.isEnabled(ge.$.TRACE)&&this._subs.push(this._states.subscribe((e=>this._log.debug("Onboarding states updated: "+e.join(", "))))),(0,Y.hJ)("fireOnboardingStep",((e,t)=>(0,o.pipe)(J.fromNullable(this._steps[e]),J.fold((()=>console.info("No such step "+e)),(e=>e.state.set(t)))))),(0,Y.hJ)("onboardingState",this)}}var Re=i(5875),Le=i(72204),De=i(7432),Oe=i(55340),He=i(72106),Ke=i(889),$e=i(40808),Ve=i(58538),Ue=i(26730);class Ge{getFirstSynonymRect(){return this.getFirstSynonym().pipe(S.T(J.chain((e=>J.fromEither(e.getRect())))))}getSynonymMarkRect(e){return ee.Mr(this._ded.getMarkRect(e))}scrollToMark(e,t,i){return this._ded.scrollToMark(e,{animate:i,paddingTop:t})}onPopupOpen(){(0,l.pipe)(this.viewState.get(),J.map((e=>e.synonymsState)),J.filter((0,Y.Ub)(Ve._g.isReady,Ve._g.isEmpty)),J.map((({stats:e,pname:t})=>({stats:e,pname:t}))),J.getOrElse((()=>({stats:Ve.yp.emptySynonymsStats,pname:"unknown"}))),(({pname:e,stats:t})=>{this._trackSynonymPopupOpen(e,t)}))}getFirstSynonym(){return ue.c.create((e=>{let t=J.none;const i=Qe(this._ded.getText()),s=i.length?J.some(De.vY.create(i[0].start,i[i.length-1].end)):J.none,n=(0,l.pipe)(s,J.fold((()=>[]),(e=>this._positionManager.findRanges((t=>Ke.l.isVisible(t)&&De.vY.isOverlap(t,e)))))),r=Ce.H(Promise.all(We(i,n).map(this.query))).pipe(S.T((0,o.flow)((0,Me.i8)(Ve._g.isReady),J.chain((e=>{const t=Oe.C.SynonymMark.generateSynonymOnboardingId(e.synonyms.id),i=De.vY.create(e.query.start,e.query.start+e.query.word.length),s=this._synonymsModel.positionManager.registerRange(t,i);return(0,l.pipe)(this._ded.changeMarks([He.J.Change.getCreateAction({range:()=>s,order:0,classes:[]})(t)]),(e=>e.created.get(t)),J.fromEither)})))),we.$()).subscribe((i=>{t=i,e.next(i)}));return()=>{J.map(this.disposeFirstSynonym)(t),r.unsubscribe()}}))}apply(e){const t=this.viewState.get();(0,l.pipe)(t,J.map((({synonymsState:t,activeWord:i})=>{if(!Ve._g.isReady(t))throw new X.zU("Synonym should exist.");this._trackSynonymAccept(t.pname,(0,r._)({},t.stats,Ve.yp.getSynonymStats(e,t.synonyms.synonymsOrGroups)),Ve.yp.getTimeToClose(t.readyAt));const s=this._synonymsModel.applySynonym({id:t.synonyms.id,dispose:Y.Yi,range:i},e);(0,$e.M7)((()=>this._notificationsManager.enqueue("alertUndo",{params:(0,$e.cm)([s])})),this._trackUndoCloseButton,(()=>(this._ded.flushChanges(),this._ded.contentUpdated))).subscribe((e=>"commit"===e?s.commit():s.undo()))}))),this.close("apply")}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_request(e){return this.query({start:e.start,word:e.meta.value}).then(J.some).catch((e=>(this._log.error("Error querying synonyms",e),J.none)))}_canShowPopup(e){return Ve._g.isReady(e)||Ve._g.isEmpty(e)}_deregisterRange(e){(0,l.pipe)(this._synonymsModel.positionManager.findById(e),J.fold(Y.Yi,(t=>{this._ded.flushChanges(),this._synonymsModel.positionManager.deregisterRange(e)})))}_handleState(){this._subs.push(this._inlineManager.doubleClickedWord.pipe(pe.n(this._emitCloseWhen),S.T(J.filter(this._isOnline)),O.cy((e=>(this._ded.flushChanges(),this._withRegisteredWord(e,(0,o.flow)(this._listenQuery,pe.n(this._createSynonymsState),S.T(J.some))))))).subscribe(y.H9(this.viewState),(e=>this._log.error("can not change syns state",e))))}constructor(e,t,i,s,r,a,d,h,p,u,m){(0,n._)(this,"_inlineManager",void 0),(0,n._)(this,"_positionManager",void 0),(0,n._)(this,"_synonymsModel",void 0),(0,n._)(this,"_networkState",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_activeAlertChanges",void 0),(0,n._)(this,"_trackUndoCloseButton",void 0),(0,n._)(this,"_trackSynonymPopupOpen",void 0),(0,n._)(this,"_trackSynonymPopupDismiss",void 0),(0,n._)(this,"_trackSynonymAccept",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_style",void 0),(0,n._)(this,"viewState",void 0),(0,n._)(this,"popupShown",void 0),(0,n._)(this,"_defaultClassName",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"disposeFirstSynonym",void 0),(0,n._)(this,"query",void 0),(0,n._)(this,"close",void 0),(0,n._)(this,"_withRegisteredWord",void 0),(0,n._)(this,"_listenQuery",void 0),(0,n._)(this,"_createSynonymsState",void 0),(0,n._)(this,"_removeMark",void 0),(0,n._)(this,"_createMark",void 0),(0,n._)(this,"_emitCloseWhen",void 0),(0,n._)(this,"_isOnline",void 0),this._inlineManager=e,this._positionManager=t,this._synonymsModel=i,this._networkState=s,this._ded=r,this._notificationsManager=a,this._activeAlertChanges=d,this._trackUndoCloseButton=h,this._trackSynonymPopupOpen=p,this._trackSynonymPopupDismiss=u,this._trackSynonymAccept=m,this._log=se.Bx.Logging.getLogger("LegacySynonymsViewModel"),this.viewState=c.s.create(J.none),this.popupShown=this.viewState.view(J.fold((()=>!1),(e=>e.popupVisible))),this._defaultClassName="defaultSynonymClass",this._subs=[],this.disposeFirstSynonym=e=>{this._ded.changeMarks([He.J.Change.getRemoveAction({range:()=>Z.getOrElse((e=>e))(e.range())},He.J.Change.RemoveType.full)(e.id)]),this._deregisterRange(e.id)},this.query=e=>(this._ded.flushChanges(),this._synonymsModel.query(e)),this.close=e=>{"closedByUser"===e&&(0,l.pipe)(this.viewState.get(),J.map((e=>e.synonymsState)),J.filter((0,Y.Ub)(Ve._g.isReady,Ve._g.isEmpty)),te.Mi((e=>{this._synonymsModel.ignore(e.synonyms.id),this._trackSynonymPopupDismiss(e.pname,e.stats,Ve.yp.getTimeToClose(e.readyAt))}))),this._inlineManager.closeSynonyms.next()},this._withRegisteredWord=(e,t)=>ue.c.create((i=>{const s=this._synonymsModel.positionManager.registerRange(Oe.C.SynonymMark.generateActiveWordRandomId(),e),n=t(s).subscribe(i);return()=>{n.unsubscribe(),this._deregisterRange(s.meta.id)}})),this._listenQuery=e=>ue.c.create((t=>(this._request(e).then((i=>{var s;null!==(s=t.closed)&&void 0!==s&&s||(0,l.pipe)(i,J.fold((()=>this.close("error")),(i=>t.next([e,i]))))})),()=>{this._synonymsModel.abortQuery()}))),this._createSynonymsState=([e,t])=>ue.c.create((i=>{const s=this._canShowPopup(t);return(0,l.pipe)(this._createMark(e,s),(n=>(0,l.pipe)(n.range(),Z.fold((e=>{this._log.error("Error creating Synonym state",e)}),(r=>{const a=this._synonymsModel.positionManager.registerRange(n.id,r),o={synonymsState:t,activeWord:e,activeMark:a,popupVisible:s};return i.next(o),()=>{this._deregisterRange(o.activeMark.meta.id),setTimeout((()=>this._removeMark(o)),10)}})))))})),this._removeMark=e=>{try{this._ded.flushChanges(),(0,l.pipe)(this._ded.getMarkById(e.activeMark.meta.id),Z.map((t=>{this._ded.changeMarks([He.J.Change.getRemoveAction({range:()=>(0,l.pipe)(t.range(),Z.getOrElse((e=>e)))},He.J.Change.RemoveType.full)(e.activeMark.meta.id)])})))}catch(e){this._log.error("Cannot remove synonym",e)}},this._createMark=(e,t)=>(0,l.pipe)(this._ded.changeMarks([He.J.Change.getCreateAction({range:()=>e,classes:t?[this._defaultClassName,this._style.synonym,this._style.markSelected]:[this._defaultClassName,this._style.markHidden],order:0})(Oe.C.SynonymMark.id)]),(e=>e.created.get(Oe.C.SynonymMark.id)),Z.fold((()=>null),o.identity)),this._emitCloseWhen=O.MA((()=>x.h(this._ded.contentUpdated,this._activeAlertChanges.pipe(k.i(1)),T.R(document,"keydown")).pipe(H.u(y.q6),R.M((()=>this.close("closedByUser")))))),this._isOnline=()=>"offline"!==this._networkState.getOnlineStatus(),this._style=(0,Ue.ID)(),this._handleState()}}const Qe=(e,t=10)=>{const i=/( |^)[a-z]{3,}\b/gim,s=[];let n;for(let r=0;(n=i.exec(e))&&r<t;r++){const e=n[0].replace(" ",""),t=i.lastIndex-e.length,r=t+e.length;s.push({start:t,word:e,end:r})}return s},We=(e,t)=>0===t.length||0===e.length?e:(()=>{const i=e[e.length-1].end,s=t.findIndex((e=>e.start>i)),n=s>=0?t.slice(0,s):t;return e.filter((e=>n.every((t=>!(e.start<=t.end&&t.start<=e.end)))))})();var qe=i(9654),ze=i(86780),je=i(74056),Je=i(11864);const Ye="denali-a11y-log-container",Ze="denali-a11y-alert-container",Xe="denali-a11y-status-container-",et=Je.Ks.style({position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",border:0});function tt(e){const t=document.getElementById(e);if(t)return t;{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t}}function it(e,t){const i=document.createElement("div");i.textContent=e,t.appendChild(i),setTimeout((()=>{i.remove()}),5e3)}function st(e){e.setAttribute("class",et),e.setAttribute("data-verified","true")}class nt{constructor(e){(0,n._)(this,"sessionUuid",c.s.create("")),e.pipe(w.p((({action:e})=>"start"===e)),S.T((({sessionUuid:e})=>e)),me.s(1)).subscribe(y.H9(this.sessionUuid))}}var rt,at=i(7808),ot=i(79239);!function(e){e.create=function(e,t,i,s){return new ct(e,t,i,s)},e.mock=function(e=ke.of(!1)){return new dt(e)}}(rt||(rt={}));const lt=/([^\s]+\s+[^\s]+)/;class ct{isAvailable(e){const t=e.pipe(S.T((e=>e.length<=5e3&&lt.test(e))));return C.zV([this._isCheetahAvailable,this._isInlineFeatureAvailable,this._isCheetahLensInactive,this._isDocumentSettingsPanelCollapsed,t]).pipe(S.T(Me.Si(o.identity)))}constructor(e,t,i,s){(0,n._)(this,"_navigationVM",void 0),(0,n._)(this,"_documentSettingsState",void 0),(0,n._)(this,"_cheetahAvailability",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_isCheetahAvailable",void 0),(0,n._)(this,"_isInlineFeatureAvailable",void 0),(0,n._)(this,"_isCheetahLensInactive",void 0),(0,n._)(this,"_isDocumentSettingsPanelCollapsed",void 0),this._navigationVM=e,this._documentSettingsState=t,this._cheetahAvailability=i,this._features=s,this._isCheetahAvailable=this._cheetahAvailability.pipe(S.T((0,o.not)(at.y.isUnavailable))),this._isInlineFeatureAvailable=ke.of(this._features.cheetahInlineRewrite||this._features.cheetahMagicRewrite),this._isCheetahLensInactive=this._navigationVM.activeLensId.view((e=>e!==u.J.SpecialId.Cheetah)),this._isDocumentSettingsPanelCollapsed=this._documentSettingsState.pipe(S.T((e=>e.type===ot.VV.Collapsed)))}}class dt{isAvailable(){return this._resolveObs}constructor(e){(0,n._)(this,"_resolveObs",void 0),this._resolveObs=e}}var ht=i(68975),pt=i(9619),ut=i(97985),mt=i(28986),gt=i(9198),_t=i(69619);class ft{get selectedRange(){const e=this._ded.getCursor();return{start:e.index,end:e.length+e.index}}replaceCurrentSelectionWith(e){return this.insertContent(e,{onNewLine:!1,replace:!0,preserveSelection:!1})}insertContent(e,t){return(0,l.pipe)(ee.L9(this._ded.flushChanges),ee.g$((0,l.pipe)(ee.L9((()=>{const{start:e,end:i}=this.selectedRange;return{start:e,deleteDelta:t.replace&&i>e?(new mt.R).delete(i-e):new mt.R}})),ee.Tj(Boolean(t.onNewLine)?vt:yt),ee.ap(this._getContents))),ee.W6((0,o.flow)((t=>(new mt.R).retain(t.start).concat(e).concat(t.deleteDelta)),this._pushChanges,ee.oF)),ee.cy((({start:i})=>()=>new Promise((s=>requestAnimationFrame((()=>s(this._ded.setCursor(i,Boolean(t.preserveSelection)?e.length():0)))))))))}constructor(e){(0,n._)(this,"_ded",void 0),(0,n._)(this,"_pushChanges",void 0),(0,n._)(this,"_getContents",void 0),this._ded=e,this._pushChanges=e=>ut.TX((()=>this._ded.pushChanges(gt.lY.delta(e,this._ded.getTextLength()),"user")),Z.toError),this._getContents=(0,l.pipe)(ut.TX(this._ded.getContents,Z.toError),ee.oF)}}function yt(e){return()=>e}function vt(e){const t=e.start,i=e=>_t.E.isInsertString(e)&&e.insert.includes("\n"),s=_t.E.findInDelta(i,(e=>e.insert.indexOf("\n")));return n=>(0,l.pipe)(n,(({delta:e})=>e.slice(t)),s,J.getOrElse((()=>n.delta.length())),((e,s)=>n=>{const r=s.delta;let a=1;if(0===t)1===r.length()&&(a=0);else if(t>0&&i(r.slice(t-1,t).ops[0])){const e=r.slice(t,t+1).ops[0];Boolean(e)?i(e)&&(a=0):a=0}return e+n+a})(t,n),(t=>(0,a._)((0,r._)({},e),{start:t})))}var bt=i(23121);class St{constructor(e,t,i){(0,n._)(this,"_ded",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_inlineManager",void 0),(0,n._)(this,"inlineButtonState",void 0),(0,n._)(this,"magicRewriteEnabled",void 0),(0,n._)(this,"inlineRewriteEnabled",void 0),(0,n._)(this,"showOnboardingTourA11yUpdates",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_inlineButtonState",void 0),(0,n._)(this,"dispose",void 0),this._ded=e,this._features=t,this._inlineManager=i,this.inlineButtonState=c.s.create(J.none),this._subs=new f.y.Keeper,this._inlineButtonState=C.zV([this._ded.viewport,this._ded.scrollPosition,this._inlineManager.cheetahInlineButtonState]).pipe(S.T((([e,t,i])=>(0,l.pipe)(i,J.fold((()=>J.none),(()=>{const{text:{left:i}}=e;return(0,l.pipe)(this._ded.getSelectionRect(),bt.qI((e=>e.getRect())),Z.map((e=>e.clientRects)),J.fromEither,J.filter(Me.J_),J.map((e=>{const s=e[e.length-1],n=e.length>1;return{top:s.bottom+t,left:n?i:s.left}})))})))))),this.dispose=()=>{this._subs.dispose()};const s=this._features.oggy===re.kH.splitSharedAssistants;this.magicRewriteEnabled=s&&this._features.cheetahMagicRewrite,this.inlineRewriteEnabled=s&&this._features.cheetahInlineRewrite,this.showOnboardingTourA11yUpdates=this._features.showOnboardingTourA11yUpdates,this._subs.push(this._inlineButtonState.subscribe((e=>this.inlineButtonState.set(e))))}}var kt=i(31784),Ct=i(55250),wt=i(49025),Et=i(23402),xt=i(40005),Mt=i(70823);class Tt{constructor(e,t,i,s,l,d,h,p,u,m,g,v,b,k,E,x,M,T,A,B,P){switch((0,n._)(this,"_oggyManager",void 0),(0,n._)(this,"_lifecycleService",void 0),(0,n._)(this,"_lifecycleEvents",void 0),(0,n._)(this,"_textEditorService",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"_navigation",void 0),(0,n._)(this,"_userService",void 0),(0,n._)(this,"_capiService",void 0),(0,n._)(this,"_availabilityService",void 0),(0,n._)(this,"_uphookService",void 0),(0,n._)(this,"_deepLinkService",void 0),(0,n._)(this,"_feedbackService",void 0),(0,n._)(this,"_onboardingViewModelsFactory",void 0),(0,n._)(this,"_experimentService",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_sessionModel",void 0),(0,n._)(this,"_modalManager",void 0),(0,n._)(this,"_selectionRange",void 0),(0,n._)(this,"_usedDuringSession",void 0),(0,n._)(this,"_selectionContextAvailabilityService",void 0),(0,n._)(this,"assistantUI",void 0),(0,n._)(this,"ggoUI",void 0),(0,n._)(this,"onboardingViewModels",void 0),(0,n._)(this,"usedDuringSession",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_assistantUIActions",void 0),(0,n._)(this,"_selectionOnLensEnter",void 0),(0,n._)(this,"_onboardingUIActions",void 0),(0,n._)(this,"_isInSplitMode",void 0),(0,n._)(this,"_genAISession",void 0),(0,n._)(this,"_commonAssistantDependencies",void 0),(0,n._)(this,"_disposed",void 0),(0,n._)(this,"dispose",void 0),(0,n._)(this,"_initUI",void 0),(0,n._)(this,"_initOnboarding",void 0),(0,n._)(this,"_manageGgo",void 0),(0,n._)(this,"_manageAssistant",void 0),(0,n._)(this,"_disposeAssistant",void 0),(0,n._)(this,"_disposeGgo",void 0),(0,n._)(this,"_getRevisionAssistantDependencies",void 0),(0,n._)(this,"_getGenAIAssistantDependencies",void 0),(0,n._)(this,"_getGenAIAndRevisionAssistantDependencies",void 0),(0,n._)(this,"_createAssistant",void 0),(0,n._)(this,"_createGgo",void 0),this._oggyManager=e,this._lifecycleService=t,this._lifecycleEvents=i,this._textEditorService=s,this._ded=l,this._navigation=d,this._userService=h,this._capiService=p,this._availabilityService=u,this._uphookService=m,this._deepLinkService=g,this._feedbackService=v,this._onboardingViewModelsFactory=b,this._experimentService=k,this._telemetry=E,this._features=x,this._sessionModel=M,this._modalManager=T,this._selectionRange=A,this._usedDuringSession=B,this._selectionContextAvailabilityService=P,this.assistantUI=c.s.create(J.none),this.ggoUI=c.s.create(J.none),this.onboardingViewModels=c.s.create(J.none),this.usedDuringSession=this._usedDuringSession.view(),this._log=se.Bx.Logging.getLogger("Cheetah.CheetahWebLifecycleManagerImpl"),this._subs=new f.y.Keeper,this._assistantUIActions=new _.B7,this._selectionOnLensEnter=this._navigation.isGGOLensActive.pipe(w.p(Boolean),D.E(this._ded.selection),S.T(kt.gp)),this._onboardingUIActions=new _.B7,this._isInSplitMode=this._features.oggy===re.kH.splitSharedAssistants,this._genAISession=c.s.create(J.none),this._disposed=new _.B7,this.dispose=()=>{this._disposed.next(!0),this._disposeAssistant(),this._disposeGgo(),this._subs.dispose()},this._initUI=({kind:e,oggyManager:t,lifecycleService:i})=>{performance.mark(Ct.F.assistantOpenAttempt);const s={mode:this._navigation.mode.get(),metadata:(0,o.pipe)(this._features.cheetahPromptsUsed,J.map((e=>({setPromptsUsed:e}))),J.toUndefined)};switch(this._log.info(`Init UI for ${e}`),e){case"oggy":const n=(0,o.pipe)(s,this._createAssistant(i,t));this.assistantUI.set(J.some(n)),this._log.info("Inited Oggy Assistant UI",n);break;case"ggo":const r=this._createGgo(i)(s);this.ggoUI.set(J.some(r)),this._log.info("Inited GGO Assistant UI",r);break;case"ggoWithRevision":const a=this._createGgo(i,t)(s);this.ggoUI.set(J.some(a)),this._log.info("Inited GGO with Revision Assistant UI",a);break;default:(0,X.xb)(e)}},this._initOnboarding=()=>{const e=this._sessionModel.defaultContext.pipe(S.T(J.chain((e=>e.writingIntent)))),t=this._availabilityService.availability.pipe(w.p(at.y.isVisible),me.s(1)),i=this._modalManager.state.view(J.exists((e=>e.instance.type===qe.zz.Tour)));!this._sessionModel.isDemoDocument&&this._features.cheetahOnboarding&&C.zV([t,e,i]).pipe(w.p((([e,t,i])=>at.y.isVisible(e)&&!i))).subscribe((([e,t])=>{const i=this._onboardingViewModelsFactory({intent:t,disposed:this._disposed,assistantUIActions:this._assistantUIActions,onboardingUIActions:this._onboardingUIActions,cheetahButton:this._navigation.cheetahButton,genAiSession:this._genAISession});this._subs.push((0,o.pipe)(i.onboarding.uiActions,w.p(wt.K.is(wt.K.Kind.tryItOut)),R.M((()=>this._navigation.toCheetahLens(!1,!1)))).subscribe()),this._subs.push(i.onboarding),this.onboardingViewModels.set(J.some(i))}))},this._manageGgo=()=>this._subs.push(C.zV([this._navigation.isGGOLensActive.pipe(I.J()),this._lifecycleService]).pipe(R.M((([[e,t],i])=>{!1===e&&!0===t?this._initUI({kind:"ggo",lifecycleService:i}):!0===e&&!1===t&&this._disposeGgo()}))).subscribe()),this._manageAssistant=e=>{this._subs.push(C.zV([this._navigation.isSidebarOpened,this._lifecycleService]).pipe(R.M((([t,i])=>t?this._initUI({kind:"oggy",oggyManager:e,lifecycleService:i}):this._disposeAssistant()))).subscribe())},this._disposeAssistant=()=>{this._log.info("Disposing Assistant..."),this.assistantUI.set(J.none)},this._disposeGgo=()=>{this._log.info("Disposing GGO..."),this.ggoUI.set(J.none)},this._getRevisionAssistantDependencies=(e,t)=>{return i=(0,a._)((0,r._)({},this._commonAssistantDependencies(e)),{alertService:t.alertService,sduiService:t.sduiService}),()=>(0,a._)((0,r._)({kind:"revision"},i),{isPlagiarismEnabled:!0,isWritingExpertEnabled:i.features.writingExpertPullMode,trackingService:(0,Mt.H4)(i.telemetry,i.features),toneDetectorService:void 0});var i},this._getGenAIAssistantDependencies=({kind:e,oggyManager:t,lifecycleService:i})=>{return"withOggy"===e?(s=(0,a._)((0,r._)({},this._commonAssistantDependencies(i)),{genAIAvailabilityService:this._availabilityService,selectionContextAvailabilityService:this._selectionContextAvailabilityService,lifecycleService:(0,a._)((0,r._)({},i),{sizeBehavior:xt.w.fitContent(document.documentElement)}),notifyGenAISessionStateChanged:e=>this._genAISession.set(e),alertService:t.alertService,sduiService:t.sduiService}),e=>(0,a._)((0,r._)({kind:"genAIAndWritingExpert"},s),{genAIStartSessionOptions:e,isPlagiarismEnabled:!0,isWritingExpertEnabled:s.features.writingExpertPullMode,trackingService:(0,Mt.H4)(s.telemetry,s.features)})):"withoutOggy"===e?(e=>t=>(0,a._)((0,r._)({kind:"genAI"},e),{genAIStartSessionOptions:t,trackingService:(0,Mt.H4)(e.telemetry,e.features)}))((0,a._)((0,r._)({},this._commonAssistantDependencies(i)),{genAIAvailabilityService:this._availabilityService,selectionContextAvailabilityService:this._selectionContextAvailabilityService,lifecycleService:(0,a._)((0,r._)({},i),{sizeBehavior:xt.w.fitContent(document.documentElement)}),notifyGenAISessionStateChanged:e=>this._genAISession.set(e)})):(0,X.xb)(e);var s},this._getGenAIAndRevisionAssistantDependencies=(e,t)=>{return i=(0,a._)((0,r._)({},this._commonAssistantDependencies(e)),{alertService:t.alertService,sduiService:t.sduiService,genAIAvailabilityService:this._availabilityService,selectionContextAvailabilityService:this._selectionContextAvailabilityService,notifyGenAISessionStateChanged:e=>this._genAISession.set(e)}),e=>(0,a._)((0,r._)({kind:"genAIAndRevision"},i),{genAIStartSessionOptions:e,isPlagiarismEnabled:!0,isWritingExpertEnabled:i.features.writingExpertPullMode,trackingService:(0,Mt.H4)(i.telemetry,i.features)});var i},this._createAssistant=(e,t)=>(0,o.flow)(this._isInSplitMode?this._getRevisionAssistantDependencies(e,t):this._getGenAIAndRevisionAssistantDependencies(e,t),Et.v),this._createGgo=(e,t)=>(0,o.flow)(this._getGenAIAssistantDependencies(void 0===t?{kind:"withoutOggy",lifecycleService:e}:{kind:"withOggy",oggyManager:t,lifecycleService:e}),Et.v),this._commonAssistantDependencies=e=>({lifecycleService:e,userService:this._userService,capiService:this._capiService,textEditorService:this._textEditorService,uphookService:this._uphookService,deepLinkService:this._deepLinkService,feedbackService:this._feedbackService,experimentService:this._experimentService,telemetry:this._telemetry,notifyAssistantUIAction:e=>this._assistantUIActions.next(e),features:this._features,theme:c.s.create({useIframeTextfieldWrapper:!0})}),this._subs.push(this._lifecycleEvents.events.pipe(w.p(_e.f.isClose),R.M((()=>this._navigation.closeCheetahLens()))).subscribe()),this._isInSplitMode?this._subs.push(this._ded.dontFreezeWhen(this._navigation.isGGOLensActive,"cheetah-lens")):this._subs.push(this._assistantUIActions.pipe(w.p((e=>"promptFieldFocusChange"===e.kind&&e.focused)),me.s(1),R.M((()=>this._ded.restoreFocus("promptFieldFocusChange")))).subscribe()),this._subs.push(this._selectionOnLensEnter.pipe(y._F.inRaf).subscribe((e=>this._ded.setCursor(e.index,e.length,"api"))),this._ded.selection.subscribe((e=>{this._selectionRange.set(J.some({start:e.index,end:e.index+e.length,meta:void 0}))}))),this._features.oggy){case re.kH.splitSharedAssistants:this._manageAssistant(this._oggyManager),this._manageGgo();break;case re.kH.mergedSharedAssistant:this._manageAssistant(this._oggyManager);break;default:(0,X.xb)(this._features.oggy)}this._initOnboarding()}}class At{constructor(e,t){(0,n._)(this,"_navigationVM",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"cheetahButton",void 0),(0,n._)(this,"isGGOLensActive",void 0),(0,n._)(this,"isSidebarOpened",void 0),(0,n._)(this,"mode",void 0),(0,n._)(this,"toCheetahLens",void 0),(0,n._)(this,"closeCheetahLens",void 0),(0,n._)(this,"handleCheetahButtonClick",void 0),(0,n._)(this,"cheetahButtonRef",void 0),this._navigationVM=e,this._ded=t,this._log=se.Bx.Logging.getLogger("Cheetah.Navigation"),this.cheetahButton=c.s.create(null),this.isGGOLensActive=this._navigationVM.activeLensId.view((e=>e===u.J.SpecialId.Cheetah)),this.isSidebarOpened=this._navigationVM.state.view("isSidebarOpen"),this.mode=c.s.create("rewrite"),this.toCheetahLens=(e=!1,t=!1)=>{this._log.info("Opening lens...",{fromInline:e,withQuickRewrite:t});const i=0===this._ded.selection.getValue().length?"ideation":t?"quickRewrite":"rewrite";this.mode.set(i),this._navigationVM.events.next({type:"switchToLens",id:u.J.SpecialId.Cheetah,focusFirst:!1,actionSource:e?p.Kz.text:p.Kz.sidebar})},this.closeCheetahLens=()=>{this._log.info("Closing lens..."),this._navigationVM.events.next({type:"switchToLens",id:u.J.SpecialId.AllAlerts,focusFirst:!1,actionSource:p.Kz.api})},this.handleCheetahButtonClick=()=>{!0===this.isGGOLensActive.get()?this.closeCheetahLens():this.toCheetahLens()},this.cheetahButtonRef=e=>{this.cheetahButton.set(e)}}}var It,Bt=i(53973),Pt=i(40817),Ft=i(37730),Nt=i(54463),Rt=i(22835),Lt=i(74168),Dt=i(36735);function Ot(e=500){return x.h(Lt.L5.pipe(Dt.c(e/2),H.u(!0)),Lt.L5.pipe(be.B(e),H.u(!1))).pipe(A.F())}!function(e){e.create=({engine:e,denaliEditorModel:t,upgradeVM:i,navigationVM:s,userAccount:n,dialect:r,telemetry:a,inlineManager:l,modalManager:d,experimentClient:h,environment:p,platformEnvironment:u,notificationsManager:m,config:g})=>{const _=se.Bx.Logging.getLogger("Cheetah.CheetahViewModel");_.info("Creating CheetahViewModel");const y=new f.y.Keeper,b=c.s.create(J.none),k=(0,Mt.F2)(n,r),C=n.features.denali.showOnboardingTourA11yUpdates,E=(0,Mt.Nc)(a),x=c.s.create({contextUpdatesClient:n.features.denali.selectionContextUpdatesClient,contextUpdatesServer:n.features.denali.selectionContextUpdatesServer}),M=new ht.w(x),T=new At(s,t),A=new ft(t),I=c.s.create(!1),B=(0,Mt.n$)(t,A,e.cheetah.selectionContextManager,(()=>{I.set(!0)}),b,(0,ze.l)(m,p)),P=(0,Mt.Ip)(a,u,g,i),F=new Tt(e.cheetah.oggyManager,e.cheetah.oggyLifecycleService,e.cheetah.oggyLifecycleEvents,B,t,T,k,e.cheetah.cheetahCapiService,e.cheetah.genAiAvailabilityService,P,e.cheetah.oggyDeepLinkService,E,(N={capi:e.obsCapiClient,settings:n.settings,availabilityService:e.cheetah.genAiAvailabilityService,features:n.features.denali,capiService:e.cheetah.cheetahCapiService},e=>{const t=new Set;return N.features.cheetahOrgContextEnabled||t.add(Bt.M.StepName.knowledgeHub),N.features.cheetahBTSOnboardingEnabled&&te.gR("ASSIGNMENT_WRITING")(e.intent)||t.add(Bt.M.StepName.initialBTS),(0,Pt.K)({client:"editor",textStats:N.capi.events.pipe(w.p(Nt.o.is("text_info")),S.T((e=>J.some({wordCount:e.data.wordsCount}))),v.Z(J.none)),capiService:N.capiService,upstreamOnboardingState:N.settings.cheetahOnboardingState,completeOnboardingStep:e=>{N.settings.cheetahOnboardingState.get()[e].editor.completed||N.settings.updateCheetahOnboardingState({[e]:{completed:!0,lastSeen:Date.now()}})},session:e.genAiSession,assistantUIActions:e.assistantUIActions,forceDisabledOnboardingSteps:t,externalElements:e.cheetahButton.pipe(S.T((e=>(0,o.pipe)(e,J.fromNullable,J.fold((()=>({})),(e=>({[Ft.Z.initialPopupAnchor]:{reference:e,placement:"left",offset:8,boundaryAreaPadding:10},[Ft.Z.initialBTSPopupAnchor]:{reference:e,placement:"left",offset:8,boundaryAreaPadding:10}}))))))),disposed:e.disposed,promptsAllocated:N.availabilityService.availability.view((0,o.flow)(J.fromPredicate(at.y.isActiveOrPassive),J.map(Rt.Up("promptsAllocated")))),hideAssistantOnboardingTooltips:Ot()})}),(0,Mt.xs)(h),a,n.features.denali,e.sessionModel,d,b,I,M);var N;const R=new St(t,n.features.denali,l);return{assistantUI:F.assistantUI,ggoUI:F.ggoUI,onboardingViewModels:F.onboardingViewModels,inlineViewModel:R,usedDuringSession:F.usedDuringSession,navigation:T,isInOnboardingTourA11yExperiment:C,oggyMode:n.features.denali.oggy,isGenAiAvailable:e.cheetah.genAiAvailabilityService.availability.view(at.y.isVisible),dispose:()=>{_.info("Disposing CheetahViewModel"),F.dispose(),R.dispose(),y.dispose()},acquireFocusWhen:e=>t.dontFreezeWhen(e,"Cheetah View")}},e.mock=()=>({assistantUI:ke.of(J.none),ggoUI:ke.of(J.none),onboardingViewModels:c.s.create(J.none),inlineViewModel:{inlineButtonState:c.s.create(J.none),magicRewriteEnabled:!1,inlineRewriteEnabled:!1,showOnboardingTourA11yUpdates:!1,dispose:o.constVoid},navigation:{cheetahButton:c.s.create(null),isGGOLensActive:c.s.create(!1),isSidebarOpened:c.s.create(!1),mode:c.s.create("rewrite"),toCheetahLens:o.constVoid,closeCheetahLens:o.constVoid,handleCheetahButtonClick:o.constVoid,cheetahButtonRef:o.constVoid},usedDuringSession:c.s.create(!1),isInOnboardingTourA11yExperiment:!1,oggyMode:re.kH.splitSharedAssistants,isGenAiAvailable:c.s.create(!1),acquireFocusWhen:()=>pt.y.EMPTY,dispose:o.constVoid})}(It||(It={}));var Ht=i(88105);class Kt{get uploadInputAccept(){return this._environment.has(je.OH.Flag.acceptUploadByMimeTypes)?ne.jj.Pm.join(","):ne.jj.$G.join(",")}upload(e){this._uploadViewModel.uploadModel.upload({files:e,notify:!1,allowMultiple:!1,isDragNDrop:!1})}constructor(e,t,i,s){(0,n._)(this,"_uploadViewModel",void 0),(0,n._)(this,"_denaliEditorModel",void 0),(0,n._)(this,"_userAccount",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"visible",void 0),(0,n._)(this,"size",void 0),this._uploadViewModel=e,this._denaliEditorModel=t,this._userAccount=i,this._environment=s,this.visible=this._denaliEditorModel.contentUpdated.pipe(v.Z(void 0),S.T((()=>!$t(this._denaliEditorModel))),A.F()),this.size=this._userAccount.settings.editorPreferences.view("fontSize")}}const $t=e=>e.getTextLength()>1||(()=>{const t=e.getContents().delta.ops[0];return Boolean(t)&&J.isSome(Ht.E.getAttrs(t))})();var Vt,Ut=i(36465),Gt=i(3346);class Qt{downloadOriginal(){this._subs.push(Ce.H(this._documentModel.downloadOriginal(this._documentModel.rtfMode===ne.jj.l1.FormattingMode.on?J.some("docx"):J.none)).pipe(Gt.W(this._handleDownloadError)).subscribe())}downloadProofread(){this._subs.push(Ce.H(this._documentModel.downloadProofread()).pipe(Gt.W(this._handleDownloadError)).subscribe())}dispose(){this._subs.dispose()}constructor(e,t){(0,n._)(this,"_documentModel",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_handleDownloadError",void 0),this._documentModel=e,this._notificationsManager=t,this._subs=new f.y.Keeper,this._log=se.Bx.Logging.getLogger("downloadViewModel"),this._handleDownloadError=e=>(this._log.error("downloadDocument failed",e),e instanceof Ut.h.UnauthorizedError?this._notificationsManager.enqueue("unauthorizedError"):e instanceof Ut.h.DocumentNotFoundError?this._notificationsManager.enqueue("downloadDocumentNotFoundError"):e instanceof Ut.h.TooManyRequestsError||e instanceof Ut.h.ConnectionError?this._notificationsManager.enqueue("isTemporaryDownloadError"):this._notificationsManager.enqueue("error"))}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"dispose",Y.Yi),(0,n._)(this,"downloadOriginal",Y.Yi),(0,n._)(this,"downloadProofread",Y.Yi)}}}(Vt||(Vt={}));var Wt,qt=i(72404);class zt{constructor(e,t){(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_sendFeedback",void 0),(0,n._)(this,"currentText",void 0),(0,n._)(this,"modalShown",void 0),(0,n._)(this,"sendFeedback",void 0),this._notificationsManager=e,this._sendFeedback=t,this.currentText=c.s.create({brief:"",detailed:""}),this.modalShown=new _.B7,this.sendFeedback=()=>this.currentText.pipe(we.$(),pe.n(this._sendFeedback),pe.n((()=>this._notificationsManager.enqueue("feedbackSend").pipe(w.p((e=>"shown"===e)),R.M((()=>this.currentText.set({brief:"",detailed:""}))),F.Q(this.modalShown)))),Gt.W((()=>this._notificationsManager.enqueue("error")))).toPromise()}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"modalShown",new _.B7),(0,n._)(this,"currentText",c.s.create({brief:"",detailed:""})),(0,n._)(this,"sendFeedback",(()=>new Promise(Y.Yi)))}}}(Wt||(Wt={}));class jt{dispose(){this._subs.dispose()}constructor(e,t,i,s){(0,n._)(this,"_config",void 0),(0,n._)(this,"_obsCapiClient",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_subs",void 0),this._config=e,this._obsCapiClient=t,this._notificationsManager=i,this._telemetry=s,this._subs=new f.y.Keeper,this._subs.push(this._obsCapiClient.events.pipe(w.p(Nt.o.is("gb_rule_created")),R.M((({categoryTitle:e,descriptionLength:t})=>{"Vox"===e?this._telemetry.gnarSpec.gbPromptCreateVoxRuleSubmit(t,this._telemetry.pageId):this._telemetry.gnarSpec.gbPromptLockWritingStyleSettingSubmit(this._telemetry.pageId)})),pe.n((({categoryTitle:e,styleGuideId:t})=>this._notificationsManager.enqueue("gbRuleCreated",{link:"Vox"===e?`${this._config.account.styleGuide}/${t}`:`${this._config.account.writingStyle}?categoryTitle=${e}`})))).subscribe())}}var Jt,Yt=i(55638),Zt=i(80548),Xt=i(69082),ei=i(11298),ti=i(30396),ii=i(18515),si=i(1404),ni=i(80019);function ri(e){const[t,i]=ii.j(e.pipe(ei.u()),J.isSome);return[t.pipe(S.T(te.$v)),i.pipe(H.u(y.q6))]}!function(e){let t,i;!function(e){e.idle="idle",e.inlineCard="inline-card",e.synonymsCard="synonyms-card",e.formattingLink="formatting-link",e.upgradeHook="upgrade-hook",e.cheetahInlineButton="cheetah-inline-button",e.vbarCard="vbar-card",e.teaserCard="teaser-card"}(t=e.Type||(e.Type={})),e.idle={type:Jt.Type.idle},function(e){e.monoid=Xt.getStructMonoid({[Jt.Type.idle]:Me.JI(),[Jt.Type.formattingLink]:Me.JI(),[Jt.Type.upgradeHook]:Me.JI(),[Jt.Type.synonymsCard]:Me.JI(),[Jt.Type.inlineCard]:Me.JI(),[Jt.Type.cheetahInlineButton]:Me.JI(),[Jt.Type.vbarCard]:Me.JI(),[Jt.Type.teaserCard]:Me.JI()}),e.forCardState=function(e,t,i){const s=ri(e.alertHovered.pipe(w.p(te.Lw((0,o.not)(ce.A.isWritingExpertWithTeaser))),S.T(J.filter((e=>t.isInteractable(e.id)&&ce.A.isHoverableInline(e)))))),n=s[0].pipe(S.T(((e,t)=>()=>[`fromDed:markAlertHover:set(${t})`,{type:Jt.Type.inlineCard,alert:e}]))),r=s[1].pipe(S.T(ai(Jt.Type.inlineCard,"Ded"))),a=i.pipe(S.T(ai(Jt.Type.inlineCard,"Ext")));return{[Jt.Type.idle]:[n],[Jt.Type.formattingLink]:[],[Jt.Type.upgradeHook]:[],[Jt.Type.synonymsCard]:[],[Jt.Type.inlineCard]:[n,r,a],[Jt.Type.cheetahInlineButton]:[],[Jt.Type.vbarCard]:[],[Jt.Type.teaserCard]:[]}},e.forSynonymsState=function(e,t){const i=e.doubleClickedWord.pipe(S.T(((e,t)=>()=>[`fromDed:synonyms:set(${t})`,{type:Jt.Type.synonymsCard,word:e}]))),s=t.pipe(S.T(ai(Jt.Type.synonymsCard,"Ext")));return{[Jt.Type.idle]:[i],[Jt.Type.formattingLink]:[i],[Jt.Type.upgradeHook]:[i],[Jt.Type.synonymsCard]:[i,s],[Jt.Type.inlineCard]:[i],[Jt.Type.cheetahInlineButton]:[i],[Jt.Type.vbarCard]:[i],[Jt.Type.teaserCard]:[]}},e.forFormattingLink=function(e,t,i){const s=t.pipe(S.T(((e,t)=>()=>[`fromUI:links:set(${t})`,{type:Jt.Type.formattingLink,link:e}]))),n=ri(ni.uY.fromDenaliEditor(e.selectedFormatting)),r=n[0].pipe(S.T(((e,t)=>()=>[`fromDed:links:set(${t})`,{type:Jt.Type.formattingLink,link:e}]))),a=n[1].pipe(S.T(ai(Jt.Type.formattingLink,"Ded"))),o=i.pipe(S.T(ai(Jt.Type.formattingLink,"Ext")));return{[Jt.Type.idle]:[s,r],[Jt.Type.formattingLink]:[s,r,a,o],[Jt.Type.upgradeHook]:[s,r,a,o],[Jt.Type.synonymsCard]:[s],[Jt.Type.inlineCard]:[s],[Jt.Type.cheetahInlineButton]:[s],[Jt.Type.vbarCard]:[s],[Jt.Type.teaserCard]:[s]}},e.forUpgradeHook=function(e,t,i){const[s,n]=ri(e.alertClicked.pipe(S.T(J.filter((({alert:e})=>t.isRegistered(e.id)&&p.Fc.isInPremiumLens(e)&&!ce.A.isLockedUIAlert(e)))))),r=s.pipe(S.T(((e,t)=>()=>[`fromDed:markAlertClick:set(${t})`,{type:Jt.Type.upgradeHook,alert:e}]))),a=n.pipe(S.T(ai(Jt.Type.upgradeHook,"Ded"))),o=i.pipe(S.T(ai(Jt.Type.upgradeHook,"Ext")));return{[Jt.Type.idle]:[r],[Jt.Type.formattingLink]:[r],[Jt.Type.upgradeHook]:[r,a,o],[Jt.Type.synonymsCard]:[r],[Jt.Type.inlineCard]:[r],[Jt.Type.cheetahInlineButton]:[r],[Jt.Type.vbarCard]:[r],[Jt.Type.teaserCard]:[r]}},e.forCheetahInlineButton=function(e,t,i){const s=e.selection.pipe(A.F(d.LN.eqRange.equals),S.T((t=>e.getText().slice(t.index,t.index+t.length)))),n=t.isAvailable(s).pipe(S.T((0,Y.Sw)(J.some((0,Y.Yi)()),J.none))),[r,a]=ri(n),o=r.pipe(S.T(((e,t)=>()=>[`fromDed:cheetah:set(${t})`,{type:Jt.Type.cheetahInlineButton}]))),l=a.pipe(S.T(ai(Jt.Type.cheetahInlineButton,"Ded"))),c=i.pipe(S.T(ai(Jt.Type.cheetahInlineButton,"Ext")));return{[Jt.Type.idle]:[o],[Jt.Type.formattingLink]:[],[Jt.Type.upgradeHook]:[],[Jt.Type.synonymsCard]:[],[Jt.Type.inlineCard]:[],[Jt.Type.cheetahInlineButton]:[o,l,c],[Jt.Type.vbarCard]:[],[Jt.Type.teaserCard]:[]}},e.forVbarCard=function(e){const[t,i]=ri(e),s=t.pipe(S.T(((e,t)=>()=>[`fromDed:activeVbar:set(${t})`,{type:Jt.Type.vbarCard,vbar:J.some(e)}]))),n=i.pipe(S.T(ai(Jt.Type.vbarCard,"Ded")));return{[Jt.Type.idle]:[s],[Jt.Type.formattingLink]:[],[Jt.Type.upgradeHook]:[],[Jt.Type.synonymsCard]:[],[Jt.Type.inlineCard]:[],[Jt.Type.cheetahInlineButton]:[],[Jt.Type.vbarCard]:[s,n],[Jt.Type.teaserCard]:[]}},e.forTeaserCard=function(e,t,i,s){const[n,r]=ri(e.alertHovered.pipe(S.T(J.filter((e=>t.isInteractable(e.id)&&ce.A.isHoverableInline(e)&&ce.A.isWritingExpertWithTeaser(e)))))),a=s.pipe(S.T(J.chain((e=>(0,o.pipe)(t.getById(e),J.map(ce.A.fromModel))))),P.skipBy(J.getEq(ce.A.eq)),ei.u()),l=x.h(n,a.pipe(O.oE)).pipe(S.T(((e,t)=>()=>[`fromDed:teaserCardHover:set(${t})`,{type:Jt.Type.teaserCard,alert:e}]))),c=C.zV(a,r).pipe(w.p((([e])=>J.isNone(e))),S.T(ai(Jt.Type.teaserCard,"Ded"))),d=i.pipe(S.T(ai(Jt.Type.teaserCard,"Ext")));return{[Jt.Type.idle]:[l],[Jt.Type.formattingLink]:[],[Jt.Type.upgradeHook]:[],[Jt.Type.synonymsCard]:[],[Jt.Type.inlineCard]:[],[Jt.Type.cheetahInlineButton]:[],[Jt.Type.vbarCard]:[],[Jt.Type.teaserCard]:[c,d]}}}(i=e.Scheme||(e.Scheme={}))}(Jt||(Jt={}));const ai=(e,t)=>(i,s)=>i=>i.type===e?[`from${t}:${e}:reset(${s})`,Jt.idle]:[`from${t}:${e}:skipReset(${s})`,i];var oi=i(74416),li=i(45560);class ci{constructor(e,t){(0,n._)(this,"_lensesList",void 0),(0,n._)(this,"_alertsFilterService",void 0),(0,n._)(this,"getLens",void 0),(0,n._)(this,"_getPlagiarismLens",void 0),this._lensesList=e,this._alertsFilterService=t,this.getLens=(0,Y.Bj)((function(e){switch(e){case u.J.SpecialId.Plagiarism:return this._lensesList.view(this._getPlagiarismLens);case u.J.SpecialId.Premium:return this._lensesList.view(di(u.J.Info.premium,u.J.Meta.group.empty,this._alertsFilterService.getLensesFilter(u.J.SpecialId.Premium)));default:return(0,X.xb)(e)}})),this._getPlagiarismLens=(0,o.flow)(di(u.J.Info.plagiarism,(0,a._)((0,r._)({},u.J.Meta.group.empty),{percentile:oi.w.MAX}),this._alertsFilterService.getLensesFilter(u.J.SpecialId.Plagiarism)),u.J.WithAlerts.modifyMeta((e=>(0,a._)((0,r._)({},e),{percentile:oi.w.groupSum.concat(oi.w.MAX,oi.w.groupSum.inverse(e.percentile))}))))}}function di(e,t,i){return s=>{return new u.J.LensImpl(e,(n=e.id,r=t,e=>(0,l.pipe)(li.$I(u.J.Id.ord)(n,e),J.getOrElse((()=>r))))(s),i);var n,r}}var hi=i(93959),pi=i(63849),ui=i(91796);const mi=se.Bx.Logging.getLogger("pageTelemetry");class gi{dispose(){this._subs.dispose()}trackSidebarState(e){return e.pipe(k.i(1),pe.n((e=>e?Ce.H(this._telemetry.gnarSpec.assistantSidebarShow(this._telemetry.pageId)):Ce.H(this._telemetry.gnarSpec.assistantSidebarClose(this._telemetry.pageId)))))}constructor(e,t){(0,n._)(this,"_isSidebarOpened",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_subs",void 0),this._isSidebarOpened=e,this._telemetry=t,this._subs=new f.y.Keeper,this._subs.push(x.h(this.trackSidebarState(this._isSidebarOpened)).pipe(Gt.W((e=>(mi.warn("Page telemetry error",e),E.w)))).subscribe())}}var _i=i(54872),fi=i(45032),yi=i(33373),vi=i(57797),bi=i(66799),Si=i(22809),ki=i(27004);class Ci{applyAlert(e){setTimeout((()=>this.onVbarClose()),0),(0,o.pipe)(this._alertsService.apply(e,{alternativeIndex:0,source:p.Kz.text,feedbackSubtype:bi.U3.Inline}),Z.fold((e=>this._log.error("error applying alert",e)),o.constVoid))}dismissAlert(e){setTimeout((()=>this.onVbarClose()),0),(0,o.pipe)(this._alertsService.dismissBatch([e],bi.U3.Inline),Z.fold((e=>this._log.error("error dismissing alert",e)),o.constVoid))}toggleVbarHighlighting(e,t){const i=this.items.get().find((t=>t.alert.id===e));t?i&&this.highlightedVbarAlert.next(J.some(i.alert)):this.highlightedVbarAlert.next(J.none)}onVbarClick(e){var t;this._sendFeedback(e,{kind:bi.yp.ACCEPTED,subtype:bi.U3.Vbar,alternativeIndex:0}),this._isAssistantMode.get()?((0,o.pipe)(this.items.get(),Me.i8((t=>t.alert.id===e)),J.fold((()=>this._log.error("Vbar item not found on click in assistant mode")),(e=>this.alertClickedInAssistantMode.next(J.some({highlightIndex:0,alert:e.alert}))))),this._inlineManager.changeActiveVbar.next(J.none)):this._inlineManager.changeActiveVbar.next(J.some({alertId:e,state:"opened"})),null===(t=this.items.get().find((t=>t.alert.id===e)))||void 0===t||t.hoveringService.reset()}onVbarMount(e){const t=this.items.get().find((t=>t.alert.id===e));t&&!this._mountedFeedbacks.has(e)&&(this._sendFeedback(t.alert.id,{kind:bi.yp.RENDERED,subtype:bi.U3.Vbar}),this._mountedFeedbacks.add(e))}onInlineCardMount(e){this.items.get().find((t=>t.alert.id===e))&&this._sendFeedback(e,{kind:bi.yp.LOOKED,subtype:bi.U3.Inline})}onStickerMount(e){this._sendFeedback(e,{kind:bi.yp.LOOKED,subtype:bi.U3.Vbar})}onVbarMouseEnter(e){const t=this.items.get().find((t=>t.alert.id===e));t&&t.hoveringService.htmlElementHandlers.onMouseEnter()}onVbarMouseLeave(e){const t=this.items.get().find((t=>t.alert.id===e));t&&t.hoveringService.htmlElementHandlers.onMouseLeave()}onVbarClose(){this._inlineManager.changeActiveVbar.next(J.none)}onGiveFeedbackClick(e){const t=J.fromNullable(this.items.get().find((t=>t.alert.id===e)));this.isVisibleFeedbackModal.set((0,o.pipe)(t,J.map((e=>e.alert))))}onCloseFeedbackModal(){this.isVisibleFeedbackModal.set(J.none)}submitFeedback(e,t){return this.isVisibleFeedbackModal.set(J.none),(0,o.pipe)(this._sendFeedback(e,{kind:bi.yp.USER_SATISFACTION_FEEDBACK,subtype:bi.U3.Vbar,userSatisfactionDescription:t.detailed}),Z.fold(o.constFalse,o.constTrue),this._notifyFeedbackSent,S.T(o.constVoid),we.$()).toPromise()}dispose(){this.highlightedVbarAlert.complete(),this._sub.unsubscribe(),this.items.get().forEach((e=>e.hoveringService.reset()))}_createVbarActivationSub(){return this._inlineManager.activeVbar.subscribe((e=>{(0,o.pipe)(e,J.fold((()=>{this.highlightedVbarAlert.next(J.none),this.items.modify((e=>e.map((e=>(0,a._)((0,r._)({},e),{state:"visible"})))))}),(e=>{const t=this.items.get().findIndex((t=>t.alert.id===e.alertId)),i=this.items.get()[t];t>-1&&(this.highlightedVbarAlert.next(J.some(i.alert)),this.items.modify((i=>i.map(((i,s)=>s===t?(0,a._)((0,r._)({},i),{state:e.state}):(0,a._)((0,r._)({},i),{state:"visible"}))))))})))}))}_updateItems(e,t){(0,o.pipe)(this._denaliEditorModel.contentRect,te.Mi((i=>{const s=function(e,t,i,s){return(0,o.pipe)(e,(0,vi.Tj)((e=>(0,o.pipe)(e.highlightTexts,(0,vi.rO)((i=>t.getMarkByAlert({alert:e,highlightIndex:i}))),(i=>i.concat(t.getEnclosingMarkByAlert(e))),vi.oE,(e=>{const t={left:Number.MAX_SAFE_INTEGER,top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER};return(0,o.pipe)(e,(0,vi.Tj)((e=>J.fromEither(e.getRect()))),vi.oE,(0,vi.cy)((e=>e.clientRects)),(0,vi.TS)(t,((e,t)=>({left:Math.min(t.left-i.left,e.left),top:Math.min(t.top-i.top,e.top),bottom:Math.max(t.top-i.top+t.height,e.bottom)}))))}),(t=>(0,a._)((0,r._)({},t),{alert:e,state:"visible",mode:"replacement",withSticker:s}))))))}(e,this._marksVM,i,!t);var n,l,c;this.items.modify((n=s,l=this._inlineManager,c=this._activeVbarProxy.view(),e=>{const t=[];return n.forEach((i=>{const s=e.find((e=>e.alert.id===i.alert.id));s?t.push((0,a._)((0,r._)({},i),{state:s.state,hoveringService:s.hoveringService})):t.push((0,a._)((0,r._)({},i),{hoveringService:(0,ki.m)({onHover:()=>{(0,o.pipe)(c.get(),te.Lw((e=>"opened"!==e.state)))&&l.changeActiveVbar.next(J.some({alertId:i.alert.id,state:"hovered"}))},onBlur:()=>{(0,o.pipe)(c.get(),J.fold((()=>l.changeActiveVbar.next(J.none)),(e=>{e.alertId===i.alert.id&&l.changeActiveVbar.next(J.none)})))}},100,300)}))})),t}))})))}_createVbarItemsSub(){return C.zV([(e=this._checkingState,t=this._alertVisibleFilter,C.zV([e,t]).pipe(S.T((([e,t])=>(0,o.pipe)(e,Si.A.reduce([],((e,{alert:i})=>(0,Y.M4)(p.Fc.isVbar,t)(i)?[...e,i]:e)),(e=>e.sort(p.HJ.ord.compare)),(0,vi.Tj)(ce.A.fromModel)))))),this._isAssistantMode,this._denaliEditorModel.changes.pipe(v.Z(null)),this._denaliEditorModel.viewport]).subscribe((([e,t,i,s])=>this._updateItems(e,t)));var e,t}_createCAPISub(){return this._capiEvents.pipe(w.p((e=>"session_started"===e.kind))).subscribe((()=>{this._mountedFeedbacks.clear()}))}constructor(e,t,i,s,r,a,l,d,h){(0,n._)(this,"_capiEvents",void 0),(0,n._)(this,"_denaliEditorModel",void 0),(0,n._)(this,"_alertsService",void 0),(0,n._)(this,"_checkingState",void 0),(0,n._)(this,"_alertVisibleFilter",void 0),(0,n._)(this,"_marksVM",void 0),(0,n._)(this,"_inlineManager",void 0),(0,n._)(this,"_isAssistantMode",void 0),(0,n._)(this,"_notifyFeedbackSent",void 0),(0,n._)(this,"items",void 0),(0,n._)(this,"highlightedVbarAlert",void 0),(0,n._)(this,"alertClickedInAssistantMode",void 0),(0,n._)(this,"isVisibleFeedbackModal",void 0),(0,n._)(this,"_sub",void 0),(0,n._)(this,"_mountedFeedbacks",void 0),(0,n._)(this,"_sendFeedback",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_activeVbarProxy",void 0),this._capiEvents=e,this._denaliEditorModel=t,this._alertsService=i,this._checkingState=s,this._alertVisibleFilter=r,this._marksVM=a,this._inlineManager=l,this._isAssistantMode=d,this._notifyFeedbackSent=h,this.items=c.s.create([]),this.highlightedVbarAlert=new _.B7,this.alertClickedInAssistantMode=new _.B7,this.isVisibleFeedbackModal=c.s.create(J.none),this._sub=new pt.y,this._mountedFeedbacks=new Set,this._sendFeedback=(e,t)=>(0,o.pipe)(this._alertsService.applyFeedback(e,t,p.Kz.text),Z.mapLeft((e=>(this._log.error("error sending alert feedback",e),e)))),this._log=se.Bx.Logging.getLogger("VbarsViewModelImpl",ge.$.DEBUG),this._activeVbarProxy=c.s.create(J.none),this._sub.add(this._inlineManager.activeVbar.subscribe(y.H9(this._activeVbarProxy))),this._sub.add(this._createVbarActivationSub()),this._sub.add(this._createVbarItemsSub()),this._sub.add(this._createCAPISub())}}const wi=e=>()=>e.getCursor().index;class Ei{dispose(){this._engine.shutdown(),this.searchViewModel.dispose(),this.marksViewModel.dispose(),this.synonymsViewModel.dispose(),J.option.map(this._reportViewModel,(e=>e.dispose())),this.downloadViewModel.dispose(),this.documentSettingsViewModel.dispose(),this._pageTelemetry.dispose(),this._gbRuleCreatedViewModel.dispose(),this.inlineCardViewModel.dispose(),this.hotkeyManager.dispose(),this.cheetahViewModel.dispose(),this.sduiInlineViewModel.get().dispose(),this._subs.dispose(),this.a11yNotificationManager.dispose()}createLoaderViewModel(e){return new hi.C(this.documentLoader.state,this.navigationViewModel,this._engine.sessionModel,e,this._denaliEditorModel)}constructor(e,t,i,j,ce,he,me,_e,fe,ye,ve,be,Se,ke,Ce,we,Ee,xe,Te,Ae){(0,n._)(this,"_engine",void 0),(0,n._)(this,"_denaliEditorModel",void 0),(0,n._)(this,"_userAccount",void 0),(0,n._)(this,"_upgradeHook",void 0),(0,n._)(this,"_subscription",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"_platformEnvironment",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_remSizeObs",void 0),(0,n._)(this,"_networkState",void 0),(0,n._)(this,"_docId",void 0),(0,n._)(this,"_uploadViewModel",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_dialectSettings",void 0),(0,n._)(this,"documentLoader",void 0),(0,n._)(this,"_textResources",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_router",void 0),(0,n._)(this,"_experimentClient",void 0),(0,n._)(this,"accountViewModel",void 0),(0,n._)(this,"inlineCardViewModel",void 0),(0,n._)(this,"lensPreviewViewModel",void 0),(0,n._)(this,"marksViewModel",void 0),(0,n._)(this,"alertUserEvents",void 0),(0,n._)(this,"synonymsViewModel",void 0),(0,n._)(this,"proofitViewModel",void 0),(0,n._)(this,"onboardingViewModel",void 0),(0,n._)(this,"upgradeViewModel",void 0),(0,n._)(this,"searchViewModel",void 0),(0,n._)(this,"downloadViewModel",void 0),(0,n._)(this,"feedbackViewModel",void 0),(0,n._)(this,"navigationViewModel",void 0),(0,n._)(this,"modalManager",void 0),(0,n._)(this,"hotkeyManager",void 0),(0,n._)(this,"formattingViewModel",void 0),(0,n._)(this,"emotionsViewModel",void 0),(0,n._)(this,"documentSettingsViewModel",void 0),(0,n._)(this,"autofocusListener",void 0),(0,n._)(this,"documentPlaceholderViewModel",void 0),(0,n._)(this,"focus",void 0),(0,n._)(this,"cheetahViewModel",void 0),(0,n._)(this,"capiSession",void 0),(0,n._)(this,"notificationsManager",void 0),(0,n._)(this,"a11yNotificationManager",void 0),(0,n._)(this,"_getAlertClosestToCursor",void 0),(0,n._)(this,"_cheetahInlineAvailabilityProvider",void 0),(0,n._)(this,"_inlineManager",void 0),(0,n._)(this,"_reportViewModel",void 0),(0,n._)(this,"_pageTelemetry",void 0),(0,n._)(this,"_gbRuleCreatedViewModel",void 0),(0,n._)(this,"_openInlineAlert",void 0),(0,n._)(this,"_inlineAlertHovered",void 0),(0,n._)(this,"vbarsViewModel",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"sduiInlineViewModel",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_editorWrapperViewport",void 0),(0,n._)(this,"_remSize",void 0),this._engine=e,this._denaliEditorModel=t,this._userAccount=i,this._upgradeHook=j,this._subscription=ce,this._environment=he,this._platformEnvironment=me,this._telemetry=_e,this._remSizeObs=fe,this._networkState=ye,this._docId=ve,this._uploadViewModel=be,this._notificationsManager=Se,this._dialectSettings=ke,this.documentLoader=Ce,this._textResources=we,this._config=Ee,this._router=xe,this._experimentClient=Te,this.accountViewModel=Ae,this.formattingViewModel=J.none,this.emotionsViewModel=J.none,this._reportViewModel=J.none,this._openInlineAlert=new _.B7,this._inlineAlertHovered=new _.B7,this._log=se.Bx.Logging.getLogger("ViewModels"),this._subs=new f.y.Keeper,this._editorWrapperViewport=c.s.create(this._denaliEditorModel.viewport.value.wrapper),this._remSize=c.s.create(16);const Ie=s.create();this.focus=U.B.create({contentFocusChanges:oe.r.create(this._denaliEditorModel),eq:oe.B.eq,ord:oe.B.ord,show:oe.B.show,contentSection:J.some(oe.B.create(oe.B.Id.editor))}),this.proofitViewModel=new Re.Md(this._subscription,this._engine.sessionModel,this._denaliEditorModel,this._userAccount,this._notificationsManager,this._router,this._config),this.notificationsManager=Se;const Be=this._log.getLogger("Oggy"),Pe=new V.o.Impl(this._engine.checkingDomain.state,this._engine.positionManager,this._engine.alertsReader,(0,Y.M4)(p.Fc.isRegistered,(0,Y.AU)(p.Fc.isMuted)));this._getAlertClosestToCursor=(0,W.h_)((e=>{switch(e){case"cursor":return wi(this._denaliEditorModel)();case"middleOfTheViewport":return(0,l.pipe)(this._denaliEditorModel.getPossibleCursorPosition(Z.left(d.Yd.X.middle),Z.left(d.Yd.Y.middle)),Z.getOrElse(wi(this._denaliEditorModel)));default:return(0,X.xb)(e)}}),Pe);const Fe=(0,l.pipe)(this._userAccount.features.denali.mutedAlerts,J.fromPredicate(o.identity),J.map((()=>this._engine.mutedAlertsModel))),Oe=c.s.create(g.K.defaultState),He=$.v.create($.v.defaultLensFilters,$.v.defaultTextFilters);this.lensPreviewViewModel=new ci(Oe.view("lenses"),He),this.upgradeViewModel=new fi.t(this._engine.checkingDomain,this.lensPreviewViewModel,this._docId,this._platformEnvironment,this._upgradeHook,this._config,this._userAccount.features.denali.uphookFormat,this._userAccount.features.denali.uphookDestination,this._userAccount.features.isSmartPlagiarismUphookEnabled,this._experimentClient,(()=>this._userAccount.features.isEligibleForFreeTrial),(()=>this._userAccount.features.isEligibleForFreeTrialEuUk),this._userAccount.features.proVsPremiumExperiment,this._userAccount.features.assignProVsPremiumExperiment),this.feedbackViewModel=new zt(this._notificationsManager,(e=>(se.Bx.Logging.getLogger("userFeedback").info("Submit form feedback",{briefDescription:e.brief,detailedFeedback:e.detailed}),this._telemetry.gnarSpec.feedbackFormSubmit(e.brief,e.detailed,this._telemetry.pageId)))),this._subs.push(this._engine.checkingDomain.state.pipe((e=>g.K.get(e,this._engine.checkingDomain.lensesScores,He))).subscribe(y.H9(Oe))),this.a11yNotificationManager=(()=>{const e=function(){const e=new Map;return{registerStatus:t=>{const i=Xe+t,s=tt(i);return s.setAttribute("role","status"),s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),st(s),document.body.appendChild(s),e.set(i,s),{change:e=>function(e,t,i){const s=document.getElementById(t);if(s)return""===e?(s.innerHTML="&nbsp;",void setTimeout((()=>s.innerHTML=""),1e3)):void(s.textContent=e);{const s=document.createElement("div");s.id=t,s.textContent=e,i.appendChild(s)}}(e,i,s),dispose:()=>s.remove()}},dispose:()=>{e.forEach((e=>e.remove()))}}}(),t=function(){const e=tt(Ze);e.setAttribute("role","alert"),e.setAttribute("aria-live","assertive"),e.setAttribute("aria-relevant","additions"),st(e);const t=tt(Ye);return t.setAttribute("role","log"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-relevant","additions"),st(t),{announceMessage:i=>{switch(i.type){case"alert":it(i.text,e);break;case"log":it(i.text,t);break;default:(0,X.AS)(i.type)}},dispose:()=>{e.remove(),t.remove()}}}();return{announceMessage:t.announceMessage,registerStatus:e.registerStatus,dispose:()=>{e.dispose(),t.dispose()}}})(),this._reportViewModel=this._environment.has(je.OH.Flag.supportsDownloadPDF)?J.some(new Le.zL(this._engine,this._userAccount.profile,this._userAccount.features,this._notificationsManager,this._denaliEditorModel.contentUpdated.pipe(v.Z(null),b.c(0),S.T(this._denaliEditorModel.getHTML)),(0,Q.eu)(this._denaliEditorModel.getContents),(()=>this.marksViewModel),(()=>this.navigationViewModel),Oe.view("lenses"),this._telemetry)):J.none,this.modalManager=new h.jM(new qe.JG(this._userAccount,this._textResources,this._engine.sessionModel,this.upgradeViewModel,this._config,this._platformEnvironment,this.feedbackViewModel,this._notificationsManager,this._engine.sessionModel,this._reportViewModel,this._telemetry,this._engine.mutedAlertsModel,this.accountViewModel.logout,this.a11yNotificationManager.registerStatus("set-goals-modal"))),this.navigationViewModel=new le.xK(this._telemetry,this.modalManager,this._userAccount.features,this._getAlertClosestToCursor,this._engine.sessionModel,Fe,c.s.create(q.p.CardVisualMode.ContrastLightMode),c.s.create(!0),Oe.view("lenses").view((0,o.flow)(m.x.lookup(u.J.SpecialId.Premium),J.map((e=>e.count)),J.getOrElse((0,o.constant)(0)),(e=>({title:"Premium",count:e})))),this._engine.cheetah.oggyUphookModel,this._engine.cheetah.oggyPlagiarismModel),this._pageTelemetry=new gi(this.navigationViewModel.state.view("isSidebarOpen"),this._telemetry);const Ke=this.navigationViewModel.state.view("isSidebarOpen");this.searchViewModel=new _i.XS(this._denaliEditorModel,this._engine.positionManager,this._editorWrapperViewport),this.downloadViewModel=new Qt(this._engine.sessionModel,this._notificationsManager),this.documentSettingsViewModel=(0,ui.N1)(this._denaliEditorModel,this._router,this._textResources.denali,this._userAccount,this._dialectSettings,this.downloadViewModel,this.upgradeViewModel,this.modalManager,this._uploadViewModel,this._environment,this._notificationsManager,this.searchViewModel,this._telemetry,this._engine.sessionModel,this.navigationViewModel.state.pipe(k.i(1)),this.accountViewModel),this._cheetahInlineAvailabilityProvider=rt.create(this.navigationViewModel,this.documentSettingsViewModel.viewModel.visualState,this._engine.cheetah.genAiAvailabilityService.availability,this._userAccount.features.denali);const $e=this._engine.sessionModel.rtfMode===ne.jj.l1.FormattingMode.on?J.some((0,ni.hn)(this._denaliEditorModel.getCursor.bind(this._denaliEditorModel),(e=>{this._denaliEditorModel.setFormatting((0,a._)((0,r._)({},e),{meta:(0,a._)((0,r._)({},e.meta),{formatting:(0,r._)({},e.meta.formatting)})}))}),this._denaliEditorModel.selectedFormatting,this._denaliEditorModel.isEditorFocused,this._textResources.denali,this._telemetry.gnarSpec,this._telemetry.pageId,this._environment)):J.none,Ve=C.zV([this._engine.cheetah.oggyManager.alertVisibilityFilter,this.navigationViewModel.state]).pipe(S.T((([e,{isSidebarOpen:t,isGgoOpen:i}])=>this._userAccount.features.denali.oggy===re.kH.splitSharedAssistants&&i?o.constFalse:t?e:p.Fc.isInline))),Ue=Ve.pipe(S.T((e=>({filter:e,lensId:u.J.SpecialId.AllAlerts}))));this.marksViewModel=new pi.t(this._denaliEditorModel,this._engine.checkingDomain,this._engine.alertsReader,this._engine.alertsService,this._engine.alertsService,this._environment.has(je.OH.Flag.highHighlights),new z.a(this._engine.cheetah.oggyManager.alertHighlightChanges),He,Ue,this._userAccount.settings.editorPreferences.view("suggestionsVisualMode"),this._engine.cheetah.oggyManager.alertHighlightChanges,this._userAccount.features.denali.lockedUIUXExperimentTreatment,this._userAccount.features.isFree),this.alertUserEvents=new K.Jc(this._denaliEditorModel,this.marksViewModel,this._engine.alertsReader,this._engine.cheetah.oggyManager.alertHighlightChanges,Ve),this._inlineManager=function(e,t,i,s,n,r){const a=c.s.create(Jt.idle),l=c.s.create(new Set([Jt.Type.idle])),d=se.Bx.Logging.getLogger("inlineManager");d.isEnabled(ge.$.DEBUG)&&a.subscribe((e=>d.debug("state change to",e)));const h=new _.B7,u=new _.B7,m=new _.B7,g=new _.B7,f=new _.B7,b=new _.B7,k=c.s.create(J.none),w=(0,o.pipe)(s,J.fold((()=>E.w),(e=>ni.uY.fromToolbar(e.linkEvents))),ei.u()),M={[Jt.Type.idle]:Jt.Scheme.monoid.empty,[Jt.Type.formattingLink]:Jt.Scheme.forFormattingLink(e,w,m),[Jt.Type.upgradeHook]:Jt.Scheme.forUpgradeHook(t,i,g),[Jt.Type.synonymsCard]:Jt.Scheme.forSynonymsState(n,u),[Jt.Type.inlineCard]:Jt.Scheme.forCardState(t,i,h),[Jt.Type.cheetahInlineButton]:Jt.Scheme.forCheetahInlineButton(e,r,f),[Jt.Type.vbarCard]:Jt.Scheme.forVbarCard(b),[Jt.Type.teaserCard]:Jt.Scheme.forTeaserCard(t,i,h,k)},T=l.view(Array.from).view(Me.ue(Jt.Scheme.monoid)((e=>M[e]))),I=C.zV([T,a.view("type")]).pipe(pe.n((([e,t])=>x.h(...e[t]))),ti.S(((e,t)=>{const[i,s]=t(e);return d.debug("state change",{prevState:e,changeReason:i,nextState:s}),s}),Jt.idle),R.M(y.H9(a)),v.Z(Jt.idle),ei.u()),B=e=>ue.c.create((()=>(l.modify((t=>new Set(t).add(e))),()=>l.modify((t=>{const i=new Set(t);return i.delete(e),i}))))).pipe(v.Z(y.q6));return{doubleClickedWord:B(Jt.Type.synonymsCard).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.synonymsCard?J.some(e.word):J.none)))),A.F(J.getEq(De.h0.ord).equals),ei.u()),closeSynonyms:u,hoveredMarkAlert:x.h(B(Jt.Type.inlineCard),B(Jt.Type.teaserCard)).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.inlineCard||e.type===Jt.Type.teaserCard?J.some(e.alert):J.none)))),A.F(J.getEq(p.HJ.ord).equals),ei.u()),closeCards:h,formattingLinkState:B(Jt.Type.formattingLink).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.formattingLink?J.some(e.link):J.none)))),A.F(J.getEq(si.W.LinkState.eq).equals),ei.u()),closeLinks:m,upgradeHookState:B(Jt.Type.upgradeHook).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.upgradeHook?J.some(e.alert):J.none)))),A.F(J.getEq(de.z.eq).equals),ei.u()),closeUpgradeHooks:g,cheetahInlineButtonState:B(Jt.Type.cheetahInlineButton).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.cheetahInlineButton?J.some((0,Y.Yi)()):J.none)),ei.u()))),closeCheetahInlineButton:f,activeVbar:B(Jt.Type.vbarCard).pipe(N.K(I.pipe(S.T((e=>e.type===Jt.Type.vbarCard?e.vbar:J.none)))),ei.u()),changeActiveVbar:b,currentTeaser:k,changeTeaserExpanded:e=>k.set(e)}}(this._denaliEditorModel,this.alertUserEvents,this._engine.alertsReader,$e,Ie,this._cheetahInlineAvailabilityProvider);const Qe=C.zV([Ke,Ve]).pipe(S.T((([e,t])=>e?t:o.constTrue)));this.vbarsViewModel=this._userAccount.features.denali.writingExpertVbarsEnabled?J.some(new Ci(this._engine.obsCapiClient.events,this._denaliEditorModel,this._engine.alertsService,this._engine.checkingDomain.state,Qe,this.marksViewModel,this._inlineManager,Ke,(e=>this.notificationsManager.enqueue(e?"feedbackSend":"error").pipe(w.p((e=>"shown"===e)))))):J.none;const We=(0,l.pipe)(this.vbarsViewModel,J.map((e=>e.highlightedVbarAlert.pipe(S.T(J.map((e=>({alert:e,highlightIndex:0,source:p.Kz.text}))))))),J.getOrElse((()=>E.w))),Je=this.navigationViewModel.state.view("isSidebarOpen");this._subs.push((0,l.pipe)(this._engine.cheetah.oggyManager,ae.Factory.create(Be,ae.focusAlertByClickedMark(x.h(x.h(this.alertUserEvents.alertClicked,We),(0,l.pipe)(this.vbarsViewModel,J.map((e=>e.alertClickedInAssistantMode)),J.getOrElse((()=>E.w))))),ae.highlightMark(this._engine.alertsReader,this.marksViewModel,this.focus.state,this._denaliEditorModel.contentUpdated.pipe(w.p((e=>"user"===e.source))),this._denaliEditorModel.isEditorFocused,Je),ae.openInlineAlerts(this.navigationViewModel,this._openInlineAlert),ae.updateLoaderStateOnReady(this.documentLoader),ae.openAssistantWithActiveCard(this.navigationViewModel,this._engine.cheetah.oggyUphookModel),ae.openAssistantWithPlagiarism(this.navigationViewModel,this._engine.cheetah.oggyPlagiarismModel),ae.unfocusAlertHighlightOnSidebarClose(Je),ae.scrollAlertIntoView(this.marksViewModel,Je),ae.toggleAutoScroll(this._userAccount.settings.editorPreferences.view("autoScrollToNextAlert").view(M.O.unwrap(!this._userAccount.features.denali.autoJumpSettings.isDisabledByDefault)))))),this.cheetahViewModel=It.create({engine:this._engine,denaliEditorModel:this._denaliEditorModel,userAccount:this._userAccount,upgradeVM:this.upgradeViewModel,navigationVM:this.navigationViewModel,dialect:this._dialectSettings,telemetry:this._telemetry,inlineManager:this._inlineManager,modalManager:this.modalManager,experimentClient:this._experimentClient,environment:this._environment,platformEnvironment:this._platformEnvironment,config:this._config,notificationsManager:this._notificationsManager}),this._subs.push(T.R(window,"beforeunload").subscribe((()=>this.cheetahViewModel.dispose()))),this.vbarsViewModel=J.none,this._subs.push(this._denaliEditorModel.viewport.pipe(A.F(),S.T((e=>e.wrapper))).subscribe(y.H9(this._editorWrapperViewport)),this._remSizeObs.subscribe(y.H9(this._remSize)),oe.B.initTracking(this.focus,this._telemetry),this._denaliEditorModel.dontFreezeWhen(this.focus.state.pipe(S.T(J.exists((e=>e.id!==oe.B.Id.editor)))),"focus-manager"),this._denaliEditorModel.contentUpdated.pipe(w.p(d.D_.isTextMaybeWithFormatting),S.T((()=>this._denaliEditorModel.getTextLength())),v.Z(this._denaliEditorModel.getTextLength()),I.J(),w.p((([e,t])=>e-t>500)),B.p((()=>P.timer(1e3).pipe(F.Q(this._denaliEditorModel.shortcutUsed),N.K(this.notificationsManager.enqueue("textRemoved").pipe(F.Q(this._denaliEditorModel.shortcutUsed.pipe(R.M((()=>this._telemetry.gnarSpec.undoTextRemovedHotkeyPress())))),R.M((e=>{"shown"===e?this._telemetry.gnarSpec.undoTextRemovedNotificationShow(this._telemetry.pageId):"undo"===e&&(this._denaliEditorModel.undo(),this._telemetry.gnarSpec.undoTextRemovedButtonClick(this._telemetry.pageId))})),L.v((e=>"undo"!==e)))))))).subscribe()),this.capiSession=new nt(this._engine.cheetah.capiMessages),this._gbRuleCreatedViewModel=new jt(this._config,this._engine.obsCapiClient,this._notificationsManager,this._telemetry),this._subs.push(this._denaliEditorModel.clickedWord.pipe(S.T(J.filter((e=>2===e.meta.clicks))),D.E(this.alertUserEvents.alertClicked.pipe(v.Z(J.none)),((e,t)=>J.isNone(t)?e:J.none)),O.oE).subscribe(Ie.doubleClickedWord));const et=Zt.k.ViewModel.getInlineHighlightFilter(Ke),at=(0,o.flow)(this.marksViewModel.getMarkByAlert,Z.fromOption((()=>new Error("mark not found"))),Z.chain((e=>e.getRect())),ee.Mr);this.inlineCardViewModel=new Zt.e(this._inlineManager,at,x.h(this._denaliEditorModel.contentUpdated.pipe(H.u(y.q6))),this._engine.checkingDomain,this._engine.alertsReader,this._engine.alertsService,this._telemetry,this._openInlineAlert,this._inlineAlertHovered,et,this.notificationsManager),(()=>{this._subs.push(this._engine.sduiInlineManager.pipe(R.M((e=>{const t=new Yt.b9(this._engine.sduiService,this._engine.sduiManager.get(),e,this.inlineCardViewModel,this._engine.alertsReader,this._engine.obsCapiClient,this._platformEnvironment,(0,ze.l)(this.notificationsManager,this._environment));(0,l.pipe)(J.fromNullable(this.sduiInlineViewModel),te.Mi((e=>{e.get().dispose(),this.sduiInlineViewModel.set(t)})),te.jw((()=>this.sduiInlineViewModel=c.s.create(t))))}))).subscribe())})(),this.synonymsViewModel=new Ge(this._inlineManager,this._engine.positionManager,this._engine.synonymsModel,this._networkState,this._denaliEditorModel,this._notificationsManager,this._engine.cheetah.oggyManager.alertHighlightChanges,(()=>this._telemetry.gnarSpec.notificationCloseButtonClick("alertUndo",this._telemetry.pageId)),((e,t)=>{this._telemetry.gnarSpec.synonymsPopupShow(t.numberOfMeanings,t.numberOfSynonymsByMeanings,t.numberOfSynonymsTotal,this._telemetry.pageId,e)}),((e,t,i)=>{this._telemetry.gnarSpec.synonymsPopupClose(t.numberOfMeanings,t.numberOfSynonymsByMeanings,t.numberOfSynonymsTotal,i,this._telemetry.pageId,e)}),((e,t,i)=>{this._telemetry.gnarSpec.synonymsAcceptButtonClick(t.meaningIndex,t.synonymIndexInGroup,t.synonymIndexAbs,t.numberOfMeanings,t.numberOfSynonymsByMeanings,t.numberOfSynonymsTotal,i,this._telemetry.pageId,e)})),this.formattingViewModel=(0,l.pipe)(te.CO($e,this._engine.formattingModel),J.map((([e,t])=>{const i=si.W.createManager(this._denaliEditorModel,t,this._inlineManager);return this._subs.push(e,i),{toolbarViewModel:e.viewModel,linksManager:i}}))),this.documentPlaceholderViewModel=new Kt(this._uploadViewModel,this._denaliEditorModel,this._userAccount,this._environment),this.emotionsViewModel=(0,l.pipe)(this._engine.emotionsModel,J.map((e=>qt.H.ViewModel.create(e,this._engine.sessionModel,this._textResources.denali))));const ot=(0,l.pipe)($e,J.map((e=>[e.viewModel,this.searchViewModel,this.documentSettingsViewModel.viewModel])),J.getOrElse((()=>[this.searchViewModel,this.documentSettingsViewModel.viewModel])));this.hotkeyManager=new G.ai(ie.th.from(ot),this._environment.has(je.OH.Flag.isAppleSystem),this._environment.platform===je.OH.Platform.IPAD),this.onboardingViewModel=new Ne(this._userAccount.settings,this._denaliEditorModel,this._engine.sessionModel,this._engine.alertsReader,this._userAccount.features.onboardingMode(),this._telemetry,this._engine.cheetah.oggyManager.alertHighlightChanges,(()=>this.marksViewModel.getFirstMark().pipe(O.oE,S.T((e=>J.fromEither(e.getRect()))))),this.cheetahViewModel,this.navigationViewModel,this._userAccount.features)}}},55638:(e,t,i)=>{i.d(t,{Jr:()=>s,b9:()=>P});var s,n,r=i(23988),a=i(79535),o=i(14018),l=i(57980),c=i(12068),d=i(30040),h=i(80074),p=i(63967),u=i(80159),m=i(78339),g=i(15491),_=i(83541),f=i(42543),y=i(80837),v=i(95168),b=i(6987),S=i(21216),k=i(36094),C=i(54988),w=i(45653),E=i(47370),x=i(44297),M=i(58889),T=i(76720),A=i(86562),I=i(58193),B=i(36840);!function(e){let t;!function(e){e.Initial="Initial",e.RemovedFromCAPIMapping="Removed From CAPI Mapping",e.IdNotResolved="Id Not Resolved",e.NotFound="Not Found",e.EmptyStateOnReconnect="Empty State On Reconnect",e.NativeInlineCardContent="Native Inline Card Content"}(t=e.NoSDUIReason||(e.NoSDUIReason={}))}(s||(s={})),function(e){e.eq=E.OW({highlightIndex:E.US,action:a.G.eq})}(n||(n={}));class P{getInlineItemForAlert(e){const t=(0,d.pipe)(this._alertsReader.getById(e),x.chain(p.Fc.getRawId));return(0,d.pipe)(this._sduiManager.state.pipe(m.p((0,d.not)(o.k.isEmpty))),g.T((e=>(0,d.pipe)(t,M.fromOption((()=>s.NoSDUIReason.RemovedFromCAPIMapping)),M.chain((e=>(0,d.pipe)(this._sduiManager.alertIdResolver(l.W.AlertId.from(e)),M.fromOption((()=>s.NoSDUIReason.IdNotResolved))))),M.chain((e=>(0,d.pipe)(this._inlineSDUIManager.getInlineItemForAlert(e),M.fromOption((()=>s.NoSDUIReason.NotFound))))),M.mapLeft((t=>o.k.isEmpty(e)?s.NoSDUIReason.EmptyStateOnReconnect:t))))),_.skipBy(M.getEq(E.ee(d.constTrue),E.w_)))}_handleSduiCardAction(e){this._sduiViewModel.sduiActionEvents.next(e.action),this._appHandling(e)}_appHandling({action:{actions:e,scope:t},highlightIndex:i}){const s=e.filter((e=>"popAssistantFeed"===e.type||"pushAssistantFeed"===e.type||"focusAssistantCard"===e.type));(0,d.pipe)(s,x.fromPredicate((e=>e.length>0)),x.map((e=>{}))),e.forEach((e=>{switch(e.type){case"nextCard":case"prevCard":case"openSettings":case"openToneDetector":case"openFeedback":case"openLearnMore":case"transition":case"openCreateSnippetModal":case"nativeOpenAssistant":case"selectAlternative":case"highlightAlert":case"closePopover":case"interactPopover":case"openPerformanceScore":case"openGrammarlyGo":case"enablePlagiarismCheck":case"disablePlagiarismCheck":case"enableWritingExpertCheck":case"disableWritingExpertCheck":case"showHighlights":case"hideHighlights":case"notify":case"switchView":case"newRevision":case"popAssistantFeed":case"focusAssistantCard":case"stopApplyingAlerts":case"upgradeToPremium":case"removeRoot":return;case"nativeOpenUserSatisfactionFeedback":return this._inlineCardVM.events.next({type:u.G.Type.feedbackModalOpen});case"openLink":return void this.platformEnvironment.actions.openUrl(new T.U(e.url));case"copyToClipboard":return this._copyToClipboard(e.text,"somethingCopied");case"pushAssistantFeed":return this._pushFeed(e,t,i);case"applyAlerts":return void this._applyAlerts(e,t);case"closeCard":return this._inlineCardVM.events.next({type:u.G.Type.closed});case"removeAlerts":return void this._removeAlerts(e,t);default:(0,A.AS)(e)}}))}_removeAlerts(e,t){(0,A.V1)(t.alertRefs.length>0,"applyAlerts actions must have alerts");const i=this._sduiManager.alertIdResolver(l.W.AlertId.from(t.alertRefs[0]));(0,d.pipe)(i,I.Mi((e=>{this._inlineCardVM.events.next({type:u.G.Type.ignored,alertId:e})})))}_applyAlerts(e,t){(0,A.V1)(t.alertRefs.length>0,"applyAlerts actions must have alerts scope");const i=this._sduiManager.alertIdResolver(l.W.AlertId.from(t.alertRefs[0]));(0,A.V1)(x.isSome(i),"alert id must resolve"),this._inlineCardVM.events.next({type:u.G.Type.applied,alertId:I.$v(i),alternativeIndex:e.alternativeIndex})}_pushFeed(e,t,i){(0,A.V1)(t.alertRefs.length>0,"pushAssistantFeed actions must have alerts scope");const s=this._sduiManager.alertIdResolver(l.W.AlertId.from(t.alertRefs[0]));(0,A.V1)(x.isSome(s),"alert id must resolve");const n=this._alertsReader.getById(I.$v(s));(0,A.V1)(x.isSome(n),"inline alert must be registered"),this._inlineCardVM.events.next({type:u.G.Type.opened,alert:{alert:w.A.fromModel(n.value),highlightIndex:i}})}dispose(){this._subs.dispose()}constructor(e,t,i,s,a,o,l,d){(0,r._)(this,"_sduiManager",void 0),(0,r._)(this,"_inlineSDUIManager",void 0),(0,r._)(this,"_inlineCardVM",void 0),(0,r._)(this,"_alertsReader",void 0),(0,r._)(this,"platformEnvironment",void 0),(0,r._)(this,"_copyToClipboard",void 0),(0,r._)(this,"_sduiInlineCardActions",void 0),(0,r._)(this,"_sduiViewModel",void 0),(0,r._)(this,"_focusedItem",void 0),(0,r._)(this,"_subs",void 0),(0,r._)(this,"events",void 0),(0,r._)(this,"handleSDUIAction",void 0),this._sduiManager=t,this._inlineSDUIManager=i,this._inlineCardVM=s,this._alertsReader=a,this.platformEnvironment=l,this._copyToClipboard=d,this._sduiInlineCardActions=new f.B7,this._focusedItem=h.s.create(x.none),this._subs=new y.y.Keeper,this.handleSDUIAction=(e,t=0)=>{this._sduiInlineCardActions.next({action:e,highlightIndex:t})},this.events=s.events,this._sduiViewModel=new c.W(e,t,new F,o,this._focusedItem.view(x.map((e=>e.id)))),this._subs.push(this._sduiInlineCardActions.pipe(_.skipBy(n.eq),v.M((e=>this._handleSduiCardAction(e)))).subscribe(),this._inlineCardVM.events.pipe(m.p((0,B.Ub)(u.G.isLookedAction,u.G.isCardCloseAction)),b.n((e=>u.G.isLookedAction(e)&&"card"===e.kind?this.getInlineItemForAlert(e.alertId).pipe(g.T(x.fromEither)):S.of(x.none)))).subscribe(k.H9(this._focusedItem)))}}class F{constructor(){(0,r._)(this,"feed",C.w),(0,r._)(this,"currentFeed",x.none),(0,r._)(this,"onFeedRemove",C.w),(0,r._)(this,"onFeedEmpty",C.w),(0,r._)(this,"header",C.w),(0,r._)(this,"footer",C.w),(0,r._)(this,"pushFeed",(()=>M.right(null))),(0,r._)(this,"popFeed",B.Yi),(0,r._)(this,"focusCard",(()=>M.right(null))),(0,r._)(this,"notifyCardFocused",B.Yi),(0,r._)(this,"dispose",B.Yi)}}},80548:(e,t,i)=>{i.d(t,{e:()=>W,k:()=>s});var s,n=i(23988),r=i(10334),a=i(17171),o=i(30040),l=i(63336),c=i(80074),d=i(66799),h=i(63967),p=i(62597),u=i(22809),m=i(80159),g=i(82718),_=i(7323),f=i(78339),y=i(95168),v=i(6987),b=i(80837),S=i(68745),k=i(89769),C=i(65621),w=i(83541),E=i(62822),x=i(21216),M=i(90405),T=i(15491),A=i(68533),I=i(38427),B=i(34078),P=i(54988),F=i(36094),N=i(46669),R=i(11298),L=i(45653),D=i(87275),O=i(93584),H=i(44297),K=i(36840),$=i(58889),V=i(86562),U=i(58193),G=i(69063),Q=i(12486);!function(e){let t,i;!function(e){e.getInlineHighlightFilter=e=>t=>!e.get()||(0,l.pipe)(t,H.map((e=>h.Fc.State.isBulkApplied(e.state))),H.getOrElse(o.constTrue))}(t=e.ViewModel||(e.ViewModel={})),function(e){e.highlightMarkByInlineAlert=(e,t,i,s)=>({id:s,when:(0,K.Ub)(p.J.isClosedId,p.J.isMainLens),what:D.os.Effect.Applicator.create(O.FA.getHighlightSubscription(e,t,i).pipe(g.K(_.t)))})}(i=e.Effects||(e.Effects={}))}(s||(s={}));class W{_openAlert(e){this._openInlineAlert.next(e)}_listenAlertIgnores(){var e;return this.events.pipe(f.p(m.G.isAlertIgnoreAction)).subscribe((t=>this._sendFeedback(t.alertId,{kind:d.yp.IGNORE,subtype:null!==(e=t.subtype)&&void 0!==e?e:d.U3.Inline})))}_listenAlertAddedToDictionary(){return this.events.pipe(f.p(m.G.isAlertAddToDictionaryAction)).subscribe((e=>this._sendFeedback(e.alertId,{kind:d.yp.ADD_TO_DICTIONARY,subtype:d.U3.Inline})))}_listenAlertOpenings(){return this.events.pipe(f.p(m.G.isAlertOpenAction)).subscribe((e=>{this._openAlert(e.alert)}))}_listenAlertClose(){return this.events.pipe(f.p(m.G.isCardCloseAction)).subscribe((()=>{this._inlineManager.changeTeaserExpanded(H.none)}))}_listenAlertApplies(){return this.events.pipe(f.p(m.G.isAlertApplyAction)).subscribe((e=>{(0,l.pipe)(this._alertsService.apply(e.alertId,{alternativeIndex:e.alternativeIndex,source:h.Kz.text,feedbackSubtype:d.U3.Inline}),$.fold((e=>this._log.error("error applying alert",e)),(()=>{const t=(0,l.pipe)(this._alertsReader.getById(e.alertId),H.chain((e=>e.extraProperties.freePremium)),H.exists((e=>"unlocked"===e)));this._telemetry.gnarSpec.suggestedReplacementButtonClick(t,this._telemetry.pageId,"defaultCard","assistantOff",this._telemetry.pageSessionId)})))}))}_listenCardLooks(){return this.events.pipe(f.p(m.G.isLookedAction),f.p((e=>this._alertsReader.isValidForFeedback(e.alertId)))).subscribe((({alertId:e,kind:t})=>this._sendFeedback(e,{kind:d.yp.LOOKED,subtype:"card"===t?d.U3.Inline:d.U3.UnderlineWithTeaser})))}_listenFeedbackModalStateChanges(){return this.events.pipe(f.p((0,K.Ub)(m.G.isFeedbackOpenAction,m.G.isFeedbackCloseAction)),y.M((e=>this.feedbackModalOpen.set(m.G.isFeedbackOpenAction(e))))).subscribe()}_listenUserFeedbackSubmissions(){return this.events.pipe(f.p(m.G.isFeedbackSubmitAction),v.n((e=>(0,l.pipe)(this._sendFeedback(e.alertId,{kind:d.yp.USER_SATISFACTION_FEEDBACK,subtype:e.source,userSatisfactionDescription:e.feedback}),$.fold((()=>this._notificationsManager.enqueue("error")),(()=>(this.feedbackModalOpen.set(!1),this._notificationsManager.enqueue("feedbackSend")))))))).subscribe()}_listenTeaserExpands(){return this.events.pipe(f.p(m.G.isTeaserExpandAction),y.M((({alertId:e})=>{this._inlineManager.changeTeaserExpanded(H.some(e)),this._sendFeedback(e,{kind:d.yp.ACCEPTED,subtype:d.U3.UnderlineWithTeaser,alternativeIndex:0})}))).subscribe()}dispose(){this._subs.dispose()}constructor(e,t,i,s,d,p,g,_,D,O,K){(0,n._)(this,"_inlineManager",void 0),(0,n._)(this,"_alertMarkRectGetter",void 0),(0,n._)(this,"_closeEvent",void 0),(0,n._)(this,"_checkingDomain",void 0),(0,n._)(this,"_alertsReader",void 0),(0,n._)(this,"_alertsService",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_openInlineAlert",void 0),(0,n._)(this,"_hovered",void 0),(0,n._)(this,"_inlineHighlightFilter",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"events",void 0),(0,n._)(this,"feedbackModalOpen",void 0),(0,n._)(this,"teaserExpanded",void 0),(0,n._)(this,"_emitCloseWhen",void 0),(0,n._)(this,"_toMarkAndAlert",void 0),(0,n._)(this,"state",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_sendFeedback",void 0),this._inlineManager=e,this._alertMarkRectGetter=t,this._closeEvent=i,this._checkingDomain=s,this._alertsReader=d,this._alertsService=p,this._telemetry=g,this._openInlineAlert=_,this._hovered=D,this._inlineHighlightFilter=O,this._notificationsManager=K,this._subs=new b.y.Keeper,this.events=new S.t({type:m.G.Type.closed}),this.feedbackModalOpen=c.s.create(!1),this.teaserExpanded=this._inlineManager.currentTeaser.pipe(k.Z(H.none),C.J(),v.n((([e,t])=>H.isSome(e)&&H.isNone(t)?w.timer(300).pipe(E.u(!1),k.Z(!0)):x.of(H.isSome(t)))),w.shareReplay({bufferSize:1,refCount:!0})),this._emitCloseWhen=M.MA((e=>this._checkingDomain.state.pipe(T.T(u.A.get(e.id)),f.p(H.isNone),A.h(this._closeEvent),y.M(this._inlineManager.closeCards)))),this._toMarkAndAlert=(0,o.flow)(H.filter((e=>H.isSome(this._alertsReader.getInteractable(e.id)))),H.map((e=>{(0,V.V1)(!h.Fc.isInPremiumLens(e)||L.A.isLockedUIAlert(e),"Can't hover plagiarism alert");const t={alert:e,highlightIndex:0};return(0,a._)((0,r._)({},t),{getMarkRect:this._alertMarkRectGetter(t)})}))),this.state=I.zV(this._inlineManager.hoveredMarkAlert.pipe(f.p(this._inlineHighlightFilter),v.n(this._emitCloseWhen)),this.events.pipe(y.M((e=>{"unhovered"===e.type&&this._telemetry.gnarSpec.alertUnderlineHover(this._telemetry.pageId,"assistantOff",this._telemetry.pageSessionId)})))).pipe(B.s((([e,t])=>w.timer(H.isNone(e)&&"closed"!==t.type?300:0))),v.n((([e,t])=>(0,l.pipe)(e,H.fold((()=>"hovered"===t.type?P.w:(this._hovered.next(U.Ie()),x.of(H.none))),(e=>{switch(this._hovered.next(H.some(e)),t.type){case m.G.Type.closed:return F.cb(H.some(e),300);case m.G.Type.opened:case m.G.Type.unhovered:case m.G.Type.hovered:case m.G.Type.addedToDictionary:case m.G.Type.ignored:case m.G.Type.applied:case m.G.Type.confirmed:case m.G.Type.undone:case m.G.Type.mounted:case m.G.Type.looked:case m.G.Type.feedbackModalOpen:case m.G.Type.feedbackModalClose:case m.G.Type.feedbackModalSubmit:case m.G.Type.teaserExpand:return x.of(H.some(e));default:return(0,V.xb)(t)}}))))),N.F(H.getEq(h.HJ.ordId).equals),T.T(this._toMarkAndAlert),R.u()),this._log=G.Bx.Logging.getLogger("InlineCardViewModelImpl",Q.$.DEBUG),this._sendFeedback=(e,t)=>(0,l.pipe)(this._alertsService.applyFeedback(e,t,h.Kz.text),$.mapLeft((e=>(this._log.error("error sending feedback",e),e)))),this._subs.push(this._listenAlertOpenings(),this._listenAlertIgnores(),this._listenAlertAddedToDictionary(),this._listenAlertApplies(),this._listenCardLooks(),this._listenFeedbackModalStateChanges(),this._listenUserFeedbackSubmissions(),this._listenTeaserExpands(),this._listenAlertClose())}}!function(e){var t=e.DATA_NAME="inline-card";e.isInlineCard=e=>!!e&&e.getAttribute("data-name")===t}(s||(s={}))},93959:(e,t,i)=>{i.d(t,{C:()=>w,H:()=>s});var s,n=i(23988),r=i(10334),a=i(17171),o=i(30040),l=i(80074),c=i(41949),d=i(68594),h=i(6987),p=i(36094),u=i(15491),m=i(14342),g=i(89769),_=i(46669),f=i(95168),y=i(38427),v=i(44297),b=i(86562),S=i(36840),k=i(33373),C=i(60083);!function(e){e[e.Checking=0]="Checking",e[e.CheckingOut=1]="CheckingOut",e[e.Idle=2]="Idle"}(s||(s={}));class w{init(){this._isLocked.set(!1)}_listenUploadingState(){return this._uploadVM.state.pipe(d.i(1)).subscribe((e=>{this._state.set(e===k.U.State.idle?C.x.State.idle:C.x.State.loading)}))}_listenProcessingState(){return this._ded.dontFreezeWhen(this._state.view((({text:e})=>v.isSome(e))),"loader")}_listenFullRecheckingState(){const e=(0,o.flow)(v.filter((e=>e===C.x.Type.checkingIn||e===C.x.Type.checking)),v.map((()=>C.x.Type.checkingOut))),t=e=>e.kind===c.kr.CheckingKind.Plagiarism||"full"!==e.type;return(e=>this._loadingStateLock.pipe(h.n(p.$x(e))))(this._lensCheckingData).pipe(h.n((([e,i])=>{const n=e.get();return e.pipe(d.i(1),u.T((e=>t(e)||!i?s.Idle:s.Checking)),m.c(200),g.Z(t(n)?s.Idle:i?s.Checking:s.CheckingOut))})),_.F(),f.M((e=>this.loaderState.set(v.some(e))))).subscribe((t=>{switch(t){case s.Idle:return this._state.set(C.x.State.idle);case s.Checking:return this._state.modify((e=>(0,a._)((0,r._)({},e),{text:v.none})));case s.CheckingOut:return this._state.modify((t=>(0,a._)((0,r._)({},t),{text:v.none,navigation:e(t.navigation)})));default:(0,b.xb)(t)}}))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}constructor(e,t,i,s,r){(0,n._)(this,"_state",void 0),(0,n._)(this,"_uploadVM",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"loaderState",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_isLocked",void 0),(0,n._)(this,"_loadingStateLock",void 0),(0,n._)(this,"_lensCheckingData",void 0),this._state=e,this._uploadVM=s,this._ded=r,this.loaderState=l.s.create(v.none),this._subs=[],this._isLocked=l.s.create(!0),this._loadingStateLock=y.zV([this._isLocked,this._uploadVM.state.pipe(g.Z(k.U.State.idle))],((e,t)=>e||t!==k.U.State.idle)).pipe(_.F()),this._lensCheckingData=l.s.combine(t.activeLensId.view(i.getCheckingForState),t.state.view("isSidebarOpen"),o.tuple),this._subs.push(this._listenUploadingState(),this._listenProcessingState(),this._listenFullRecheckingState()),(0,S.hJ)("loader",((e,t,i)=>{this._state.set({text:(0,o.pipe)(v.fromNullable(e),v.filter((e=>e in C.x.TextType))),lens:(0,o.pipe)(v.fromNullable(t),v.filter((e=>e in C.x.Type))),navigation:(0,o.pipe)(v.fromNullable(i),v.filter((e=>e in C.x.Type)))})}))}}},26730:(e,t,i)=>{i.d(t,{ID:()=>Q});var s=i(10334),n=i(17171),r=i(24497),a=i(11864),o=i(29120),l=i(36840),c=i(27199);const d=c.Q1.CoreGreen10,h="2px",p="1px",u="alerts-",m=r.NeutralGray10;var g;!function(e){e.markHeightStandard=`${u}markHeightStandard`,e.markHeightTall=`${u}markHeightTall`,e.markSelected=`${u}markSelected`,e.markSelectedFocused=`${u}markSelectedFocused`,e.markBase=`${u}markBase`,e.markAppliedBase=`${u}markAppliedBase`,e.markVisible=`${u}markVisible`,e.markStart=`${u}markStart`,e.correctness=`${u}correctness`,e.premium=`${u}premium`,e.clarity=`${u}clarity`,e.engagement=`${u}engagement`,e.delivery=`${u}delivery`,e.critical=`${u}critical`,e.advanced=`${u}advanced`,e.plagiarism=`${u}plagiarism`,e.originality=`${u}originality`,e.vox=`${u}vox`,e.knowledgeHub=`${u}knowledgeHub`,e.synonym=`${u}synonym`,e.markAnimated=`${u}markAnimated`,e.markHidden=`${u}markHidden`,e.markApplied=`${u}markApplied`,e.markBulkApplied=`${u}markBulkApplied`,e.markBulkAppliedAnimation=`${u}markBulkAppliedAnimation`,e.markSuccess=`${u}markSuccess`,e.noAnimation=`${u}noAnimation`,e.markVBar=`${u}markVBar`,e.markVBarHighlighted=`${u}markVBarHighlighted`,e.markWritingExpert=`${u}markWritingExpert`,e.markWritingExpertHighlighted=`${u}markWritingExpertHighlighted`}(g||(g={}));const _=`${u}custom`,f={backgroundPosition:`center calc(100% + ${h})`,backgroundRepeat:"no-repeat",contain:"layout style",$nest:{"@media print":{borderBottomWidth:"0 !important"}}},y={$nest:{"@media print":{borderBottomWidth:"3 !important"}}},v=a.Ks.keyframes({from:{backgroundSize:"100% 0"},to:{backgroundSize:"100% 12%"}}),b={standard:`calc(${a.Ks.rem(.45)} - 3px)`,tall:`calc(${a.Ks.rem(.425)} + 1px)`},S=e=>({to:{backgroundColor:e}}),k=(e,t,i,r)=>(0,n._)((0,s._)({$unique:!0},f),{paddingBottom:p,borderBottom:`${h} solid ${t}`,transition:"border-bottom-color .5s linear",$nest:(0,n._)((0,s._)({},f.$nest),{"&[data-vertical-underline-start]:before":{borderColor:i,color:i},"& > [data-vertical-underline-body]:after":{borderColor:i},"& > [data-vertical-underline-index]":{color:i},"&[data-superscript]":{padding:0,border:"none",color:i,transition:"none"},"&:not([data-superscript])":{$nest:{[`&.${g.markSelected}.${g.markHeightStandard}`]:{paddingTop:b.standard},[`&.${g.markSelected}.${g.markHeightTall}`]:{paddingTop:b.tall},[`&.${g.markSelected}`]:{$unique:!0,borderBottomColor:r,animation:`${e} 1s ease forwards`},[`&.${g.markSelectedFocused}`]:{$unique:!0,borderBottomColor:i},[`&.${g.markSelected} .${g.markBase}:not(.${g.markSelected}):not(.${g.markWritingExpert})`]:{paddingBottom:`calc(${h} + ${p})`,borderBottomStyle:"hidden"},[`&.${g.markSelectedFocused} .${g.markBase}:not(.${g.markSelected}):not(.${g.markWritingExpert})`]:{paddingBottom:`calc(${h} + ${p})`,borderBottomStyle:"hidden"}}}})}),C=a.Ks.keyframes(S(c.Q1.CoreRed10)),w=a.Ks.keyframes(S(c.Q1.CoreYellow10)),E=a.Ks.keyframes(S(c.Q1.CoreCyan10)),x=a.Ks.keyframes(S(c.Q1.CorePurple10)),M=a.Ks.keyframes(S(c.Q1.CoreNeutral10)),T=a.Ks.keyframes(S(c.Q1.CoreBlue10)),A=a.Ks.keyframes(S(c.Q1.CoreRed10)),I=a.Ks.keyframes(S(c.Q1.CoreYellow10)),B=a.Ks.keyframes(S(c.Q1.CoreBlue10)),P=a.Ks.keyframes(S(c.Q1.CoreGreen10)),F=a.Ks.keyframes(S(c.Q1.CorePurple10)),N=a.Ks.keyframes(S(c.Q1.CoreGreen10)),R=a.Ks.keyframes(S(m)),L=e=>{const t=a.Ks.color(d).fade(e).toRGBA().toString();return{borderBottomColor:t,backgroundColor:t,$nest:{[`&.${g.markHeightStandard}`]:{paddingTop:b.standard},[`&.${g.markHeightTall}`]:{paddingTop:b.tall}}}},D=e=>({borderBottomColor:"transparent",backgroundColor:a.Ks.color(d).fade(e).toRGBA().toString()}),O=a.Ks.keyframes({from:L("100%"),to:L("50%")}),H={borderBottomWidth:"2px",borderBottomColor:`${c.Q1.CoreNeutral40}`,borderBottomStyle:"dotted",backgroundColor:"transparent"},K=a.Ks.keyframes({to:(0,s._)({},L("0%"),H)}),$=a.Ks.keyframes({from:D("100%"),to:D("50%")}),V={$nest:{[`&.${g.markHeightStandard}`]:{paddingTop:b.standard},[`&.${g.markHeightTall}`]:{paddingTop:b.tall},[`&:not(.${g.markSelected}):not(.${g.markSelectedFocused})`]:{$nest:{[`&.${g.clarity} &.${g.clarity}`]:{borderBottomStyle:"solid",borderBottomColor:c.Q1.CoreBlue50}}},[`&.${g.correctness}, &.${g.markSelected}, &.${g.markSelectedFocused}`]:{$nest:{[`.${g.markVisible}:not(.${g.markSelected}):not(.${g.markSelectedFocused}).${g.clarity} .${g.markVisible}:not(.${g.markSelected}):not(.${g.markSelectedFocused}).${g.clarity}`]:{}}},[`&.${g.clarity}`]:{$nest:{[`& & &:not(.${g.markSelected}):not(.${g.markSelectedFocused})`]:{borderBottomStyle:"hidden !important"}}}}},U={borderBottom:"0 solid transparent !important",background:"none",animation:"none"},G={position:"relative",$nest:{[`& > .${g.markVisible}:not(.${g.markSelected}):not(.${g.markSelectedFocused})`]:{borderBottomStyle:a.Ks.important("hidden")},[`&.${g.markHeightTall}`]:{paddingTop:b.tall},"&:after":{content:'"  "',position:"absolute",height:0,bottom:a.Ks.rem(-.15),right:a.Ks.rem(-.875),width:a.Ks.rem(.75),borderBottom:`${a.Ks.rem(.175)} dotted ${r.Green60}`}}},Q=(0,l.Bj)((()=>({custom(e,t){const i=a.Ks.color(e).fade(.25).toRGBA().toString(),s=a.Ks.keyframes(S(i));return[_,g.markBase,a.Ks.style(k(s,t,t,i)),o.b.style(k(s,t,t,i),y)].join(" ")},markWritingExpert:[g.markWritingExpert,g.markBase,a.Ks.style(k(R,r.Green60,r.Green60,r.BlueGray5),G),o.b.style(k(R,r.Green60,r.Green60,r.Green10),G,y)].join(" "),markWritingExpertHighlighted:[g.markWritingExpertHighlighted,a.Ks.style(k(R,"transparent","transparent",m))].join(" "),markVBar:g.markVBar,markBase:[g.markBase,a.Ks.style(f),o.b.style(f,{$nest:{"@media print":{borderBottomWidth:"3 !important"}}})].join(" "),markAppliedBase:[g.markAppliedBase,g.markBase,a.Ks.style({paddingBottom:`${p}`,borderBottom:`${h} solid ${d}`})].join(" "),correctness:[g.correctness,g.markBase,a.Ks.style(k(A,c.Q1.CoreRed50,c.Q1.CoreRed50,c.Q1.CoreRed10)),o.b.style(k(A,c.Q1.CoreRed50,c.Q1.CoreRed50,c.Q1.CoreRed10),y)].join(" "),premium:[g.premium,g.markBase,a.Ks.style(k(I,c.Q1.CoreYellow40,c.Q1.CoreYellow40,c.Q1.CoreYellow10)),o.b.style(k(I,c.Q1.CoreYellow40,c.Q1.CoreYellow40,c.Q1.CoreYellow10),y)].join(" "),clarity:[g.clarity,g.markBase,a.Ks.style(k(B,c.Q1.CoreBlue50,c.Q1.CoreBlue50,c.Q1.CoreBlue10)),o.b.style(k(B,c.Q1.CoreBlue50,c.Q1.CoreBlue50,c.Q1.CoreBlue10),y)].join(" "),markVisible:[g.markVisible,a.Ks.style(V),o.b.style(V)].join(" "),engagement:[g.engagement,g.markBase,a.Ks.style(k(P,c.Q1.CoreGreen50,c.Q1.CoreGreen50,c.Q1.CoreGreen10)),o.b.style(k(P,c.Q1.CoreGreen50,c.Q1.CoreGreen50,c.Q1.CoreGreen10),y)].join(" "),delivery:[g.delivery,g.markBase,a.Ks.style(k(F,c.Q1.CorePurple50,c.Q1.CorePurple50,c.Q1.CorePurple10)),o.b.style(k(F,c.Q1.CorePurple50,c.Q1.CorePurple50,c.Q1.CorePurple10),y)].join(" "),critical:[g.critical,g.markBase,a.Ks.style(k(C,c.Q1.CoreRed50,c.Q1.CoreRed50,c.Q1.CoreRed10)),o.b.style(k(C,c.Q1.CoreRed50,c.Q1.CoreRed50,c.Q1.CoreRed10),y)].join(" "),advanced:[g.advanced,g.markBase,a.Ks.style(k(w,c.Q1.CoreYellow40,c.Q1.CoreYellow40,c.Q1.CoreYellow10)),o.b.style(k(w,c.Q1.CoreYellow40,c.Q1.CoreYellow40,c.Q1.CoreYellow10),y)].join(" "),plagiarism:[g.plagiarism,g.markBase,a.Ks.style(k(E,c.Q1.CoreCyan50,c.Q1.CoreCyan50,c.Q1.CoreCyan10)),o.b.style(k(w,c.Q1.CoreCyan50,c.Q1.CoreCyan50,c.Q1.CoreCyan10),y)].join(" "),originality:[g.originality,g.markBase,a.Ks.style(k(x,c.Q1.CorePurple50,c.Q1.CorePurple50,c.Q1.CorePurple10)),o.b.style(k(F,c.Q1.CorePurple50,c.Q1.CorePurple50,c.Q1.CorePurple10),y)].join(" "),vox:[g.vox,g.markBase,a.Ks.style(k(M,c.Q1.CoreNeutral50,c.Q1.CoreNeutral50,c.Q1.CoreNeutral10)),o.b.style(k(M,c.Q1.CoreNeutral50,c.Q1.CoreNeutral50,c.Q1.CoreNeutral10),y)].join(" "),knowledgeHub:[g.knowledgeHub,g.markBase,a.Ks.style(k(M,c.Q1.CoreNeutral50,c.Q1.CoreNeutral50,c.Q1.CoreNeutral10)),o.b.style(k(M,c.Q1.CoreNeutral50,c.Q1.CoreNeutral50,c.Q1.CoreNeutral10),y)].join(" "),synonym:[g.synonym,g.markBase,a.Ks.style(k(T,c.Q1.CoreBlue50,"transparent",c.Q1.CoreBlue50)),o.b.style(k(T,c.Q1.CoreBlue50,"transparent",c.Q1.CoreBlue50),y)].join(" "),markAnimated:[g.markAnimated,a.Ks.style({animation:`${v} .075s ease`})].join(" "),markHidden:[g.markHidden,a.Ks.style(U),o.b.style(U)].join(" "),markBulkAppliedAnimation:[g.markBulkAppliedAnimation,g.markBase,a.Ks.style(L("100%"),H,{animation:`${O} 2s linear forwards,\n          ${K} .25s linear 2s forwards`})].join(" "),markBulkApplied:[g.markBulkApplied,g.markBase,a.Ks.style(k(N,c.Q1.CoreNeutral40,c.Q1.CoreGreen10,c.Q1.CoreGreen10),H)].join(" "),markApplied:[g.markApplied,a.Ks.style(L("100%"),{animation:`${O} .25s linear forwards`})].join(" "),markSuccess:[g.markSuccess,a.Ks.style(D("100%"),{animation:`${$} .25s linear forwards`})].join(" "),noAnimation:[g.noAnimation,a.Ks.style({animationDuration:"0s !important"})].join(" "),markVBarHighlighted:[g.markVBarHighlighted,a.Ks.style({backgroundColor:"#DEF7F5",borderBottom:"solid 5px #DEF7F5",borderTop:"solid 5px #DEF7F5"})].join(" "),markSelected:g.markSelected,markSelectedFocused:g.markSelectedFocused,markHeightStandard:g.markHeightStandard,markHeightTall:g.markHeightTall,markStart:g.markStart})))},63849:(e,t,i)=>{i.d(t,{t:()=>Y});var s,n=i(23988),r=i(10334),a=i(10047),o=i(80755),l=i(30040),c=i(63336),d=i(80074),h=i(66799),p=i(72106),u=i(55340),m=i(43585),g=i(63967),_=i(62597),f=i(889),y=i(22809),v=i(21216),b=i(15491),S=i(3346),k=i(36094),C=i(90405),w=i(21662),E=i(68594),x=i(60269),M=i(95168),T=i(64231),A=i(80837),I=i(65621),B=i(78339),P=i(42543),F=i(83541),N=i(62822),R=i(19711),L=i(30295),D=i(38666),O=i(45653),H=i(78884),K=i(79365),$=i(93584),V=i(44297),U=i(58889),G=i(58193),Q=i(22835),W=i(59042),q=i(36840),z=i(69063),j=i(12486),J=i(19178);!function(e){e.create=(e,t,i,s,n)=>(r,a)=>{const o=i("MarkActionFactory.create");return p.J.Change.getCreateAction({classes:t({state:a.to.visualState,isBulkApplied:g.Fc.State.isBulkApplied(o.state),range:r,isAnimated:!a.to.updateRanges&&(0,L.NM)(a),isEnclosed:s,isVBar:O.A.isVBar(o),isWritingExpert:O.A.isWritingExpertWithTeaser(o),isHidden:n&&O.A.isPremiumPreviewPlagiarism(o)}),range:r,order:e({range:r})})},e.update=(e,t,i,s,n)=>(r,a)=>{const o=i("MarkActionFactory.update");return p.J.Change.getUpdateAction({classes:t({state:a.to.visualState,isBulkApplied:g.Fc.State.isBulkApplied(o.state),range:r,isAnimated:!a.to.updateRanges&&(0,L.NM)(a),isEnclosed:s,isVBar:O.A.isVBar(o),isWritingExpert:O.A.isWritingExpertWithTeaser(o),isHidden:n&&O.A.isPremiumPreviewPlagiarism(o)}),range:r,order:e({range:r})})},e.remove=e=>p.J.Change.getRemoveAction({range:e},p.J.Change.RemoveType.partial)}(s||(s={}));class Y{dispose(){this._subs.dispose()}flush(){const e=(new Date).getTime();return this._alertList.flushAlerts(),this._marksRenderer.flush().finally((()=>{const t=(new Date).getTime()-e;this._log.info("Flush performed",{duration:t})}))}focusAlertHighlight(e){return(0,c.pipe)(this._getMarkAlert(e.alert),V.fold((()=>U.left(new Error("Cannot focus given alert"))),(t=>(L.yl.canBeChanged()(t.markAlert)&&(g.Fc.isSuperAlert(t.alert)&&t.markAlert.scheduleForceUpdate(),t.markAlert.scheduleApply(L.zQ.highlighted),this._marksRenderer.enqueue([t.markAlert],K.m.Priority.asap)),U.right({dispose:()=>this._unfocusAlertHighlight(e)})))))}_unfocusAlertHighlight(e){(0,c.pipe)(e.alert,V.some,V.filter((e=>!(0,c.pipe)(this._highlightedAlertId,V.exists((t=>t===e.id))))),V.chain(this._getMarkAlert),V.filter((e=>!L.yl.isOrWillBe(L.zQ.hidden)(e.markAlert)&&L.yl.canBeChanged()(e.markAlert))),V.map((e=>{L.yl.isOrWillBe(L.zQ.success)(e.markAlert)?(this._handleRemovedAlerts([e.alert]),this._marksRenderer.enqueue([e.markAlert],K.m.Priority.asap)):this._marksRenderer.enqueue([e.markAlert.scheduleApply(L.zQ.visible)],K.m.Priority.asap)})))}moveCursorToHighlight(e,t){return(0,c.pipe)(this._getMarkAlert(e.alert),V.chain((t=>t.markAlert.markByIndex(e.highlightIndex))),V.chain((e=>V.fromEither(e.range()))),V.fold((()=>U.left(new Error("Cannot find mark for given range"))),(e=>{const{index:i,length:s}=this._ded.getCursor();if(0===s&&(i<e.start||i>e.end)){const i=Math.min(e[t],this._ded.getLastPossibleCursorPosition());return(0,c.pipe)(this._ded.setCursor(i,0),U.orElse((e=>(this._log.error("Failed to set cursor to highlight",e,i),U.left(e)))))}return U.right(void 0)})))}ensureAlertHighlightInViewport(e,t,i){return(0,c.pipe)(this._getVisibleMarkAlert(e.alert),V.map((e=>e.markAlert)),V.chain((t=>t.markByIndex(e.highlightIndex))),V.fold((()=>v.of(U.left(new Error("Cannot ensureAlertHighlightInViewport, because mark is None")))),(e=>this._ded.scrollToMark(e.id,{animate:i,paddingTop:t}).pipe(b.T(U.right),S.W((e=>v.of(U.left(e))))))))}_listenFilterChange(){return(0,c.pipe)(this._filterChanges,b.T(V.some)).subscribe(k.H9(this._filterKit))}getFirstMark(){return this._alertList.state.pipe(b.T(y.A.find((e=>g.Fc.isCritical(e.alert)))),C.Kc((e=>v.of((0,c.pipe)(this._getMarkAlert(e.alert),V.chain((e=>e.markAlert.mark)))))))}_listenFilteredAlerts(){return this._filterKit.pipe(w.E(this._alertList.state),b.T((([e,t])=>{const i=(0,c.pipe)(e,V.map((e=>e.filter)));return(0,c.pipe)(t,y.A.reduce({},((e,t)=>((0,c.pipe)(i,V.map((e=>e(t.alert))),V.getOrElse(l.constTrue))&&g.Fc.isRegistered(t.alert)&&(e[t.alert.id]=t.alert),e))),(e=>V.some({filter:i,alerts:e})))}))).subscribe(k.H9(this._filteredAlerts))}_schedule(e,t){a.J_(e)&&(this._log.trace(`Schedule alerts ${e.map((e=>e.alert.id))} to ${t}`),this._marksRenderer.enqueue(e.map((e=>e.scheduleApply(t))),K.m.Priority.low))}_handleRemovedAlerts(e){(0,c.pipe)(e,a.x1((({id:e})=>(0,c.pipe)(this._marksMap.get(e),V.fromNullable,G.Mi((()=>this._marksMap.delete(e)))))),o.ci,G.Mi((e=>this._schedule(e,L.zQ.disposed))))}_handleUpdatedAlerts(e){if(!e.length)return;const t=(0,c.pipe)(this._filteredAlerts.get(),V.chain((e=>e.filter))),{activeToHandle:i,removedToHandle:s}=e.reduce(((e,i)=>(this._alertsFilterService.alertCanBeDisplayed(i)||g.Fc.isBulkApplied(i)?(0,c.pipe)(V.fromNullable(this._marksMap.get(i.id)),V.fold((()=>{(0,c.pipe)(t,V.map((e=>e(i))),V.getOrElse((()=>!0)))&&e.activeToHandle.push(i)}),(e=>{g.Fc.isLockedUIUphook(i)?e.scheduleForceUpdate():e.scheduleUpdate(),L.yl.isOrWillBe(L.zQ.success)(e)?e.scheduleApply(L.zQ.highlighted):this._marksRenderer.enqueue([e],K.m.Priority.asap)}))):(0,c.pipe)(V.fromNullable(this._marksMap.get(i.id)),V.map((t=>{i.allowUpdate&&g.Fc.isCapiDone(i)&&g.Fc.isRated(i)&&L.yl.isOrWillBe(L.zQ.highlighted)(t)?(t.scheduleUpdate(),t.scheduleApply(L.zQ.success),this._marksRenderer.enqueue([t],K.m.Priority.asap)):e.removedToHandle.push(i)}))),e)),{activeToHandle:[],removedToHandle:[]});this._handleVisibleAlerts(i),this._handleRemovedAlerts(s)}_handleVisibleAlerts(e){if(a.Im(e))return;const t=e.map((e=>{if(this._marksMap.has(e.id))return this._marksMap.get(e.id);{const t=g.Fc.isSuperAlert(e)?m.OT.byAhr(this._activeAlertChanges.view((0,l.flow)(V.filter((t=>t.alert.id===e.id)),V.chain((t=>(0,c.pipe)(V.fromNullable(e.getHighlightRanges()[t.highlightIndex]),G.jw((()=>this._log.error("Alert highlight ranges do not contain a range at the given AHI",{knownHighlightRangesCount:e.getHighlightRanges().length,highlightIndex:t.highlightIndex}))))))))):m.OT.byRangeType(e),i=i=>(0,m.pY)({getMarkType:t,theme:m.rh.fromAlert(e,this._useHighHighlights,(0,J.o)(this._suggestionsVisualMode.get()),this._showNativeColorsForHiddenAlerts)})(i),n=t=>(0,c.pipe)(this._alertsReader.getById(e.id),V.alt((()=>(Boolean(t)&&this._log.warn("Could not find alert for provided MarkAlert",{alert:e,source:t}),V.some(e)))),V.map(O.A.fromModel),G.$v),r=({range:t})=>{const i=_.J.getSortOrder(e.lensType);return f.l.isEnclosingView(t())?i+1:i},a=g.Fc.hasEnclosingHighlight(e),o=new D.s(n,this._alertsService,this._alertRangeService,this.changeMarks,s.create(r,i,n,a,this._isFreeUser.get()),s.update(r,i,n,a,this._isFreeUser.get()),s.remove,this._onTransitionEnd(e));return this._marksMap.set(e.id,o),o}})).filter((e=>L.yl.isOneOf(L.zQ.initial)(e)||L.yl.isOrWillBe(L.zQ.hidden)(e)||L.yl.isOrWillBe(L.zQ.visible)(e)||L.yl.isOrWillBe(L.zQ.faded)(e)));this._applyRenderedFeedbackForWritingExpert(t),this._schedule(t,L.zQ.visible)}_handleAcceptedAlerts(e){return(0,c.pipe)(e,a.Tj(this._getMarkAlert),a.oE,(e=>{e.length&&this._marksRenderer.enqueue(e.map((e=>e.markAlert.scheduleApply(L.zQ.applied))),K.m.Priority.immediately)}))}_rerenderAllMarksOnUnderlineModeChange(){return this._suggestionsVisualMode.pipe(E.i(1)).subscribe((()=>{const e=Array.from(this._marksMap.values());e.forEach((e=>e.scheduleForceUpdate())),this._marksRenderer.enqueue(e.map((e=>(e.scheduleForceUpdate(),e))),K.m.Priority.low)}))}_listenMarksState(){const e=e=>(0,r._)({activeAlerts:[],updatedAlerts:[],removedAlerts:[],acceptedAlerts:[],hiddenMarkAlerts:[]},e);return x.h(this._filteredAlerts.pipe(C.Kc((({alerts:t})=>v.of(e({hiddenMarkAlerts:Array.from(this._marksMap.values()).filter((e=>void 0===t[e.alert.id]&&L.yl.notAnyOf(L.zQ.applied,L.zQ.success)(e)&&!g.Fc.State.isBulkApplied(e.alert.state))),activeAlerts:Q.$r(t)}))))),this._alertStateDiff.pipe(w.E(this._filteredAlerts),b.T((([t,i])=>(0,c.pipe)(t,W.b.reduce(e({}),((e,t)=>(this._marksMap.has(t.alert.id)&&e.removedAlerts.push(t.alert),e)),((e,t)=>(g.Fc.isAccepted(t.alert)?e.acceptedAlerts.push(t.alert):e.updatedAlerts.push(t.alert),e)),((e,t)=>((0,c.pipe)(i,V.chain((e=>e.filter)),V.fold((()=>e.activeAlerts.push(t.alert)),(i=>i(t.alert)&&e.activeAlerts.push(t.alert)))),e)))))))).pipe(M.M((({activeAlerts:e,removedAlerts:t,updatedAlerts:i,acceptedAlerts:s,hiddenMarkAlerts:n})=>(this._handleRemovedAlerts(t),this._handleUpdatedAlerts(i),this._handleVisibleAlerts(e),this._handleAcceptedAlerts(s),this._schedule(n,L.zQ.hidden),()=>this._marksRenderer.dispose()))),S.W(this._log.handler("_listenMarksState exception").error),T.L()).subscribe()}constructor(e,t,i,s,r,o=!1,p,m,_,S,k,C,w){(0,n._)(this,"_ded",void 0),(0,n._)(this,"_alertList",void 0),(0,n._)(this,"_alertsReader",void 0),(0,n._)(this,"_alertsService",void 0),(0,n._)(this,"_alertRangeService",void 0),(0,n._)(this,"_useHighHighlights",void 0),(0,n._)(this,"_marksRenderer",void 0),(0,n._)(this,"_alertsFilterService",void 0),(0,n._)(this,"_filterChanges",void 0),(0,n._)(this,"_suggestionsVisualMode",void 0),(0,n._)(this,"_activeAlertChanges",void 0),(0,n._)(this,"_showNativeColorsForHiddenAlerts",void 0),(0,n._)(this,"_isFreeUser",void 0),(0,n._)(this,"_marksMap",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_filterKit",void 0),(0,n._)(this,"_filteredAlerts",void 0),(0,n._)(this,"_alertStateDiff",void 0),(0,n._)(this,"events",void 0),(0,n._)(this,"changeMarks",void 0),(0,n._)(this,"_getMarkAlert",void 0),(0,n._)(this,"_isAlertVisible",void 0),(0,n._)(this,"_getVisibleMarkAlert",void 0),(0,n._)(this,"getMarkByAlert",void 0),(0,n._)(this,"getEnclosingMarkByAlert",void 0),(0,n._)(this,"_isHighlightInteractable",void 0),(0,n._)(this,"getAlertByMark",void 0),(0,n._)(this,"_highlightedAlertId",void 0),(0,n._)(this,"highlightAlertHighlight",void 0),(0,n._)(this,"_unhighlightAlertHighlight",void 0),(0,n._)(this,"_memoizedWritingExpertRenderedFeedbackApply",void 0),(0,n._)(this,"_applyRenderedFeedbackForWritingExpert",void 0),(0,n._)(this,"_onTransitionEnd",void 0),this._ded=e,this._alertList=t,this._alertsReader=i,this._alertsService=s,this._alertRangeService=r,this._useHighHighlights=o,this._marksRenderer=p,this._alertsFilterService=m,this._filterChanges=_,this._suggestionsVisualMode=S,this._activeAlertChanges=k,this._showNativeColorsForHiddenAlerts=C,this._isFreeUser=w,this._marksMap=new Map,this._log=z.Bx.Logging.getLogger("MarksViewModelImpl",j.$.DEBUG),this._subs=new A.y.Keeper,this._filterKit=d.s.create(V.none),this._filteredAlerts=d.s.create(V.none),this._alertStateDiff=this._alertList.state.pipe(I.J(),b.T((([e,t])=>y.A.diff(e,t))),B.p((0,q.AU)(W.b.isEmpty))),this.events=new P.B7,this.changeMarks=e=>this._ded.changeMarks(e),this._getMarkAlert=({id:e})=>(0,c.pipe)(V.fromNullable(this._marksMap.get(e)),V.filter(L.yl.notAnyOf(L.zQ.disposed)),V.chain((e=>(0,c.pipe)(this._alertsReader.getById(e.alert.id),V.map((t=>({alert:t,markAlert:e}))))))),this._isAlertVisible=e=>(0,c.pipe)(this._filterKit.get(),V.filter((t=>t.filter(e))),V.isSome),this._getVisibleMarkAlert=({id:e})=>(0,c.pipe)(this._getMarkAlert({id:e}),V.filter((e=>this._isAlertVisible(e.alert)))),this.getMarkByAlert=e=>(0,c.pipe)(this._getVisibleMarkAlert(e.alert),V.chain((t=>t.markAlert.markByIndex(e.highlightIndex)))),this.getEnclosingMarkByAlert=e=>(0,c.pipe)(this._getVisibleMarkAlert(e),V.chain((e=>e.markAlert.enclosingMark))),this._isHighlightInteractable=e=>{const t=(0,c.pipe)(V.fromNullable(this._marksMap.get(e.alert.id)),V.fold((()=>!1),(e=>L.yl.isOrWillBe(L.zQ.highlighted)(e)))),i=O.A.isVBar(e.alert);return(!(0,c.pipe)(H.z.getHighlightRange(e),V.fold((()=>!1),f.l.isEnclosingView))||t)&&!i},this.getAlertByMark=e=>(0,c.pipe)(this._alertsReader.getInteractable(f.a.fromRangeIdToAlertId(e.id)),V.filter(this._isAlertVisible),V.chain((t=>(0,c.pipe)($.Bm.getHighlightIndex(t,e.range()),U.map((e=>({alert:O.A.fromModel(t),highlightIndex:e}))),V.fromEither))),V.filter(this._isHighlightInteractable)),this._highlightedAlertId=V.none,this.highlightAlertHighlight=e=>(0,c.pipe)(this._getMarkAlert(e),V.map((e=>e.markAlert)),V.filter(L.yl.canBeChanged()),V.fold((()=>U.left(new Error("Cannot highlight alert"))),(t=>((0,c.pipe)(this._highlightedAlertId,G.Mi((t=>{this._log.warn("Trying to highlight alert while previously highlighted alert is not unhighlighted",{highlighted:e.id,previous:t}),this._unhighlightAlertHighlight({id:t})}))),this._highlightedAlertId=V.some(e.id),t.scheduleApply(L.zQ.highlighted),this._marksRenderer.enqueue([t],K.m.Priority.asap),U.right({dispose:()=>this._unhighlightAlertHighlight(e)}))))),this._unhighlightAlertHighlight=e=>(0,c.pipe)(e,(e=>(V.exists((t=>t===e.id))(this._highlightedAlertId)||this._log.warn("Trying to unhighlight alert but nothing is highlighted",{alertId:e.id}),this._highlightedAlertId=V.none,e)),this._getMarkAlert,V.map((e=>e.markAlert)),V.filter((e=>L.yl.canBeChanged()(e)&&!L.yl.isOrWillBe(L.zQ.hidden)(e)&&!(0,c.pipe)(this._activeAlertChanges.get(),V.exists((t=>t.alert.id===e.alert.id))))),V.map((e=>this._marksRenderer.enqueue([e.scheduleApply(L.zQ.visible)],K.m.Priority.asap)))),this._memoizedWritingExpertRenderedFeedbackApply=(0,q.Bj)((e=>this._alertsService.applyFeedback(e,{kind:h.yp.RENDERED,subtype:h.U3.UnderlineWithTeaser},g.Kz.text))),this._applyRenderedFeedbackForWritingExpert=a.x1((0,l.flow)(Q.Up("alert"),V.fromPredicate(O.A.isWritingExpertWithTeaser),V.chain((e=>(0,c.pipe)(e.id,this._memoizedWritingExpertRenderedFeedbackApply,U.mapLeft((t=>this._log.error("Failed to apply RENDERED feedback",t,e))),V.fromEither))))),this._onTransitionEnd=e=>(t,i)=>{L.zQ.isApplied(t.to.visualState)&&requestAnimationFrame((()=>{(0,c.pipe)(i.mark,V.fold((()=>v.of(U.left(new Error("Cannot animate mark, as it not exists")))),(e=>(0,c.pipe)(x.h(x.h(F.timer(300).pipe(N.u(U.right((0,l.constVoid)()))),e.fromMarkEvent("animationend"),e.fromMarkEvent("animationcancel")).pipe(R.$()))))),(0,l.flow)(R.$(),b.T(U.fold((e=>(e instanceof u.C.CollapsedMarkError?this._log.debug("Cannot animate applied alert as it is collapsed",e):this._log.error("Cannot animate applied alert",e,{alertId:i.alert.id,currentState:i.state,alertInfo:{title:i.alert.title,patternName:i.alert.patternName}}),F.timer(150).pipe(b.T(l.constVoid)))),v.of))),(t=>{t.subscribe((()=>{L.yl.isOrWillBe(L.zQ.disposed)(i)?this._log.info("Alert disposed before apply animation finished"):(this.events.next({type:$.sL.Type.AppliedAlertAnimationFinished,alert:e}),g.Fc.isBulkApplied(e)||this._handleRemovedAlerts([e]))}))}))}))},this._subs.push(this._listenMarksState(),this._listenFilterChange(),this._listenFilteredAlerts(),this._rerenderAllMarksOnUnderlineModeChange()),(0,q.hJ)("marksManager",this)}}!function(e){e.Mock=class{getFirstMark(){throw new Error("Method not implemented.")}flush(){return Promise.resolve()}ensureAlertHighlightInViewport(){throw new Error("Method not implemented.")}getEnclosingMarkByAlert(e){throw new Error("Method not implemented.")}getMarkByAlert(e){throw new Error("Method not implemented.")}getAlertByMark(e){throw new Error("Method not implemented.")}constructor(){(0,n._)(this,"events",new P.B7),(0,n._)(this,"dispose",l.constVoid),(0,n._)(this,"focusAlertHighlight",(()=>U.left(new Error("Method not implemented.")))),(0,n._)(this,"highlightAlertHighlight",(()=>U.left(new Error("Method not implemented.")))),(0,n._)(this,"moveCursorToHighlight",(()=>U.left(new Error("Method not implemented."))))}}}(Y||(Y={}))},19178:(e,t,i)=>{i.d(t,{o:()=>Y});var s=i(37107),n=i(26730),r=i(10334),a=i(17171),o=i(24497),l=i(11864),c=i(29120),d=i(36840),h=i(27199);const p=h.Q1.CoreGreen10,u="2px",m="1px",g="alerts1-",_=o.NeutralGray10;var f;!function(e){e.markHeightStandard=`${g}markHeightStandard`,e.markHeightTall=`${g}markHeightTall`,e.markSelected=`${g}markSelected`,e.markSelectedFocused=`${g}markSelectedFocused`,e.markBase=`${g}markBase`,e.markAppliedBase=`${g}markAppliedBase`,e.markVisible=`${g}markVisible`,e.markStart=`${g}markStart`,e.correctness=`${g}correctness`,e.premium=`${g}premium`,e.clarity=`${g}clarity`,e.engagement=`${g}engagement`,e.delivery=`${g}delivery`,e.critical=`${g}critical`,e.advanced=`${g}advanced`,e.plagiarism=`${g}plagiarism`,e.originality=`${g}originality`,e.vox=`${g}vox`,e.knowledgeHub=`${g}knowledgeHub`,e.synonym=`${g}synonym`,e.markAnimated=`${g}markAnimated`,e.markHidden=`${g}markHidden`,e.markApplied=`${g}markApplied`,e.markBulkApplied=`${g}markBulkApplied`,e.markBulkAppliedAnimation=`${g}markBulkAppliedAnimation`,e.markSuccess=`${g}markSuccess`,e.noAnimation=`${g}noAnimation`,e.markVBar=`${g}markVBar`,e.markVBarHighlighted=`${g}markVBarHighlighted`,e.markWritingExpert=`${g}writingExpert`,e.markWritingExpertHighlighted=`${g}markWritingExpertHighlighted`}(f||(f={}));const y=`${g}custom`,v={backgroundPosition:`center calc(100% + ${u})`,backgroundRepeat:"no-repeat",contain:"layout style",$nest:{"@media print":{borderBottomWidth:"0 !important"}}},b={$nest:{"@media print":{borderBottomWidth:"3 !important"}}},S=l.Ks.keyframes({from:{backgroundSize:"100% 0"},to:{backgroundSize:"100% 12%"}}),k={standard:`calc(${l.Ks.rem(.45)} - 3px)`,tall:`calc(${l.Ks.rem(.425)} + 1px)`},C=e=>({to:{backgroundColor:e}}),w=(e,t,i,s,n)=>(0,a._)((0,r._)({$unique:!0},v),{paddingBottom:m,borderBottom:`${u} ${n} ${t}`,transition:"border-bottom-color .5s linear",$nest:(0,a._)((0,r._)({},v.$nest),{"&[data-vertical-underline-start]:before":{borderColor:i,color:i},"& > [data-vertical-underline-body]:after":{borderColor:i},"& > [data-vertical-underline-index]":{color:i},"&[data-superscript]":{padding:0,border:"none",color:i,transition:"none"},"&:not([data-superscript])":{$nest:{[`&.${f.markSelected}.${f.markHeightStandard}`]:{paddingTop:k.standard},[`&.${f.markSelected}.${f.markHeightTall}`]:{paddingTop:k.tall},[`&.${f.markSelected}`]:{$unique:!0,borderBottomColor:s,animation:`${e} 1s ease forwards`},[`&.${f.markSelectedFocused}`]:{$unique:!0,borderBottomColor:i},[`&.${f.markSelected} .${f.markBase}:not(.${f.markSelected}):not(.${f.markWritingExpert})`]:{paddingBottom:`calc(${u} + ${m})`,borderBottomStyle:"hidden"},[`&.${f.markSelectedFocused} .${f.markBase}:not(.${f.markSelected}):not(.${f.markWritingExpert})`]:{paddingBottom:`calc(${u} + ${m})`,borderBottomStyle:"hidden"}}}})}),E=l.Ks.keyframes(C(h.Q1.CoreRed10)),x=l.Ks.keyframes(C(h.Q1.CoreYellow10)),M=l.Ks.keyframes(C(h.Q1.CoreCyan10)),T=l.Ks.keyframes(C(h.Q1.CorePurple10)),A=l.Ks.keyframes(C(h.Q1.CoreNeutral10)),I=l.Ks.keyframes(C(h.Q1.CoreNeutral10)),B=l.Ks.keyframes(C(h.Q1.CoreBlue10)),P=l.Ks.keyframes(C(h.Q1.CoreRed10)),F=l.Ks.keyframes(C(h.Q1.CoreYellow10)),N=l.Ks.keyframes(C(h.Q1.CoreBlue10)),R=l.Ks.keyframes(C(h.Q1.CoreGreen10)),L=l.Ks.keyframes(C(h.Q1.CorePurple10)),D=l.Ks.keyframes(C(h.Q1.CoreGreen10)),O=l.Ks.keyframes(C(_)),H=e=>{const t=l.Ks.color(p).fade(e).toRGBA().toString();return{borderBottomColor:t,backgroundColor:t,$nest:{[`&.${f.markHeightStandard}`]:{paddingTop:k.standard},[`&.${f.markHeightTall}`]:{paddingTop:k.tall}}}},K=e=>({borderBottomColor:"transparent",backgroundColor:l.Ks.color(p).fade(e).toRGBA().toString()}),$=l.Ks.keyframes({from:H("100%"),to:H("50%")}),V={borderBottomWidth:"2px",borderBottomColor:`${h.Q1.CoreNeutral40}`,borderBottomStyle:"dotted",backgroundColor:"transparent"},U=l.Ks.keyframes({to:(0,r._)({},H("0%"),V)}),G=l.Ks.keyframes({from:K("100%"),to:K("50%")}),Q={$nest:{[`&.${f.markHeightStandard}`]:{paddingTop:k.standard},[`&.${f.markHeightTall}`]:{paddingTop:k.tall},[`&:not(.${f.markSelected}):not(.${f.markSelectedFocused})`]:{$nest:{[`&.${f.clarity} &.${f.clarity}`]:{borderBottomStyle:"solid",borderBottomColor:h.Q1.CoreBlue50}}},[`&.${f.correctness}, &.${f.markSelected}, &.${f.markSelectedFocused}`]:{$nest:{[`.${f.markVisible}:not(.${f.markSelected}):not(.${f.markSelectedFocused}).${f.clarity} .${f.markVisible}:not(.${f.markSelected}):not(.${f.markSelectedFocused}).${f.clarity}`]:{}}},[`&.${f.clarity}`]:{$nest:{[`& & &:not(.${f.markSelected}):not(.${f.markSelectedFocused})`]:{borderBottomStyle:"hidden !important"}}}}},W={borderBottom:"0 solid transparent !important",background:"none",animation:"none"},q={position:"relative",$nest:{[`& > .${f.markVisible}:not(.${f.markSelected}):not(.${f.markSelectedFocused})`]:{borderBottomStyle:l.Ks.important("hidden")},"&:after":{content:'"  "',position:"absolute",height:0,bottom:l.Ks.rem(-.15),right:l.Ks.rem(-.875),width:l.Ks.rem(.75),borderBottom:`${l.Ks.rem(.175)} dotted ${o.Green60}`}}},z="solid",j="dashed",J=(0,d.Bj)((()=>({custom(e,t){const i=l.Ks.color(e).fade(.25).toRGBA().toString(),s=l.Ks.keyframes(C(i));return[y,f.markBase,l.Ks.style(w(s,t,t,i,z)),c.b.style(w(s,t,t,i,z),b)].join(" ")},markWritingExpert:[f.markWritingExpert,f.markBase,l.Ks.style(w(O,o.Green60,o.Green60,o.BlueGray5,z),q),c.b.style(w(O,o.Green60,o.Green60,o.Green10,z),q,b)].join(" "),markWritingExpertHighlighted:[f.markWritingExpertHighlighted,l.Ks.style(w(O,"transparent","transparent",_,z))].join(" "),markBase:[f.markBase,l.Ks.style(v),c.b.style(v,{$nest:{"@media print":{borderBottomWidth:"3 !important"}}})].join(" "),markAppliedBase:[f.markAppliedBase,f.markBase,l.Ks.style({paddingBottom:`${m}`,borderBottom:`${u} solid ${p}`})].join(" "),correctness:[f.correctness,f.markBase,l.Ks.style(w(P,h.Q1.CoreRed50,h.Q1.CoreRed50,h.Q1.CoreRed10,z)),c.b.style(w(P,h.Q1.CoreRed50,h.Q1.CoreRed50,h.Q1.CoreRed10,z),b)].join(" "),premium:[f.premium,f.markBase,l.Ks.style(w(F,h.Q1.CoreYellow40,h.Q1.CoreYellow40,h.Q1.CoreYellow10,j)),c.b.style(w(F,h.Q1.CoreYellow40,h.Q1.CoreYellow40,h.Q1.CoreYellow10,j),b)].join(" "),clarity:[f.clarity,f.markBase,l.Ks.style(w(N,h.Q1.CoreBlue50,h.Q1.CoreBlue50,h.Q1.CoreBlue10,j)),c.b.style(w(N,h.Q1.CoreBlue50,h.Q1.CoreBlue50,h.Q1.CoreBlue10,j),b)].join(" "),markVisible:[f.markVisible,l.Ks.style(Q),c.b.style(Q)].join(" "),engagement:[f.engagement,f.markBase,l.Ks.style(w(R,h.Q1.CoreGreen50,h.Q1.CoreGreen50,h.Q1.CoreGreen10,j)),c.b.style(w(R,h.Q1.CoreGreen50,h.Q1.CoreGreen50,h.Q1.CoreGreen10,j),b)].join(" "),delivery:[f.delivery,f.markBase,l.Ks.style(w(L,h.Q1.CorePurple50,h.Q1.CorePurple50,h.Q1.CorePurple10,j)),c.b.style(w(L,h.Q1.CorePurple50,h.Q1.CorePurple50,h.Q1.CorePurple10,j),b)].join(" "),critical:[f.critical,f.markBase,l.Ks.style(w(E,h.Q1.CoreRed50,h.Q1.CoreRed50,h.Q1.CoreRed10,z)),c.b.style(w(E,h.Q1.CoreRed50,h.Q1.CoreRed50,h.Q1.CoreRed10,z),b)].join(" "),advanced:[f.advanced,f.markBase,l.Ks.style(w(x,h.Q1.CoreYellow40,h.Q1.CoreYellow40,h.Q1.CoreYellow10,j)),c.b.style(w(x,h.Q1.CoreYellow40,h.Q1.CoreYellow40,h.Q1.CoreYellow10,j),b)].join(" "),plagiarism:[f.plagiarism,f.markBase,l.Ks.style(w(M,h.Q1.CoreCyan50,h.Q1.CoreCyan50,h.Q1.CoreCyan10,z)),c.b.style(w(x,h.Q1.CoreCyan50,h.Q1.CoreCyan50,h.Q1.CoreCyan10,z),b)].join(" "),originality:[f.originality,f.markBase,l.Ks.style(w(T,h.Q1.CorePurple50,h.Q1.CorePurple50,h.Q1.CorePurple10,j)),c.b.style(w(L,h.Q1.CorePurple50,h.Q1.CorePurple50,h.Q1.CorePurple10,j),b)].join(" "),vox:[f.vox,f.markBase,l.Ks.style(w(A,h.Q1.CoreNeutral50,h.Q1.CoreNeutral50,h.Q1.CoreNeutral10,j)),c.b.style(w(A,h.Q1.CoreNeutral50,h.Q1.CoreNeutral50,h.Q1.CoreNeutral10,j),b)].join(" "),knowledgeHub:[f.knowledgeHub,f.markBase,l.Ks.style(w(I,h.Q1.CoreNeutral50,h.Q1.CoreNeutral50,h.Q1.CoreNeutral10,j)),c.b.style(w(I,h.Q1.CoreNeutral50,h.Q1.CoreNeutral50,h.Q1.CoreNeutral10,j),b)].join(" "),synonym:[f.synonym,f.markBase,l.Ks.style(w(B,h.Q1.CoreBlue50,"transparent",h.Q1.CoreBlue50,z)),c.b.style(w(B,h.Q1.CoreBlue50,"transparent",h.Q1.CoreBlue50,z),b)].join(" "),markAnimated:[f.markAnimated,l.Ks.style({animation:`${S} .075s ease`})].join(" "),markHidden:[f.markHidden,l.Ks.style(W),c.b.style(W)].join(" "),markBulkAppliedAnimation:[f.markBulkAppliedAnimation,f.markBase,l.Ks.style(H("100%"),V,{animation:`${$} 2s linear forwards, ${U} .25s linear 2s forwards`})].join(" "),markBulkApplied:[f.markBulkApplied,f.markBase,l.Ks.style(w(D,h.Q1.CoreNeutral40,h.Q1.CoreGreen10,h.Q1.CoreGreen10,z),V)].join(" "),markApplied:[f.markApplied,l.Ks.style(H("100%"),{animation:`${$} .25s linear forwards`})].join(" "),markSuccess:[f.markSuccess,l.Ks.style(K("100%"),{animation:`${G} .25s linear forwards`})].join(" "),noAnimation:[f.noAnimation,l.Ks.style({animationDuration:"0s !important"})].join(" "),markSelected:f.markSelected,markSelectedFocused:f.markSelectedFocused,markHeightStandard:f.markHeightStandard,markHeightTall:f.markHeightTall,markStart:f.markStart,markVBar:f.markVBar,markVBarHighlighted:f.markVBarHighlighted}))),Y=e=>e===s.pK.Default?(0,n.ID)():J()},91796:(e,t,i)=>{i.d(t,{WJ:()=>$,N1:()=>V});var s=i(93629),n=i(76005),r=i(44781),a=i(11924),o=i(80837),l=i(95168),c=i(3346),d=i(68533),h=i(44297),p=i(86562),u=i(69063),m=i(74056),g=i(40884),_=i(18286),f=i(26816),y=i(10334),v=i(17171),b=i(63336),S=i(54988),k=i(58889),C=i(36840),w=i(785),E=i(36644),x=i(98719),M=i(9654),T=i(79239);function A(e,t,i){const{appRouter:s,ded:r,downloadViewModel:a,upgradeViewModel:o,modalManager:l,notificationsManager:c,telemetry:d}=t,m=()=>i.visualState.set({type:T.VV.Collapsed}),g=e.name;switch(g){case T.m1.myGrammarly:return()=>{d.gnarSpec.backToMyGrammarlyButtonClick(d.pageId,"documentSetting"),s.navigateAndReload(w.L.routes.documents.href())};case T.m1.newDocument:return()=>{(0,E.Wd)({time:Date.now(),page:"editor",source:"editorNew"}),s.navigate(w.L.routes.new_document.href())};case T.m1.download:return()=>{m(),a.downloadOriginal()};case T.m1.print:return()=>{m(),setTimeout(window.print,200)};case n.H2.undo:return()=>{m(),r.undo()};case n.H2.redo:return()=>{m(),r.redo()};case n.H2.cut:return()=>{m(),r.cut()};case n.H2.copy:return()=>{m(),r.copy()};case n.H2.paste:return(t,s)=>(m(),s===f.W.Source.View?c.enqueue("clipboardNotSupported",{hotkey:(0,b.pipe)(e.hotkey,h.map((e=>i.getHotkeyString(e[0]))),h.getOrElse((()=>"hotkeys")))}):S.w);case n.H2.selectAll:return()=>{m(),k.getOrElse((e=>u.Bx.Logging.getLogger("documentSettings").error(`Failed to execute 'Select all'. ${e}`)))(r.setCursor(0,r.getLastPossibleCursorPosition()))};case T.m1.editorSettings:return()=>(m(),l.show(M.uF.preferences));case T.m1.upgradeToPremium:return()=>{m(),o.openUpgradeUrl(x.YT.Place.DenaliDocument.editorDenaliDocumentSettings)};case T.m1.logout:return()=>(m(),t.userAccount.features.denali.showSignOutConfirmationPopup?l.show(M.uF.signOut):t.accountViewModel.logout());case T.m1.feedback:return()=>(m(),l.show(M.uF.feedback));case T.m1.whatsNew:return()=>(m(),l.show(M.uF.news));case T.m1.language:return C.Yi;case T.m1.close:case T.m1.documentHeader:case T.m1.uploadFile:case T.m1.editHeader:case T.m1.accountHeader:case T.m1.userName:case T.m1.email:case T.m1.subscription:case T.m1.support:case T.m1.privacyPolicy:case T.m1.termsOfService:case T.m1.reportABug:case T.m1.versionHistory:return m;default:return(0,p.xb)(g)}}var I=i(87485),B=i(78339),P=i(15491),F=i(89769),N=i(6987),R=i(60269),L=i(19711),D=i(62822),O=i(36094),H=i(95710);const K=()=>{const e=new Set([a.l.short]),t={active:!1,disabled:!0};return[{name:n.H2.undo,hotkey:s.ci([{modifiers:e,key:"Z"}]),initialState:t,featureOnboardingId:h.none},{name:n.H2.redo,hotkey:s.ci([{modifiers:e,key:"Y"},{modifiers:new Set([a.l.short,a.l.shift]),key:"Z"}]),initialState:t,featureOnboardingId:h.none}]};function $(e){const t=new Set([a.l.short]),i={active:!1,disabled:!1},o={active:!1,disabled:!0},l=[{name:T.m1.close,hotkey:h.none,initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.myGrammarly,hotkey:h.none,initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.documentHeader,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.newDocument,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.uploadFile,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.download,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.print,hotkey:s.ci([{modifiers:t,key:"P"}]),initialState:i,featureOnboardingId:h.none},{name:T.m1.versionHistory,hotkey:h.none,initialState:i,featureOnboardingId:h.some(r.k.VersionHistoryEditor)},"separator",{name:T.m1.editHeader,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:n.H2.undo,hotkey:s.ci([{modifiers:t,key:"Z"}]),initialState:o,featureOnboardingId:h.none},{name:n.H2.redo,hotkey:s.ci([{modifiers:t,key:"Y"},{modifiers:new Set([a.l.short,a.l.shift]),key:"Z"}]),initialState:o,featureOnboardingId:h.none},"separator",{name:n.H2.cut,hotkey:s.ci([{modifiers:t,key:"X"}]),initialState:o,featureOnboardingId:h.none},{name:n.H2.copy,hotkey:s.ci([{modifiers:t,key:"C"}]),initialState:o,featureOnboardingId:h.none},{name:n.H2.paste,hotkey:s.ci([{modifiers:t,key:"V",source:a._.Keydown,preventDefault:!1}]),initialState:i,featureOnboardingId:h.none},{name:n.H2.selectAll,hotkey:s.ci([{modifiers:t,key:"A"}]),initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.editorSettings,hotkey:h.none,initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.accountHeader,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.userName,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.email,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.upgradeToPremium,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.language,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.subscription,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.logout,hotkey:h.none,initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.support,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.whatsNew,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.feedback,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.reportABug,hotkey:h.none,initialState:i,featureOnboardingId:h.none},"separator",{name:T.m1.privacyPolicy,hotkey:h.none,initialState:i,featureOnboardingId:h.none},{name:T.m1.termsOfService,hotkey:h.none,initialState:i,featureOnboardingId:h.none}],c=function(e){const t=e.isPremium.get();return i=>{if(!f.W.isItem(i))return!0;const s=i.name;switch(s){case T.m1.reportABug:return e.denali.isInternalUser;case T.m1.upgradeToPremium:return!t&&!e.demoMode;case T.m1.subscription:return!e.disableAppsPromotion&&!e.demoMode&&!g.DY.isBusinessTeamMember(e.denaliUserType);case T.m1.versionHistory:return e.denali.versionHistory;case T.m1.myGrammarly:case T.m1.newDocument:case T.m1.language:case T.m1.editorSettings:case T.m1.uploadFile:case T.m1.support:case T.m1.feedback:return!e.demoMode;case T.m1.close:case T.m1.documentHeader:case T.m1.download:case T.m1.print:case T.m1.editHeader:case T.m1.accountHeader:case T.m1.userName:case T.m1.email:case T.m1.logout:case T.m1.whatsNew:case T.m1.privacyPolicy:case T.m1.termsOfService:case n.H2.undo:case n.H2.redo:case n.H2.cut:case n.H2.copy:case n.H2.paste:case n.H2.selectAll:return!0;default:return(0,p.xb)(s)}}}(e);return l.filter(c).filter(((e,t,i)=>i[t-1]!==e))}function V(e,t,i,r,p,b,k,C,w,E,x,M,V,U,G,Q){const W=new o.y.Keeper,q=r.features.denali.documentToolbar===g.Wk.documentSettings?$(r.features):E.platform===m.OH.Platform.IPAD?function(e){const t=new Set([a.l.short]),i={active:!1,disabled:!0};return[...$(e),"separator",{name:n.H2.undo,hotkey:s.ci([{modifiers:t,key:"UNDO",source:a._.Input}]),initialState:i,featureOnboardingId:h.none},{name:n.H2.redo,hotkey:s.ci([{modifiers:t,key:"UNDO",source:a._.Input}]),initialState:i,featureOnboardingId:h.none}]}(r.features):K(),{viewModel:z,events:j}=(0,T.fX)(q,i,r,p,w,E,x,V,U,t,e.isEditorFocused),J=function(e,t,i){return e.filter(f.W.isItem).reduce(((e,s)=>(0,v._)((0,y._)({},e),{[s.name]:A(s,i,t)})),{})}(q,z,{appRouter:t,ded:e,userAccount:r,downloadViewModel:b,upgradeViewModel:k,modalManager:C,notificationsManager:x,telemetry:V,accountViewModel:Q}),Y=f.W.toMenuEvents(e.getCursor.bind(e),j).pipe(l.M((([e,t,i])=>{e!==T.m1.upgradeToPremium?V.gnarSpec.docSettingsEventFire(e,V.pageId,i):_.J.create(V.gnarSpec).trackClick({pageId:V.pageId,bannerType:"upgradeToPremium",placement:"documentSettings"})}))),Z=u.Bx.Logging.getLogger("documentSettings"),X=f.W.linkEvents(Y,J).pipe(c.W(((e,t)=>(Z.error("Error handling document settings event",e),t))));return W.push(X.pipe(d.h(function(e,t,i,s,r,a){const o=i.visualState.pipe(l.M((e=>{e.type===T.VV.Expanded?t.gnarSpec.docSettingsSidebarShow(t.pageId):t.gnarSpec.docSettingsSidebarClose(t.pageId)}))),c=a.pipe(B.p(f.W.MenuEvent.StatefulViewEvent.is),P.T((e=>e.isActivated)),F.Z(!1),N.n((e=>e?S.w:H.F.listen("escape").pipe(l.M((e=>e.preventDefault())))))),h=R.h(e.contentUpdated,s.visible.pipe(B.p(Boolean)),c,r).pipe(L.$());return i.visualState.pipe(B.p((e=>e.type===T.VV.Expanded)),l.M((()=>{i.itemsState.modify((0,I.rO)(((t,i)=>function(e,t,i){switch(e){case n.H2.undo:return(0,v._)((0,y._)({},t),{disabled:!i.canUndo()});case n.H2.redo:return(0,v._)((0,y._)({},t),{disabled:!i.canRedo()});case n.H2.cut:case n.H2.copy:return(0,v._)((0,y._)({},t),{disabled:n.LN.isEmpty(i.getCursor())});case n.H2.selectAll:return(0,v._)((0,y._)({},t),{disabled:i.getTextLength()<=1});default:return t}}(t,i,e)))),s.visible.set(!1)})),N.n((()=>h.pipe(l.M((()=>{i.visualState.set({type:T.VV.Collapsed})}))))),d.h(o),D.u(O.q6))}(e,V,z,M,G,j))).subscribe(),e.dontFreezeWhen(z.visualState.view("type").view((e=>e===T.VV.Expanded)),"documentSettings")),{viewModel:z,dispose:()=>W.dispose()}}},79239:(e,t,i)=>{i.d(t,{LU:()=>a,VV:()=>s,W7:()=>r,fX:()=>P,m1:()=>n});var s,n,r,a,o=i(23988),l=i(30040),c=i(80074),d=i(76005),h=i(42543),p=i(36094),u=i(62723),m=i(15491),g=i(41797),_=i(95168),f=i(3346),y=i(38427),v=i(21216),b=i(22013),S=i(44297),k=i(58193),C=i(58889),w=i(86562),E=i(36840),x=i(69063),M=i(81870),T=i(74056),A=i(98719),I=i(98969),B=i(26816);function P(e,t,i,s,n,r,a,o,l,c,d){const p=new h.B7;return{viewModel:new F(e,p,t,i,s,n,r,a,o,l,c,d,i.features.proVsPremiumExperiment,i.features.assignProVsPremiumExperiment),events:p}}!function(e){e.Collapsed="Collapsed",e.Expanded="Expanded"}(s||(s={})),function(e){e.close="close",e.myGrammarly="myGrammarly",e.documentHeader="documentHeader",e.newDocument="newDocument",e.uploadFile="uploadFile",e.download="download",e.print="print",e.editHeader="editHeader",e.editorSettings="editorSettings",e.accountHeader="accountHeader",e.userName="userName",e.email="email",e.upgradeToPremium="upgradeToPremium",e.language="language",e.subscription="subscription",e.logout="logout",e.support="support",e.whatsNew="whatsNew",e.feedback="feedback",e.privacyPolicy="privacyPolicy",e.termsOfService="termsOfService",e.reportABug="reportABug",e.versionHistory="versionHistory"}(n||(n={})),function(e){e.uploadFile="uploadFile",e.accountHeaderLabel="accountHeaderLabel",e.languageSettings="languageSettings",e.whatsNewUpdates="whatsNewUpdates"}(r||(r={})),function(e){e.is=e=>e.type===r.languageSettings}(a||(a={}));class F{_createViewItem(e){if(!B.W.isItem(e))return e;const t=(0,l.pipe)(e.featureOnboardingId,S.map(this._userAccount.features.denali.onboardingSeen),S.map(p.B8),S.getOrElse((()=>c.s.create(!1))));return{name:e.name,title:this._getTitle(e.name),tooltip:this._getTooltip(e.name),nestedItem:this._getNestedItem(e),active:this.itemsState.view(e.name,"active"),disabled:this.itemsState.view(e.name,"disabled"),onClick:()=>{this._events.next({event:e.name,source:B.W.Source.View}),(0,l.pipe)(e.featureOnboardingId,S.filter((()=>t.get())),k.Mi(this._userAccount.features.denali.markFeatureOnboarded))},showGreenDot:(0,l.pipe)(e.featureOnboardingId,S.map(this._userAccount.features.denali.onboardingSeen),S.map(p.B8))}}_getNestedItem(e){const t=e.name;switch(t){case n.uploadFile:if(this._userAccount.features.demoMode)return S.none;const i=A.jj.$G.filter((e=>".doc"!==e&&".htm"!==e&&".html"!==e)).join(", ");return S.some(C.right({type:r.uploadFile,uploadViewModel:this._uploadViewModel,label:i}));case n.newDocument:case n.print:case d.H2.undo:case d.H2.redo:case d.H2.cut:case d.H2.copy:case d.H2.paste:case d.H2.selectAll:return(0,l.pipe)(e.hotkey,S.map((e=>C.left(this.getHotkeyString(e[0])))));case n.accountHeader:return S.some(C.right({type:r.accountHeaderLabel,brandingSet:this._userAccount.entitlements.view(S.chain(I.b.getBrandingSet))}));case n.language:return S.some(C.right({type:r.languageSettings,dialectSettings:this._dialectSettings,changeDialect:this._changeDialect,onStateChange:e=>{this._events.next({event:t,source:B.W.Source.View,isActivated:e})}}));case n.download:return this._documentModel.rtfMode===A.jj.l1.FormattingMode.on?S.some(C.left(this._textResources.documentSettings.downloadLabel)):S.none;case n.close:case n.myGrammarly:case n.documentHeader:case n.editHeader:case n.editorSettings:case n.userName:case n.email:case n.upgradeToPremium:case n.subscription:case n.logout:case n.support:case n.whatsNew:case n.feedback:case n.reportABug:case n.privacyPolicy:case n.termsOfService:case n.versionHistory:return S.none;default:return(0,w.xb)(t)}}_getTitle(e){const t=this._userAccount.profile.get();switch(e){case n.userName:return t.fullName;case n.email:return t.email;case n.upgradeToPremium:return this._isEligibleForPro?this._textResources.documentSettings.upgradeToPro:this._textResources.documentSettings.upgradeToPremium;default:return this._textResources.documentSettings[e]}}_getTooltip(e){switch(e){case n.documentHeader:case n.editHeader:case n.accountHeader:case n.email:case n.userName:return S.none;default:const t=this._textResources.documentSettings;return S.some(e in t.tooltips?t.tooltips[e]:t[e])}}constructor(e,t,i,n,r,a,d,h,p,k,w,A,I,P){(0,o._)(this,"_scheme",void 0),(0,o._)(this,"_events",void 0),(0,o._)(this,"_textResources",void 0),(0,o._)(this,"_userAccount",void 0),(0,o._)(this,"_dialectSettings",void 0),(0,o._)(this,"_uploadViewModel",void 0),(0,o._)(this,"_environment",void 0),(0,o._)(this,"_notificationsManager",void 0),(0,o._)(this,"_telemetry",void 0),(0,o._)(this,"_documentModel",void 0),(0,o._)(this,"_appRouter",void 0),(0,o._)(this,"_isEditorFocused",void 0),(0,o._)(this,"_isEligibleForPro",void 0),(0,o._)(this,"_assignToProVsPremiumExperiment",void 0),(0,o._)(this,"itemsState",void 0),(0,o._)(this,"visualState",void 0),(0,o._)(this,"items",void 0),(0,o._)(this,"head",void 0),(0,o._)(this,"hasNewItems",void 0),(0,o._)(this,"getHotkeyString",void 0),(0,o._)(this,"getBindings",void 0),(0,o._)(this,"onMenuHovered",void 0),(0,o._)(this,"onGoBackToGrammarlyHome",void 0),(0,o._)(this,"onOpenToolbar",void 0),(0,o._)(this,"_changeDialect",void 0),this._scheme=e,this._events=t,this._textResources=i,this._userAccount=n,this._dialectSettings=r,this._uploadViewModel=a,this._environment=d,this._notificationsManager=h,this._telemetry=p,this._documentModel=k,this._appRouter=w,this._isEditorFocused=A,this._isEligibleForPro=I,this._assignToProVsPremiumExperiment=P,this.visualState=c.s.create({type:s.Collapsed}),this.items=[],this.getHotkeyString=b.L.HotkeyOptions.toString(this._environment.has(T.OH.Flag.isAppleSystem)),this.getBindings=(0,l.pipe)(this._scheme,B.W.Scheme.toBindingProvider((e=>this._events.next(e)),(()=>this._isEditorFocused.pipe(u.z(this.visualState.pipe(m.T((e=>e.type===s.Expanded))),E.or))))),this.onMenuHovered=()=>{this._documentModel.flush().catch((e=>x.Bx.Logging.getLogger("documentSettings").error("Could not flush document from toolbar",e)))},this.onGoBackToGrammarlyHome=()=>{this._telemetry.gnarSpec.backToMyGrammarlyButtonClick(this._telemetry.pageId,"inline"),this._appRouter.navigateAndReload(M.Lz.routes.documents.href())},this.onOpenToolbar=()=>{this.visualState.set({type:s.Expanded,scrollTo:S.none}),this._assignToProVsPremiumExperiment()},this._changeDialect=e=>g.H(this._dialectSettings.setDialect(e)).pipe(_.M((()=>{(0,l.pipe)(this._environment.actions.dialectChanged(),C.mapLeft((e=>{x.Bx.Logging.getLogger("documentSettings").error("env error during dialect change",e)}))),this._telemetry.gnarSpec.docSettingsLanguageEventFire(e,this._telemetry.pageId)})),f.W((e=>(x.Bx.Logging.getLogger("documentSettings").error("Cannot set language preferences",e),this._notificationsManager.enqueue("error"))))).toPromise(),this.itemsState=c.s.create(e.filter(B.W.isItem).reduce(((e,t)=>(e[t.name]=t.initialState,e)),{}));const[F,...N]=e.map((e=>this._createViewItem(e)));this.head=F,this.items=N,this.hasNewItems=y.zV(N.map((e=>(0,l.pipe)(e,S.fromPredicate(B.W.Item.isViewItem),S.chain((e=>e.showGreenDot)),S.getOrElse((()=>v.of(!1))))))).pipe(m.T((e=>e.some(Boolean))))}}},1404:(e,t,i)=>{i.d(t,{W:()=>s});var s,n=i(47370),r=i(30040),a=i(63336),o=i(80074),l=i(76005),c=i(7432),d=i(62822),h=i(15491),p=i(42543),u=i(80837),m=i(34078),g=i(83541),_=i(6987),f=i(21216),y=i(89769),v=i(60269),b=i(54988),S=i(3346),k=i(36094),C=i(95710),w=i(74380),E=i(58889),x=i(86562),M=i(23121),T=i(36840),A=i(44297),I=i(58193),B=i(69063);!function(e){let t,i,s,P,F,N;!function(e){e.EditingMode="EditingMode",e.ReadMode="ReadMode"}(t=e.VisualState||(e.VisualState={})),function(e){e.is=e=>e.visualState===t.EditingMode}(i||(i={})),function(e){e.is=e=>e.type!==P.Type.Close&&e.type!==P.Type.ApplyRemove&&e.type!==P.Type.ApplyChange}(s||(s={})),function(e){let i,s,n;!function(e){e.SwitchToReadMode="SwitchToReadMode",e.SwitchToEditMode="SwitchToEditMode",e.ApplyChange="ApplyChange",e.ApplyRemove="ApplyRemove",e.Close="Close"}(i=e.Type||(e.Type={})),function(e){e.is=e=>e.type===P.Type.SwitchToReadMode}(s=e.SwitchToReadMode||(e.SwitchToReadMode={})),function(e){e.create=function(e,t,i){return(0,a.pipe)(e,w.e,E.bimap((()=>{}),(e=>({type:P.Type.ApplyChange,url:e,textRange:t,rect:i}))))}}(n=e.ApplyChange||(e.ApplyChange={})),e.initMapFromState=function(e){return t=>{const i=e.getFormatting(t.range);if(l.M_.LinkPayload.is(i)){const e=i[l.M_.Type.link],{rect:s,url:n,range:r}=e[0];return"selection"===t.source?{type:P.Type.SwitchToReadMode,textRange:r,rect:s,url:n}:{type:P.Type.SwitchToEditMode,textRange:r,rect:s,url:n}}{(0,x.V1)("toolbar"===t.source,"non-toolbar source can not emit ranges without link formatting");const i=(0,a.pipe)(e.getSelectionRect(),E.fold((()=>{throw new x.zU("Failed to get selection rect while trying to add link")}),r.identity));return{type:P.Type.SwitchToEditMode,textRange:t.range,rect:i,url:""}}}},e.initHandlers=function(e,t,i){const s=()=>M.zb((()=>i.next()));return i=>{switch(i.type){case P.Type.SwitchToEditMode:return e.setCursor(i.textRange.start,c.vY.size(i.textRange));case P.Type.SwitchToReadMode:return E.right(void 0);case P.Type.ApplyChange:return(0,a.pipe)(t.removeLink(i.textRange),E.chain((()=>c.vY.isEmpty(i.textRange)?(0,a.pipe)(t.insertLinkWithCaption(i.textRange.start,i.url,i.url),E.chain((()=>e.setCursor(i.textRange.start+i.url.length,c.vY.size(i.textRange))))):t.insertLink(i.textRange,i.url))));case P.Type.ApplyRemove:return(0,a.pipe)(s(),E.chain((()=>t.removeLink(i.textRange))),E.chain((()=>e.setCursor(i.textRange.start,0))));case P.Type.Close:return s();default:return(0,x.xb)(i)}}},e.initMapToView=function(e){return i=>{const s=()=>e.next({type:P.Type.Close});switch(i.type){case P.Type.SwitchToEditMode:const n=o.s.create(i.url);return{visualState:t.EditingMode,rect:i.rect,inputContent:n,isValid:n.view(T.z2),textRange:i.textRange,close:s,apply:()=>{(0,a.pipe)(P.ApplyChange.create(n.get(),i.textRange,i.rect),E.fold(s,(t=>e.next(t))))}};case P.Type.SwitchToReadMode:return{visualState:t.ReadMode,url:i.url,rect:i.rect,textRange:i.textRange,close:s,remove:()=>e.next({type:P.Type.ApplyRemove,textRange:i.textRange}),change:()=>e.next({type:P.Type.SwitchToEditMode,url:i.url,rect:i.rect,textRange:i.textRange})};default:return(0,x.xb)(i)}}}}(P||(P={})),function(e){e.eq=n.ee(((e,t)=>e.source===t.source&&c.vY.ord.equals(e.range,t.range)))}(F=e.LinkState||(e.LinkState={})),function(e){e.listenCloseHotkey=function(){return C.F.listen("escape").pipe(d.u({type:P.Type.Close}))},e.listenApplyHotkey=function(e){return C.F.listen("enter").pipe(h.T((()=>{const t=(0,a.pipe)(e.get(),A.filter(i.is));(0,x.V1)(A.isSome(t),"Called Apply when view wasn't in edit mode");const s=I.$v(t);return(0,a.pipe)(P.ApplyChange.create(s.inputContent.get(),s.textRange,s.rect),E.fold((()=>({type:P.Type.Close})),(e=>e)))})))}}(N||(N={})),e.createManager=function(e,i,n){const l=o.s.create(A.none),c=new p.B7,d=P.initMapFromState(e),C=P.initMapToView(c),w=P.initHandlers(e,i,n.closeLinks),x=B.Bx.Logging.getLogger("formattingLinksManager"),M=new u.y.Keeper;return M.push(e.dontFreezeWhen(l.view(A.exists((({visualState:e})=>e===t.EditingMode))),"links"),n.formattingLinkState.pipe(m.s((0,r.flow)(A.filter((e=>"selection"===e.source)),A.fold((()=>0),(()=>200)),g.timer)),_.n(A.fold((()=>f.of(A.none)),(e=>c.pipe(y.Z(d(e)),_.n((e=>v.h(f.of(e),N.listenCloseHotkey(),e.type===P.Type.SwitchToEditMode?N.listenApplyHotkey(l):b.w))),_.n((e=>(0,a.pipe)(w(e),E.fold((e=>(x.error("Error in formatting links",e),n.closeLinks.next(),b.w)),(()=>s.is(e)?f.of(e):b.w))))),h.T(C),h.T(A.some))))),S.W((e=>(x.error("Error in formatting links",e),b.w)))).subscribe(k.H9(l))),{visualState:l,dispose:()=>M.dispose()}}}(s||(s={}))},80019:(e,t,i)=>{i.d(t,{Ht:()=>s,hn:()=>P,uY:()=>n});var s,n,r=i(23988),a=i(10334),o=i(17171),l=i(93629),c=i(98423),d=i(30040),h=i(63336),p=i(80074),u=i(76005),m=i(11924),g=i(42543),_=i(95168),f=i(62822),y=i(36094),v=i(18515),b=i(15491),S=i(3346),k=i(68533),C=i(22013),w=i(38920),E=i(44297),x=i(58889),M=i(86562),T=i(36840),A=i(69063),I=i(74056),B=i(26816);function P(e,t,i,n,r,a,o,c){const d=[{name:"head",hotkey:E.none,initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},{name:u.M_.Type.bold,hotkey:l.ci([{modifiers:new Set([m.l.short]),key:"B"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},{name:u.M_.Type.italic,hotkey:l.ci([{modifiers:new Set([m.l.short]),key:"I"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},{name:u.M_.Type.underline,hotkey:l.ci([{modifiers:new Set([m.l.short]),key:"U"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},"separator",{name:u.M_.Type.header1,hotkey:l.ci([{modifiers:new Set([m.l.short,m.l.alt]),key:"1"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},{name:u.M_.Type.header2,hotkey:l.ci([{modifiers:new Set([m.l.short,m.l.alt]),key:"2"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},"separator",{name:u.M_.Type.link,hotkey:l.ci([{modifiers:new Set([m.l.short]),key:"K"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},"separator",{name:u.M_.Type.orderedList,hotkey:l.ci([{modifiers:new Set([m.l.short,m.l.shift]),key:"7"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},{name:u.M_.Type.bulletList,hotkey:l.ci([{modifiers:new Set([m.l.short,m.l.shift]),key:"8"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none},"separator",{name:"clear",hotkey:l.ci([{modifiers:new Set([m.l.short]),key:"\\"}]),initialState:{active:!1,disabled:!1},featureOnboardingId:E.none}],h=d.filter((0,T.M4)(B.W.isItem,(e=>e.name!==u.M_.Type.link))),p=s.initHandlers(h),{formattingEvents:g,viewModel:f}=function(e,t,i,n,r,a,o){const l=s.ToolbarViewModel.create(i,n,o,t);return{viewModel:l,formattingEvents:B.W.toMenuEvents(e,l.events).pipe(_.M((([e,t,i])=>{r.rtfMenuEventFire(e,a,i)})))}}(e,n,d,r,a,o,c),[y,b]=v.j(g,(e=>e[0]!==u.M_.Type.link)),C=function(e,t,i,n,r){const a=i(e,r),o=A.Bx.Logging.getLogger("formattingMenuManager"),l=B.W.linkEvents(n,a).pipe(S.W(((e,t)=>(o.error("Error handling formatting event",e),t)))),c=s.ToolbarViewModel.stateManager(t,r),d=l.pipe(k.h(c)).subscribe();return{dispose:()=>{d.unsubscribe()}}}(t,i,p,y,f);return{dispose:()=>{C.dispose()},viewModel:f,linkEvents:b}}!function(e){let t,i,s;!function(e){e.asMenuScheme=e=>e.slice(1)}(t=e.Scheme||(e.Scheme={})),function(e){e.Collapsed="Collapsed",e.Expanded="Expanded"}(i=e.VisualState||(e.VisualState={})),function(e){e.create=function(e,s,n,r){const a=e=>s.toolbar.formatting[e],o=e=>E.some(s.toolbar.formatting.tooltips[e]),l=(e,t)=>(0,h.pipe)(o(e.name),E.map((e=>`${s.toolbar.formatting.tooltips.head} ${e}`)),E.map((e=>(0,h.pipe)(t,E.map(x.fold(d.identity,d.constVoid)),E.map((t=>`${e}, shortcut ${t}`)),E.getOrElse((0,d.constant)(e))))),E.toUndefined),c=C.L.HotkeyOptions.toString(n.has(I.OH.Flag.isAppleSystem)),u=new g.B7,m=p.s.create({menu:i.Expanded,items:e.filter(B.W.isItem).reduce(((e,t)=>(e[t.name]=t.initialState,e)),{})}),_=e[0];return{getBindings:(0,h.pipe)(e,t.asMenuScheme,B.W.Scheme.toBindingProvider((e=>u.next(e)),(()=>r))),head:{name:_.name,title:a(_.name),tooltip:o(_.name),nestedItem:E.none,active:m.view("items",_.name,"active"),disabled:m.view("items",_.name,"disabled"),onClick:()=>u.next({event:_.name,source:B.W.Source.View}),showGreenDot:E.none},list:t.asMenuScheme(e).map((e=>{if(B.W.isItem(e)){const t=(0,h.pipe)(e.hotkey,E.map((e=>x.left(c(e[0])))));return{name:e.name,title:a(e.name),tooltip:o(e.name),nestedItem:t,ariaLabel:l(e,t),active:m.view("items",e.name,"active"),disabled:m.view("items",e.name,"disabled"),onClick:()=>u.next({event:e.name,source:B.W.Source.View}),showGreenDot:E.none}}return e})),visualState:m.view("menu"),state:m,events:u}},e.stateManager=function(e,{state:t}){return e.pipe(_.M((e=>{t.lens("items").modify((0,c.rO)(((t,i)=>t===u.M_.Type.bulletList?(0,o._)((0,a._)({},i),{active:!0===e[u.M_.Type.bulletList]||!0===e[u.M_.Type.dashedList]}):t===u.M_.Type.link?i:u.M_.is(t)?(0,o._)((0,a._)({},i),{active:!0===e[t]}):i)))})),f.u(y.q6))}}(s=e.ToolbarViewModel||(e.ToolbarViewModel={}));e.initHandlers=function(e){return(t,s)=>{const n=((e,{state:t})=>s=>{const n=t=>{e({index:t.start,length:t.end-t.start,meta:{source:u.LN.Meta.Source.api,formatting:{bold:!1,italic:!1,underline:!1,bulletList:!1,dashedList:!1,header1:!1,header2:!1,orderedList:!1,strike:!1}}})};switch(s.name){case"head":return()=>t.lens("menu").modify((e=>e===i.Collapsed?i.Expanded:i.Collapsed));case"clear":return n;case u.M_.Type.bold:case u.M_.Type.bulletList:case u.M_.Type.header1:case u.M_.Type.header2:case u.M_.Type.italic:case u.M_.Type.orderedList:case u.M_.Type.underline:return r=s.name,i=>{const s=t.get().items[r].active,n=(t={})=>e({index:i.start,length:i.end-i.start,meta:{source:u.LN.Meta.Source.api,formatting:(0,o._)((0,a._)({},t),{[r]:!s})}});w.pR.isBlockFormat(r)?n({[u.M_.Type.header1]:!1,[u.M_.Type.header2]:!1,[u.M_.Type.orderedList]:!1,[u.M_.Type.bulletList]:!1,[u.M_.Type.dashedList]:!1}):n()};default:return(0,M.xb)(s.name)}var r})(t,s);return e.reduce(((e,t)=>(e[t.name]=n(t),e)),{})}}}(s||(s={})),function(e){e.fromToolbar=function(e){return e.pipe(b.T((([,e])=>({range:e,source:"toolbar"}))))},e.fromDenaliEditor=function(e){return e.pipe(b.T((e=>u.M_.LinkPayload.is(e)?E.some({range:e[u.M_.Type.link][0].range,source:"selection"}):E.none)))}}(n||(n={})),function(e){let t;!function(e){e.Mock=class{constructor(){(0,r._)(this,"viewModel",void 0),(0,r._)(this,"linkEvents",new g.B7),(0,r._)(this,"changes",new g.B7)}}}(t=e.Manager||(e.Manager={}))}(s||(s={}))},26816:(e,t,i)=>{i.d(t,{W:()=>s});var s,n=i(30040),r=i(76005),a=i(95168),o=i(15491),l=i(92051),c=i(36094),d=i(10047),h=i(44297);!function(e){let t,i,p,u;!function(e){e.toBindingProvider=(e,t)=>i=>r=>(0,n.pipe)(i,d.pb(s.isItem),d.cy((i=>(0,n.pipe)(i.hotkey,h.map((n=>n.map((n=>({action:i.name,hotkey:r(n),isActive:t(i.name),bind:a.M((()=>e({event:i.name,source:s.Source.Hotkey})))}))))),h.getOrElse((()=>[]))))))}(t=e.Scheme||(e.Scheme={})),e.isItem=e=>"string"!=typeof e,function(e){e.isViewItem=e=>"string"!=typeof e}(i=e.Item||(e.Item={})),function(e){let t;!function(e){e.is=e=>"isActivated"in e}(t=e.StatefulViewEvent||(e.StatefulViewEvent={})),e.isView=e=>e.source===s.Source.View,e.isHotkey=e=>e.source===s.Source.Hotkey}(p=e.MenuEvent||(e.MenuEvent={})),function(e){e.Hotkey="Hotkey",e.View="View"}(u=e.Source||(e.Source={})),e.toMenuEvents=(e,t)=>t.pipe(o.T((t=>[t.event,r.LN.toTextRange(e()),t.source]))),e.linkEvents=function(e,t){return e.pipe(l.ZZ((([e,i,s])=>c.br(t[e].call(null,i,s)))))}}(s||(s={}))},91956:(e,t,i)=>{i.d(t,{Qn:()=>n,kt:()=>s,xK:()=>N});var s,n,r=i(23988),a=i(10334),o=i(17171),l=i(63336),c=i(80074),d=i(61198),h=i(63967),p=i(62597),u=i(82636),m=i(54988),g=i(6987),_=i(42543),f=i(15491),y=i(80837),v=i(60269),b=i(78339),S=i(95168),k=i(83541),C=i(68594),w=i(36094),E=i(84714),x=i(47370),M=i(44297),T=i(38908),A=i(36840),I=i(86562),B=i(40884),P=i(44011),F=i(9654);!function(e){let t;!function(e){e.eq=x.OW({isSidebarOpen:x.zF,isGgoOpen:x.zF})}(t=e.UIState||(e.UIState={}))}(s||(s={})),function(e){class t extends E.Rv.Mock{constructor(e={},t=!0){super(e),(0,r._)(this,"popover",c.s.create(M.none)),(0,r._)(this,"state",void 0),(0,r._)(this,"alertSwitchChanges",m.w),(0,r._)(this,"premiumButtonData",c.s.create(M.none)),(0,r._)(this,"toggleSidebar",((e,t)=>this.state.set({navigationSource:t,isSidebarOpen:e,isGgoOpen:!1}))),this.state=c.s.create({isSidebarOpen:t,isGgoOpen:!1,navigationSource:h.Kz.sidebar})}}e.Mock=t}(n||(n={}));class N{_switchToLens(e,t){const i=this.activeLensId.get(),s=i===e?p.J.SpecialId.AllAlerts:e;if(i!==s)return s===p.J.SpecialId.Plagiarism&&this._features.plagiarism.get()!==B.Fh.enabled?this.popover.set(M.some(E.Qh.PlagiarismHook)):void this._lensSwitch.next({lensId:s,focusFirst:t.focusFirst,source:t.actionSource})}_listenNavigationEvent(){this._subs.push(this.events.pipe(g.n((e=>{switch(e.type){case"setGoals":return this._modalManager.show(d.ug.setGoals("user"));case"preferences":return this._modalManager.show(F.uF.preferences);case"performance":return this._modalManager.show(d.ug.performance);case"switchToLens":switch(this._switchToLens(e.id,{focusFirst:e.focusFirst,actionSource:e.actionSource}),e.id){case p.J.SpecialId.FreePremiumAlerts:this._telemetry.gnarSpec.freeAdvancedIssuesButtonClick(this._telemetry.pageId,"wiritingAssistant");break;case p.J.SpecialId.Premium:this._telemetry.gnarSpec.advancedIssuesButtonClick(this._telemetry.pageId,"wiritingAssistant");break;default:this._telemetry.gnarSpec.openLensButtonClick(T.PT(e.title),this._telemetry.pageId)}return m.w;case"toggleSidebar":return this.state.view("isSidebarOpen").get()?this._switchToLens(p.J.SpecialId.Closed,{focusFirst:!0,actionSource:e.actionSource}):this._focusClosestAlert(h.Kz.api),this._toggleSidebarState(h.Kz.sidebar),m.w;case"switchToCritical":return this._features.isFree.get()?this._focusClosestAlert(e.actionSource):this._focusClosestAlertByPredicate(h.Fc.isCriticalImpact,e.actionSource),m.w;case"switchToAdvanced":return this._features.isFree.get()?this._switchToLens(p.J.SpecialId.Premium,{focusFirst:!0,actionSource:h.Kz.sidebar}):this._focusClosestAlertByPredicate((0,A.AU)(h.Fc.isCriticalImpact),e.actionSource),m.w;case"switchToAll":return this._switchToLens(p.J.SpecialId.AllAlerts,{actionSource:e.actionSource,focusFirst:e.focusFirst}),this.toggleSidebar(!0,h.Kz.sidebar),m.w;default:return(0,I.xb)(e)}}))).subscribe())}_focusClosestAlert(e){(0,l.pipe)(this._getAlertClosestToCursor(h.Fc.isRegisteredApplicableAlert,"cursor"),M.fold((()=>this._switchToLens(p.J.SpecialId.AllAlerts,{focusFirst:!0,actionSource:e})),(t=>this._alertSwitch.next({alertHighlight:t,source:e}))))}_focusClosestAlertByPredicate(e,t){(0,l.pipe)(this._getAlertClosestToCursor((0,A.M4)(h.Fc.isRegisteredApplicableAlert,e),"cursor"),M.fold((()=>this._focusClosestAlert(t)),(e=>this._alertSwitch.next({alertHighlight:e,source:t}))))}get _premiumButtonData(){const e=this._premiumCount,t=this._features.proVsPremiumExperiment?"Pro":e.get().title,i=e.view("count");return c.s.combine(this._features.isFree,this._oggyUphookModel.isAvailable,((e,s)=>e&&s?M.some({id:p.J.SpecialId.Premium,title:t,alerts:i}):M.none))}dispose(){this._subs.dispose()}constructor(e,t,i,n,d,m,g,x,T,I,F){(0,r._)(this,"_telemetry",void 0),(0,r._)(this,"_modalManager",void 0),(0,r._)(this,"_features",void 0),(0,r._)(this,"_getAlertClosestToCursor",void 0),(0,r._)(this,"_documentModel",void 0),(0,r._)(this,"cardVisualMode",void 0),(0,r._)(this,"_isCheetahEnabled",void 0),(0,r._)(this,"_premiumCount",void 0),(0,r._)(this,"_oggyUphookModel",void 0),(0,r._)(this,"_oggyPlagiarismModel",void 0),(0,r._)(this,"_lensSwitch",void 0),(0,r._)(this,"_alertSwitch",void 0),(0,r._)(this,"popover",void 0),(0,r._)(this,"alertSwitchChanges",void 0),(0,r._)(this,"state",void 0),(0,r._)(this,"events",void 0),(0,r._)(this,"_subs",void 0),(0,r._)(this,"activeLensId",void 0),(0,r._)(this,"a11yContrast",void 0),(0,r._)(this,"documentActions",void 0),(0,r._)(this,"premiumButtonData",void 0),(0,r._)(this,"showMuteControl",void 0),(0,r._)(this,"lensTitleType",void 0),(0,r._)(this,"toggleSidebar",void 0),(0,r._)(this,"_toggleSidebarState",void 0),this._telemetry=e,this._modalManager=t,this._features=i,this._getAlertClosestToCursor=n,this._documentModel=d,this.cardVisualMode=g,this._isCheetahEnabled=x,this._premiumCount=T,this._oggyUphookModel=I,this._oggyPlagiarismModel=F,this._lensSwitch=new _.B7,this._alertSwitch=new _.B7,this.popover=c.s.create(M.none),this.alertSwitchChanges=this._alertSwitch.pipe(f.T((({alertHighlight:e,source:t})=>(0,o._)((0,a._)({},e),{source:t})))),this.state=c.s.create({isSidebarOpen:this._features.denali.sidebarOpenedByDefault,isGgoOpen:!1,navigationSource:h.Kz.api}),this.events=new _.B7,this._subs=new y.y.Keeper,this.a11yContrast=!0,this.documentActions=c.s.combine(this._features.plagiarism,this._features.proofit,this._documentModel.documentLength.view("full").view((e=>0===e)),this._documentModel.title,this._isCheetahEnabled,this._oggyPlagiarismModel.isAvailable,((e,t,i,s,n,r)=>({plagiarism:e===B.Fh.enabled?i&&!this._features.isSmartPlagiarismUphookEnabled?E.Rv.plagiarismDisabled(E.GJ.EmptyDocument):r?E.Rv.documentActionAvailable:E.Rv.plagiarismDisabled(E.GJ.NotAvailable):e===B.Fh.upgradeIsNeeded?E.Rv.documentActionAvailable:E.Rv.plagiarismDisabled(E.GJ.NotAvailable),proofit:t===B.Fh.enabled?i?E.Rv.proofitDisabled(E.M7.EmptyDocument):s===P.premiumDemoDocument.title?E.Rv.proofitDisabled(E.M7.DemoDoc):E.Rv.documentActionAvailable:t===B.Fh.upgradeIsNeeded?E.Rv.documentActionAvailable:E.Rv.proofitDisabled(E.M7.NotAvailable),cheetah:n?E.Rv.documentActionAvailable:E.Rv.cheetahDisabled(E.py.NotAvailable)}))),this.toggleSidebar=(e,t)=>this.state.modify((i=>(0,o._)((0,a._)({},i),{navigationSource:t,isSidebarOpen:e,isGgoOpen:!1}))),this._toggleSidebarState=e=>this.state.modify((t=>(0,o._)((0,a._)({},t),{navigationSource:e,isSidebarOpen:!t.isSidebarOpen,isGgoOpen:!1}))),this.premiumButtonData=this._premiumButtonData,this._listenNavigationEvent(),this.showMuteControl=(0,l.pipe)(m,M.fold((()=>c.s.create(!1)),(e=>e.mutedCategories.view(u.x.BaseMutedCategories.filter((0,A.AU)(u.x.Category.isSpecial))).view((e=>e.size>0))))),this.lensTitleType=E.Rv.LensTitleType.default;const N=c.s.create(this._features.denali.sidebarOpenedByDefault?p.J.SpecialId.AllAlerts:p.J.SpecialId.Closed);this._subs.push(v.h(this._lensSwitch.pipe(b.p((({lensId:e})=>p.J.isRelevantForOggy(e)))),this._alertSwitch.pipe(f.T((({source:e})=>({lensId:p.J.SpecialId.AllAlerts,source:e}))))).pipe(S.M((({lensId:e,source:t})=>{N.set(e),this.state.modify((i=>(0,o._)((0,a._)({},i),{navigationSource:t,isSidebarOpen:i.isSidebarOpen||p.J.isCheetah(e),isGgoOpen:p.J.isCheetah(e)})))}))).subscribe(),this.state.pipe(k.skipBy(s.UIState.eq),C.i(1),f.T((({isSidebarOpen:e,isGgoOpen:t})=>e?t?p.J.SpecialId.Cheetah:p.J.SpecialId.AllAlerts:p.J.SpecialId.Closed)),S.M(w.H9(N))).subscribe()),this._subs.push(this._oggyUphookModel.isFocused.pipe(f.T((e=>e?p.J.SpecialId.Premium:p.J.SpecialId.AllAlerts)),S.M(w.H9(N))).subscribe(),this._oggyPlagiarismModel.isFocused.pipe(f.T((e=>e?p.J.SpecialId.Plagiarism:p.J.SpecialId.AllAlerts)),S.M(w.H9(N))).subscribe()),this._subs.push(this.premiumButtonData.pipe(S.M((e=>{M.isSome(e)&&this._features.assignProVsPremiumExperiment()}))).subscribe()),this.activeLensId=N.view(),(0,A.hJ)("toggleSidebar",(()=>this.state.modify((e=>(0,o._)((0,a._)({},e),{isSidebarOpen:!e.isSidebarOpen}))))),(0,A.hJ)("activeLensId",(()=>this.activeLensId.get())),(0,A.hJ)("navigationState",(()=>this.state.get()))}}},35382:(e,t,i)=>{i.d(t,{A:()=>a,f:()=>s});var s,n=i(23988),r=i(69063);!function(e){let t;!function(e){e.isVideo=function(e){return"video"in e}}(t=e.Content||(e.Content={}))}(s||(s={}));class a{markSeen(e){return r.Bx.Logging.getLogger("whatsnew").info("News shown",e),this._settings.markNewsItemsAsSeen(e)}constructor(e){(0,n._)(this,"_settings",void 0),this._settings=e}}},5875:(e,t,i)=>{i.d(t,{V:()=>s,Md:()=>W,N$:()=>r,_S:()=>n});var s,n,r,a,o=i(23988),l=i(10334),c=i(17171),d=i(30040),h=i(63336),p=i(80074),u=i(78323),m=i(83062),g=i(76005),_=i(2061),f=i(90405),y=i(62723),v=i(19711),b=i(95168),S=i(36094),k=i(78339),C=i(80837),w=i(15491),E=i(6987),x=i(40027),M=i(89769),T=i(86887),A=i(5692),I=i(3346),B=i(88423),P=i(11298),F=i(21216),N=i(54988),R=i(65621),L=i(44297),D=i(86562),O=i(47370),H=i(58193),K=i(58889),$=i(69063),V=i(81870),U=i(42543);class G{_closeProofitOrder(){this._closeModal()}dispose(){this._subscriptions.dispose()}constructor(e){(0,o._)(this,"_closeModal",void 0),(0,o._)(this,"actions",void 0),(0,o._)(this,"_subscriptions",void 0),this._closeModal=e,this.actions=new U.B7,this._subscriptions=new C.y.Keeper,this._subscriptions.push(this.actions.subscribe((()=>this._closeProofitOrder())))}}class Q{toggleActive(e){return this.active.set(e),this}isRecommended(e){const t=Object.values(m.c.PlanType);return this===[...e].filter((e=>e.details.tier===this.details.tier)).reduce(((e,i)=>t.indexOf(i.details.turnaround)<t.indexOf(e.details.turnaround)?i:e))&&this.details.enabled}constructor(e,t){(0,o._)(this,"details",void 0),(0,o._)(this,"_ops",void 0),(0,o._)(this,"active",void 0),(0,o._)(this,"select",void 0),(0,o._)(this,"unselect",void 0),(0,o._)(this,"placeOrder",void 0),this.details=e,this._ops=t,this.active=p.s.create(!1),this.select=()=>{this._ops._selectPlan(this.details)},this.unselect=()=>{this._ops._selectPlan(null)},this.placeOrder=(e,t)=>this._ops._placeOrder(this.details,e,t)}}!function(e){e.Order="Order",e.Success="Success"}(s||(s={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2"}(n||(n={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2",e[e.Step3=2]="Step3",e[e.Step4=3]="Step4",e[e.Step5=4]="Step5"}(r||(r={})),function(e){e.selectPlanTier=function(e,t){return(0,c._)((0,l._)({},e),{selectedPlanTier:t,selectedPlans:e.plans.filter((e=>e.details.tier===t)).slice(0,3)})},e.selectPlan=function(e,t){const i=L.getEq(m.c.Plan.eq),s=e=>i.equals(t,L.some(e.details)),n=e=>e.toggleActive(s(e));return(0,c._)((0,l._)({},e),{plans:e.plans.map(n),selectedPlans:e.selectedPlans.map(n),selectedPlan:L.fromNullable(e.plans.find(s))})}}(a||(a={}));class W{clearModals(){(0,h.pipe)(this._orderModalViewModelOption,L.map((e=>e.dispose()))),this._orderModalViewModelOption=L.none}newOrderModalViewModel(){const e=new G(this._closeModal);return this._orderModalViewModelOption=L.some(e),e}closeModal(){this.modal.set(L.none),this.leftStep.set(r.Step1),this.rightStep.set(n.Step1),this.freeProofitTermsAgreed.set(!1)}showOrderModal(){this.modal.set(L.some({type:s.Order}))}selectUserInput(e,t){this.viewState.modify(L.map((i=>(0,c._)((0,l._)({},i),{userInputs:(0,c._)((0,l._)({},i.userInputs),{[e]:t})}))))}dispose(){this.clearModals(),this._subscriptions.dispose()}_showPaymentMessage(){return this._notificationsManager.enqueue("paymentSuccess")}_showPaymentError(){return this._notificationsManager.enqueue("paymentError")}_showSuccessModal(){return this._log.info("Show Success Modal"),this._proofit.jobDetails.pipe(f.oE,y.z(this._user.profile,(({dueTime:e},{email:t})=>L.some({type:s.Success,payload:{email:t,dueDate:e}}))),v.$(),b.M(S.H9(this.modal)))}_createErrorNotification(e,t){switch(e){case"payment":return this._notificationsManager.enqueue("proofitPaymentDeclinedError",{paymentMethod:t}).pipe(k.p((e=>"navigateToSubscription"===e)),b.M((()=>window.open(this._config.account.subscription,"_blank"))));case"emptyDocument":return this._notificationsManager.enqueue("proofitEmptyDocumentError");case"alreadyProofread":return this._notificationsManager.enqueue("proofitDocumentProofreadError").pipe(k.p((e=>"navigateToDocuments"===e)),b.M(this._goToMyDocuments));case"complexInternalStructure":return this._notificationsManager.enqueue("proofitComplexInternalStructureError").pipe(k.p((e=>"navigateToDocuments"===e)),b.M(this._goToMyDocuments));case"unknown":return this._notificationsManager.enqueue("error");default:return(0,D.xb)(e)}}_getUserInputs(){return(0,h.pipe)(this.viewState.get(),L.map((({userInputs:e})=>e)),L.getOrElse((0,d.constant)({nativeLanguage:L.none,dialect:L.none,quotationType:L.none,spaceType:L.none,noteToEditor:L.none})))}_updateUserNativeLanguage(){const e=this._getUserInputs();L.getEq(O.w_).equals(e.nativeLanguage,this._initialNativeLanguage)||(0,h.pipe)(e.nativeLanguage,H.Mi((e=>this._user.updateUserNativeLanguage(e)())))}_getPriceOfferId(){const e=this.viewState.get();return(0,D.V1)(!L.isNone(e),"Proofit view state should be initialized"),H.$v(e).priceOfferId}constructor(e,t,i,S,O,H,U){(0,o._)(this,"_subscription",void 0),(0,o._)(this,"_documentModel",void 0),(0,o._)(this,"_ded",void 0),(0,o._)(this,"_user",void 0),(0,o._)(this,"_notificationsManager",void 0),(0,o._)(this,"_router",void 0),(0,o._)(this,"_config",void 0),(0,o._)(this,"modal",void 0),(0,o._)(this,"isVisibleModal",void 0),(0,o._)(this,"noteToEditor",void 0),(0,o._)(this,"isInternalUser",void 0),(0,o._)(this,"freeProofitTermsAgreed",void 0),(0,o._)(this,"requirePaymentCheck",void 0),(0,o._)(this,"viewState",void 0),(0,o._)(this,"subscriptionState",void 0),(0,o._)(this,"braintreeApi",void 0),(0,o._)(this,"leftStep",void 0),(0,o._)(this,"rightStep",void 0),(0,o._)(this,"_orderModalViewModelOption",void 0),(0,o._)(this,"_initialNativeLanguage",void 0),(0,o._)(this,"viewStateAndSubscription",void 0),(0,o._)(this,"_proofit",void 0),(0,o._)(this,"_subscriptions",void 0),(0,o._)(this,"_closeModal",void 0),(0,o._)(this,"changeLeftStep",void 0),(0,o._)(this,"changeRightStep",void 0),(0,o._)(this,"placeOrderAfterAntiFraudCheck",void 0),(0,o._)(this,"onBillingError",void 0),(0,o._)(this,"requestPlans",void 0),(0,o._)(this,"requestStatistics",void 0),(0,o._)(this,"selectPlanTier",void 0),(0,o._)(this,"_selectPlan",void 0),(0,o._)(this,"_placeOrder",void 0),(0,o._)(this,"_onBillingSuccess",void 0),(0,o._)(this,"_log",void 0),(0,o._)(this,"_goToMyDocuments",void 0),this._subscription=e,this._documentModel=t,this._ded=i,this._user=S,this._notificationsManager=O,this._router=H,this._config=U,this.modal=p.s.create(L.none),this.isVisibleModal=this.modal.lens(u.J2.create(L.isSome,((e,t)=>e?t:L.none))),this.viewState=p.s.create(L.none),this.subscriptionState=this._subscription.state,this.braintreeApi=this._subscription.braintreeApi,this.leftStep=p.s.create(r.Step1),this.rightStep=p.s.create(n.Step1),this._orderModalViewModelOption=L.none,this._initialNativeLanguage=L.none,this.viewStateAndSubscription=this.viewState.pipe(y.z(this._subscription.state)),this._subscriptions=new C.y.Keeper,this._closeModal=()=>this.modal.set(L.none),this.changeLeftStep=e=>{this.leftStep.set(e)},this.changeRightStep=e=>{this.rightStep.set(e)},this.placeOrderAfterAntiFraudCheck=e=>{this._log.info("Anti-fraud place order after check"),this._subscriptions.push(this.viewStateAndSubscription.pipe(v.$(),w.T((([e])=>e)),w.T(L.chain((e=>e.selectedPlan))),E.n(L.fold(Promise.resolve,(t=>t.placeOrder(L.some(e),!1))))).subscribe((()=>this._onBillingSuccess()),(()=>this.onBillingError())))},this.onBillingError=()=>{this._subscriptions.push(this._showPaymentError().subscribe())},this.requestPlans=this._ded.contentUpdated.pipe(k.p(g.D_.isTextMaybeWithFormatting),x.Z(1e3),M.Z(void 0),E.n((()=>Promise.all([this._proofit.getPlans(),this._user.getUserNativeLanguage()]))),T.l(A.j.OperationRetrier.RetryStrategy.conditional((e=>"TimeoutError"===e.name||"NotConnectedError"===e.name),A.j.OperationRetrier.RetryStrategy.linear(2,1e3))),b.M((([e,t])=>{this._initialNativeLanguage=(0,h.pipe)(t,K.getOrElse((()=>L.none)));const i=[...e.turnaroundOptions,...e.clarityTurnaroundOptions].map((e=>new Q(e,this))),s={words:e.words,selectedPlanTier:m.c.PlanTier.Base,plans:i,selectedPlans:[],selectedPlan:L.none,proofitState:L.none,statistics:L.none,userInputs:(0,h.pipe)(t,K.fold((()=>e.userInputs),(t=>(0,c._)((0,l._)({},e.userInputs),{nativeLanguage:t,noteToEditor:L.none})))),priceOfferId:e.priceOfferId},n=(e,t)=>e.some((({details:e})=>e.tier===t&&(0,h.pipe)(e.credits,L.fold((()=>!1),(e=>e.canBeUsed&&e.balance>0))))),r=n(i,m.c.PlanTier.Base),o=n(i,m.c.PlanTier.Clarity),d=r&&!o?m.c.PlanTier.Base:m.c.PlanTier.Clarity;this.viewState.set(L.some(a.selectPlanTier(s,d)))})),I.W((e=>(this._log.error("Error querying proofit plan options",e),this._notificationsManager.enqueue("error").pipe(k.p(_.H.isCloseAction),b.M((()=>this.modal.set(L.none))))))),B.j((()=>{this.viewState.set(L.none)})),P.u()),this.requestStatistics=()=>this._proofit.getStatistics().pipe(T.l(A.j.OperationRetrier.RetryStrategy.conditional((e=>"NotConnectedError"===e.name),A.j.OperationRetrier.RetryStrategy.linear(2,1e3))),b.M((e=>{this.viewState.modify(L.map((t=>(0,c._)((0,l._)({},t),{statistics:e}))))})),I.W((e=>(this._log.debug("Error querying proofit statistics",e),F.of(L.none))))),this.selectPlanTier=e=>{this.viewState.modify(L.map((t=>a.selectPlan(a.selectPlanTier(t,e),L.none))))},this._selectPlan=e=>{this.viewState.modify(L.map((t=>a.selectPlan(t,L.fromNullable(e)))))},this._placeOrder=(e,t,i)=>(this._updateUserNativeLanguage(),this._proofit.placeOrder(e,this._getUserInputs(),this._getPriceOfferId(),t,i)),this._onBillingSuccess=()=>{this._subscriptions.push(this._showPaymentMessage().subscribe())},this._log=$.Bx.Logging.getLogger("ProofitView"),this._goToMyDocuments=()=>{this._router.navigateAndReload(V.Lz.routes.documents.href(),{proofitSubmitted:!0})},this._proofit=this._documentModel.proofit,this.isInternalUser=this._user.features.denali.isInternalUser,this.noteToEditor=this._user.features.denali.proofitNoteToEditor;const G=this._subscription.state.get().value;this.requirePaymentCheck=this._user.features.denali.requirePaymentCheck?p.s.create(!0):this.viewState.view((0,d.flow)(L.chain((e=>e.selectedPlan)),L.map((e=>e.details.requirePaymentCheck)),L.getOrElse(d.constFalse))),this.freeProofitTermsAgreed=p.s.create(!1),this._subscriptions.push(this._proofit.state.pipe(b.M((e=>this.viewState.modify(L.map((t=>(0,c._)((0,l._)({},t),{proofitState:e})))))),f.oE,E.n((e=>{switch(e.kind){case"submitted":return this._log.info("Document submitted for proofreading"),this._showSuccessModal();case"finished":case"cancelled":case"sending":return N.w;case"error":return this._log.error("Error sending document for proofreading:",e.errorType),this._createErrorNotification(e.errorType,G.paymentMethod);default:return(0,D.xb)(e)}}))).subscribe()),this._subscriptions.push(this.modal.pipe(R.J(),k.p((([e])=>(0,h.pipe)(e,L.exists((e=>e.type===s.Success)))))).subscribe(this._goToMyDocuments))}}},72204:(e,t,i)=>{i.d(t,{jH:()=>R,zL:()=>L});var s,n=i(23988),r=i(30040),a=i(63336),o=i(80074),l=i(63967),c=i(62597),d=i(22809),h=i(53717),p=i(41797),u=i(95168),m=i(3346),g=i(80837),_=i(38427),f=i(90405),y=i(15491),v=i(74416),b=i(78339),S=i(6987),k=i(96339),C=i(10540),w=i(48209),E=i(82718),x=i(19711),M=i(62822),T=i(36094),A=i(78674),I=i(44297),B=i(58889),P=i(22835),F=i(36840),N=i(69063);function R(e){return t=>({id:t.id,categoryHuman:t.toLiteAlert().categoryHuman,lensId:t.lensId,getHighlightRanges:t.getHighlightRanges,content:(0,a.pipe)(t.transform,I.filter((()=>!(l.Fc.isSuperAlert(t)||l.Fc.isOneGap(t)||l.bU.isSimple(t.extraProperties.cardType)||l.bU.isFullSentence(t.extraProperties.cardType)))),I.chain((0,r.flow)(e,B.fold((e=>(N.Bx.Logging.getLogger("ReportViewModel.hydration").error("Could not hydrate alert",e.error),I.none)),I.some))),B.fromOption((()=>t.highlightTexts)))})}class L{_prepareDownload(){return this._engine.sessionModel.extraSettings.checkedPlagiarism&&!this._features.isFree.get()?this._engine.plagiarismModel.recheck():Promise.resolve()}tryToInterrupt(){this._requestSent.get()||this._finishDownload()}_calculateIssues(e){return e.reduce(((e,t)=>{const i=c.J.OutcomeId.fromOutcomeId(t.lensId),s=t.toLiteAlert(),n=s.categoryHuman;return e[i]=Boolean(e[i])?e[i]:{},e[i][n]=e[i][n]||0,e[i][n]+=s.cost,e}),{})}generateReport(e,t,i){this._requestSent.get()||(this._requestSent.set(!0),this._subs.push(p.H(this._engine.sessionModel.generateReport(e,{headerTemplate:t,footerTemplate:i,format:"Letter",marginTop:"70px",marginBottom:"70px"})).pipe(u.M(this._finishDownload),m.W((e=>(this._log.error("generateReport failed",e),this._notificationsManager.enqueue("error"))))).subscribe()))}_getNonPremiumSortedAlerts(e){return e.map(this._alertDataProcessor)}_getFilteredAlerts(e){return(0,a.pipe)(this._engine.checkingDomain.state.get(),d.A.reduce([],((t,i)=>(e(i.alert)&&t.push(i.alert),t))))}dispose(){this._subs.dispose()}constructor(e,t,i,s,d,B,L,D,O,H){(0,n._)(this,"_engine",void 0),(0,n._)(this,"_profile",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_htmlContent",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"reportData",void 0),(0,n._)(this,"downloadStarted",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_requestSent",void 0),(0,n._)(this,"_visitLenses",void 0),(0,n._)(this,"beginDownload",void 0),(0,n._)(this,"_finishDownload",void 0),(0,n._)(this,"_getReportModel",void 0),(0,n._)(this,"_alertDataProcessor",void 0),(0,n._)(this,"_listenDownload",void 0),this._engine=e,this._profile=t,this._features=i,this._notificationsManager=s,this._htmlContent=d,this._telemetry=H,this.reportData=o.s.create(I.none),this.downloadStarted=o.s.create(!1),this._log=N.Bx.Logging.getLogger("ReportViewModelImpl"),this._subs=new g.y.Keeper,this._requestSent=o.s.create(!1),this._visitLenses=e=>{e.activeLensId.get()!==c.J.SpecialId.Plagiarism&&this._engine.sessionModel.extraSettings.checkedPlagiarism&&e.events.next({type:"switchToLens",id:c.J.SpecialId.Plagiarism,focusFirst:!1,actionSource:l.Kz.sidebar}),e.events.next({type:"switchToLens",id:c.J.SpecialId.AllAlerts,focusFirst:!1,actionSource:l.Kz.sidebar})},this.beginDownload=()=>{this._telemetry.gnarSpec.detailedReportDownloadButtonClick(this._telemetry.pageId,(0,a.pipe)(this._engine.sessionModel.score.get(),I.map(P.Up("rank")),I.getOrElse((0,r.constant)(0)))),this.downloadStarted.set(!0)},this._finishDownload=()=>{this.downloadStarted.set(!1),this._requestSent.set(!1),this.reportData.set(I.none)},this._getReportModel=e=>_.zV(this._engine.sessionModel.title.view((e=>Boolean(e)?e:"Untitled")),this._engine.sessionModel.recentDocumentStats.pipe(f.oE),this._engine.sessionModel.score.pipe(f.oE),this._engine.sessionModel.counters,_.zV(this._features.isPremium,e).pipe(y.T((([e,t])=>e?(0,a.pipe)(t,I.map((e=>({score:v.Q.groupSum.concat(v.Q.MAX,v.Q.groupSum.inverse(v.Q.fromRatio(e.percentile))),sources:e.count,state:A.p.PlagiarismCheckingState.CHECKED,sortedAlerts:this._getFilteredAlerts(l.Fc.isPlagiarism)}))),I.alt((()=>I.some({state:A.p.PlagiarismCheckingState.NOT_CHECKED})))):I.none))),this._htmlContent).pipe(y.T((([e,t,i,s,n,r])=>{const a=this._getFilteredAlerts((0,F.M4)((0,F.M4)(l.Fc.isApplicableAlert,(0,F.AU)(l.Fc.isMuted)),l.Fc.isRegistered));return I.some({sortedAlerts:this._getNonPremiumSortedAlerts(a),dedHTML:r,title:e,author:this._profile.get().fullName,stats:t,score:i.rank,criticalIssues:s.critical,advancedIssues:s.advanced,issues:this._calculateIssues(a),plagiarism:n})}))),this._listenDownload=(e,t,i)=>{this._subs.push(this.downloadStarted.pipe(b.p(Boolean),S.n((()=>p.H(this._prepareDownload()).pipe(k.w(24e3),u.M((()=>this._visitLenses(t()))),C.QE(w.$),S.n((()=>e().flush())),E.K(this._getReportModel(i).pipe(x.$())),m.W((e=>(this._log.error("Error while preparing PDF report",e),this._finishDownload(),this._notificationsManager.enqueue("error").pipe(M.u(I.none))))))))).subscribe(T.H9(this.reportData)))},this._alertDataProcessor=R(B),this._listenDownload(L,D,O.view(h.x.lookup(c.J.SpecialId.Plagiarism)))}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"downloadStarted",o.s.create(!1)),(0,n._)(this,"beginDownload",F.Yi),(0,n._)(this,"tryToInterrupt",F.Yi),(0,n._)(this,"generateReport",(()=>{throw new Error("Method not implemented.")})),(0,n._)(this,"reportData",o.s.create(I.none)),(0,n._)(this,"dedHTML",""),(0,n._)(this,"dispose",F.Yi),(0,n._)(this,"sortedAlerts",void 0),(0,n._)(this,"sortedPlagiarismAlerts",void 0)}}}(s||(s={}))},54872:(e,t,i)=>{i.d(t,{xJ:()=>V,LT:()=>U,XS:()=>q});var s=i(23988),n=i(10334),r=i(17171),a=i(10047),o=i(30040),l=i(63336),c=i(80074),d=i(7432),h=i(34980),p=i(76005),u=i(72106),m=i(14973),g=i(11924),_=i(42543),f=i(15491),y=i(68533),v=i(6987),b=i(36094),S=i(62822),k=i(78339),C=i(8331),w=i(54988),E=i(21216),x=i(95168),M=i(60269),T=i(58347),A=i(21662),I=i(46669),B=i(43308),P=i(30396),F=i(68594),N=i(95710),R=i(36840),L=i(44297),D=i(58193),O=i(47370),H=i(58889),K=i(69063);const $=JSON.parse('{"G":"_f5a63458-view-model-mark"}');var V,U,G;!function(e){e.focus="searchFocus",e.next="searchNext",e.previous="searchPrevious"}(V||(V={})),function(e){var t=e.SEARCH_INPUT_NAME="search-input";e.isSearchInput=function(e){return Boolean(e)&&e.name===t},e.Mock=class{select(){throw new Error("Method not implemented.")}constructor(e){(0,s._)(this,"getBindings",(()=>{throw new Error("Method not implemented.")})),(0,s._)(this,"visible",c.s.create(!1)),(0,s._)(this,"term",c.s.create("")),(0,s._)(this,"result",void 0),(0,s._)(this,"hotkeysActions",new _.B7),(0,s._)(this,"dispose",R.Yi),this.result=c.s.create((0,l.pipe)(L.fromNullable(e),L.map((e=>(0,r._)((0,n._)({},e),{next:R.Yi,prev:R.Yi})))))}}}(U||(U={}));class Q{next(){this._ops._forceSearch(),this._ops._selectedPos.modify((0,o.flow)(L.map((e=>e+1)),L.map((e=>e>this.count-1?0:e)),D.NW(L.some(0)))),this._ops._highlightSelectedRange(1===this.count)}prev(){this._ops._forceSearch(),this._ops._selectedPos.modify((0,o.flow)(L.map((e=>e-1)),L.map((e=>e<0?this.count-1:e)),D.NW(L.some(this.count-1)))),this._ops._highlightSelectedRange()}equals(e){return null!=e&&this.count===e.count&&this.current===e.current&&this._term===e._term}constructor(e,t,i){(0,s._)(this,"_ops",void 0),(0,s._)(this,"_term",void 0),(0,s._)(this,"count",void 0),(0,s._)(this,"current",void 0),this._ops=e,this._term=t,this.count=i.ranges.length,this.current=(0,l.pipe)(i.selected,L.getOrElse((()=>0)))+1,this._ops._highlightSelectedRange()}}!function(e){const t="searchRange";e.create=(e,i)=>d.vY.create(e,i,{type:t}),e.is=function(e){return typeof e.meta.type===t}}(G||(G={}));const W=O.ee(((e,t)=>e.meta.id===t.meta.id));class q{_searchTerm(e,t){let i=-1;const s=[];for(;i=e.indexOf(t,i+1),i>-1;)s.push(G.create(i,i+t.length));return s}_listenOpenEvents(){return m.hJ.activeCount.pipe(f.T((e=>e<1)),y.h(this.visible.pipe(f.T((e=>!e))))).pipe(v.n(b.vh(this.hotkeysActions)),S.u(!0)).subscribe(b.H9(this.visible))}_listenCloseEvents(){const e=N.F.listen("escape");return this.visible.pipe(v.n(b.vh(e)),y.h(m.hJ.activeCount.pipe(k.p((e=>e>0)))),S.u(!1)).subscribe(b.H9(this.visible))}_replaceRanges(e){this._rangesState.modify((t=>(t.ranges.forEach((e=>this._rangeManager.deregisterRange(e.meta.id))),{ranges:e.map((e=>this._rangeManager.registerRange(`search_${this.term.get().replace(/\s*/g,"_")}_${q.searchMarkCount++}`,e))),selected:e.length>0?L.some(0):L.none})))}_ensureMarkInViewport(e){return(0,l.pipe)(e,H.fromOption((()=>new Error("Mark should not be null at this point"))),H.chain((e=>e.getRect())),H.map(h.W.relativeToViewport),H.fold(C.$,(t=>{const{top:i,bottom:s}=this._editorViewport.get();return t.top<i+50||t.top>s-50?this._ded.scrollToMark(D.$v(e).id,{paddingTop:500,animate:p.nA.fast}):w.w})))}constructor(e,t,i){(0,s._)(this,"_ded",void 0),(0,s._)(this,"_rangeManager",void 0),(0,s._)(this,"_editorViewport",void 0),(0,s._)(this,"_log",void 0),(0,s._)(this,"_subs",void 0),(0,s._)(this,"_forceSearchSubject",void 0),(0,s._)(this,"_rangesState",void 0),(0,s._)(this,"_selectedRange",void 0),(0,s._)(this,"_activeMark",void 0),(0,s._)(this,"visible",void 0),(0,s._)(this,"term",void 0),(0,s._)(this,"result",void 0),(0,s._)(this,"hotkeysActions",void 0),(0,s._)(this,"select",void 0),(0,s._)(this,"dispose",void 0),(0,s._)(this,"_selectedPos",void 0),(0,s._)(this,"_forceSearch",void 0),(0,s._)(this,"_highlightSelectedRange",void 0),(0,s._)(this,"getBindings",void 0),(0,s._)(this,"_bindHotkey",void 0),(0,s._)(this,"_removeRanges",void 0),(0,s._)(this,"_findRanges",void 0),(0,s._)(this,"_changeActiveMark",void 0),(0,s._)(this,"_currentMark",void 0),this._ded=e,this._rangeManager=t,this._editorViewport=i,this._log=K.Bx.Logging.getLogger("SearchViewModel"),this._subs=[],this._forceSearchSubject=new _.B7,this._rangesState=c.s.create({ranges:[],selected:L.none}),this._selectedRange=this._rangesState.view((e=>(0,l.pipe)(e.selected,L.chain((t=>a.$I(t,e.ranges)))))),this._activeMark=c.s.create(L.none),this.visible=c.s.create(!1),this.term=c.s.create(""),this.result=c.s.create(L.none),this.hotkeysActions=new _.B7,this.select=()=>{this._forceSearch(),this._rangesState.modify((({ranges:e,selected:t})=>({ranges:e,selected:(0,l.pipe)(t,D.NW(L.some(0)),L.filter((()=>(0,R.z2)(e))))}))),this._highlightSelectedRange()},this.dispose=()=>{this.term.set(""),this._subs.forEach((e=>e.unsubscribe())),this._subs=[]},this._selectedPos=this._rangesState.lens("selected"),this._forceSearch=()=>this._forceSearchSubject.next(),this._highlightSelectedRange=(e=!1)=>{const t=this._selectedRange.get();e&&L.getEq(W).equals(this._activeMark.get(),t)&&this._ensureMarkInViewport(this._currentMark).subscribe({error:e=>this._log.error("Cannot scroll to mark",e)}),this._activeMark.set(t)},this.getBindings=e=>{const t=new Set([g.l.short]),i=E.of(!0);return[{action:V.focus,hotkey:e({modifiers:t,key:"f"}),bind:this._bindHotkey,isActive:i},{action:V.next,hotkey:e({modifiers:t,key:"g"}),bind:this._bindHotkey,isActive:i},{action:V.previous,hotkey:e({modifiers:new Set([g.l.short,g.l.shift]),key:"g"}),bind:this._bindHotkey,isActive:i}]},this._bindHotkey=x.M(this.hotkeysActions),this._removeRanges=e=>{(0,l.pipe)(this._activeMark.get(),L.filter((t=>e.has(t.meta.id))),L.map((()=>this._activeMark.set(L.none)))),this._rangesState.modify((t=>{const i=t.ranges.filter((({meta:{id:t}})=>!e.has(t)||(this._rangeManager.deregisterRange(t),!1)));return{ranges:i,selected:(0,l.pipe)(t.selected,L.filter((e=>e<i.length)))}}))},this._findRanges=e=>(0,R.z2)(e)?this._searchTerm(this._ded.getText().toLowerCase(),e.toLowerCase()):[],this._changeActiveMark=({prev:e,next:t})=>{this._currentMark=L.none,(0,l.pipe)(e,D.Mi((e=>{this._ded.changeMarks([u.J.Change.getRemoveAction({range:()=>e})(e.meta.id)])}))),(0,l.pipe)(t,D.Mi((e=>{this._currentMark=(0,l.pipe)(this._ded.changeMarks([u.J.Change.getCreateAction({range:()=>e,order:0,classes:[$.G]})(e.meta.id)]),(t=>t.created.get(e.meta.id)),L.fromNullable,L.chain(L.fromEither)),this._ensureMarkInViewport(this._currentMark).subscribe({error:e=>this._log.error("Cannot scroll to mark",e)})})))},this._subs.push(this._listenOpenEvents(),this._listenCloseEvents(),M.h(this.term.pipe(k.p((e=>e.length<=3)),S.u("")),this.term.pipe(k.p((e=>e.length>3)),T.B(300)),this._forceSearchSubject.pipe(A.E(this.term,((e,t)=>t)))).pipe(I.F(),f.T(this._findRanges)).subscribe((e=>{this._activeMark.set(L.none),this._replaceRanges(e)})),this._rangesState.pipe(f.T((e=>(0,l.pipe)(e,L.fromPredicate((e=>(0,a.J_)(e.ranges))),L.map((e=>new Q(this,this.term.get(),e))))))).subscribe((e=>this.result.set(e))),this._rangesState.pipe(v.n((({ranges:e})=>(0,a.J_)(e)?this._rangeManager.rangeChanged.pipe(B.E("affected"),k.p(a.J_)):w.w)),f.T((e=>e.filter(G.is))),f.T((e=>new Set(e.map((e=>e.meta.id)))))).subscribe(this._removeRanges),this._activeMark.pipe(P.S((({next:e},t)=>({prev:e,next:t})),{prev:L.none,next:L.none})).subscribe(this._changeActiveMark)),this._subs.push(this._ded.dontFreezeWhen(this.visible,"search"),this.visible.pipe(F.i(1),k.p((e=>!e))).subscribe((()=>{this.term.set("")}))),(0,R.hJ)("searchVM",this)}}(0,s._)(q,"searchMarkCount",0)},18286:(e,t,i)=>{i.d(t,{J:()=>s});var s,n=i(86562),r=i(69063),a=i(704);!function(e){const t=(e,t)=>({pageId:i,placement:s,bannerType:r,advancedAlerts:a=[],inline:o=!1,numberOfAdvancedAlerts:l,numberOfCriticalAlerts:c,sessionUuid:d,upgradeHookName:h,upgradeHookSlot:p,upgradeHookVariant:u})=>{const m=a.reduce(((e,t)=>{const i=t.lensType;return e[i]=e[i]?e[i]+1:1,e}),{}),g=t[(e=>{switch(e){case"show":return"getPremiumButtonShow";case"click":return"getPremiumButtonClick";case"dismiss":return"dismissUpHookButtonClick";default:return(0,n.AS)(e)}})(e)].bind(t);return g(i,r,m.clarity,m.correctness,m.delivery,m.engagement,o,(null!=l?l:a.length>0)?a.length:void 0,c,s,d,h,p,u)},i=e=>({pageId:t,upgradeHookName:i,upgradeHookSlot:s,upgradeHookVariant:o})=>r.Bx.TimeSeries.rootFemetrics.getMetric(a.P.Metrics.GetPremiumButton).getCounter("show"===e?a.P.MetricsActions.Show:"click"===e?a.P.MetricsActions.Click:(0,n.AS)(e)).setContext({pageId:t,upgradeHookName:i,upgradeHookSlot:s,upgradeHookVariant:o}).increment();e.create=e=>({trackShow:t("show",e),trackClick:t("click",e),trackDismiss:t("dismiss",e),countShow:i("show"),countClick:i("click")})}(s||(s={}))},45032:(e,t,i)=>{i.d(t,{Q:()=>s,t:()=>k});var s,n=i(23988),r=i(63336),a=i(80074),o=i(63967),l=i(80536),c=i(72400),d=i(62597),h=i(22809),p=i(74416),u=i(80837),m=i(44297),g=i(36840),_=i(23121),f=i(58889),y=i(76720),v=i(69063),b=i(18711),S=i(40884);!function(e){e.Mock=class{constructor(){(0,n._)(this,"advancedAlerts",a.s.create(m.none)),(0,n._)(this,"openUpgradeUrl",g.Yi),(0,n._)(this,"assignToFreeTrialEuUkExperiment",g.Yi),(0,n._)(this,"assignToProVsPremiumExperiment",g.Yi),(0,n._)(this,"fromGbVoxUpHookLens",g.Yi),(0,n._)(this,"fromGrammarlyGO",g.Yi),(0,n._)(this,"enableGBVoxHookLens",g.Yi),(0,n._)(this,"displayValue",(()=>"")),(0,n._)(this,"isEligibleForFreeTrial",void 0),(0,n._)(this,"isEligibleForFreeTrialEuUk",void 0),(0,n._)(this,"isEligibleForPro",void 0)}}}(s||(s={}));class k{_formatLiteAlerts(e){const t=e.slice(0,5),i=e.slice(5).map((e=>e.count)).reduce(g.cz,0);return i>0?[...t,{group:"",category:"",categoryHuman:"more...",count:i,lensName:"more...",bundleInfo:m.some("more...")}]:t}openUpgradeUrl(e){(0,r.pipe)(_.zb((()=>this._createUpgradeUrl(e))),f.chain(this._environment.actions.openUrl),f.getOrElse((e=>this._log.fatal("unexpected error on open upgrade page",e))))}fromGbVoxUpHookLens(){(0,r.pipe)(_.zb((()=>this._upgradeHook.fromGbVoxUpHookLens())),f.chain(this._environment.actions.openPopup),f.getOrElse((e=>this._log.fatal("unexpected error on open upgrade page",e))))}fromGrammarlyGO(){(0,r.pipe)(_.zb((()=>this._upgradeHook.fromGrammarlyGO())),f.chain(this._environment.actions.openPopup),f.getOrElse((e=>this._log.fatal("unexpected error on open upgrade page for GrammarlyGO",e))))}enableGBVoxHookLens(){(0,r.pipe)(_.zb((()=>new y.U(this._config.account.styleGuide))),f.chain(this._environment.actions.openPopup),f.getOrElse((e=>this._log.fatal("unexpected error on open admin style guide page",e))))}displayValue(e){return(0,r.pipe)(this._uphookFormat,m.map((t=>t===S.SA.layoutGroup?e.lensName:(0,r.pipe)(e.bundleInfo,m.getOrElse((()=>e.categoryHuman))))),m.getOrElse((()=>e.categoryHuman)))}_noRemovedFilter(e){return t=>!o.Fc.isRemoved(t)&&e(t)}_getGroupedLiteAlerts(e){return(0,r.pipe)(this._checkingDomain.state.get(),h.A.reduce([],((t,i)=>(this._noRemovedFilter(e)(i.alert)&&t.push(i.alert.toLiteAlert()),t))),(0,r.pipe)(this._uphookFormat,m.map((e=>e===S.SA.layoutGroup?l.D.groupByGroup:l.D.groupByBundleInfo)),m.getOrElse((()=>l.D.group))))}_getGroupedLensAlerts(e){return(0,r.pipe)(this._checkingDomain.state.get(),h.A.reduce([],((t,i)=>(this._noRemovedFilter(e)(i.alert)&&t.push(i.alert.toLensAlert()),t))),c.N.group)}_getPlagiarismPercent(){return this._lensPreviewVM.getLens(d.J.SpecialId.Plagiarism).view("percentile").view(p.Q.fromRatio)}dispose(){this._subs.dispose()}get isEligibleForFreeTrial(){return this._checkEligibleForFreeTrial()}get isEligibleForFreeTrialEuUk(){return this._checkEligibleForFreeTrialEuUk()}assignToFreeTrialEuUkExperiment(){return this._expClient.getTreatment(b.PremiumFreeTrialEuUk)}get isEligibleForPro(){return this._proVsPremiumExperiment}assignToProVsPremiumExperiment(){this._assignProVsPremiumExperiment()}constructor(e,t,i,s,a,l,c,h,p,_,f,y,b,k){(0,n._)(this,"_checkingDomain",void 0),(0,n._)(this,"_lensPreviewVM",void 0),(0,n._)(this,"_docId",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"_upgradeHook",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_uphookFormat",void 0),(0,n._)(this,"_uphookDestination",void 0),(0,n._)(this,"_isSmartPlagiarismUphookEnabled",void 0),(0,n._)(this,"_expClient",void 0),(0,n._)(this,"_checkEligibleForFreeTrial",void 0),(0,n._)(this,"_checkEligibleForFreeTrialEuUk",void 0),(0,n._)(this,"_proVsPremiumExperiment",void 0),(0,n._)(this,"_assignProVsPremiumExperiment",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"advancedAlerts",void 0),(0,n._)(this,"_createUpgradeUrl",void 0),this._checkingDomain=e,this._lensPreviewVM=t,this._docId=i,this._environment=s,this._upgradeHook=a,this._config=l,this._uphookFormat=c,this._uphookDestination=h,this._isSmartPlagiarismUphookEnabled=p,this._expClient=_,this._checkEligibleForFreeTrial=f,this._checkEligibleForFreeTrialEuUk=y,this._proVsPremiumExperiment=b,this._assignProVsPremiumExperiment=k,this._log=v.Bx.Logging.getLogger("UpgradeViewModel"),this._subs=new u.y.Keeper,this.advancedAlerts=this._lensPreviewVM.getLens(d.J.SpecialId.Premium).view((({count:e})=>e>0?(0,r.pipe)(m.some({count:e,alerts:()=>this._formatLiteAlerts(this._getGroupedLiteAlerts((e=>o.Fc.isPremium(e))))}),m.filter((({alerts:e})=>(0,g.z2)(e())))):m.none)),this._createUpgradeUrl=e=>{const t=this._upgradeHook.fromDenaliDocumentToPlans(e,this._docId,this._getGroupedLiteAlerts((0,g.AU)(o.Fc.isPlagiarism)),this._getGroupedLensAlerts((0,g.AU)(o.Fc.isPlagiarism)),this._isSmartPlagiarismUphookEnabled?this._getPlagiarismPercent():void 0);return m.isNone(this._uphookDestination)?t:this._uphookDestination.value===S.fx.plansPage?t.addParams({redirectUphookToUpgradePageExp:"1"}):this.isEligibleForFreeTrial?this._upgradeHook.fromDenaliDocumentToUpgradeTry(e,this._docId):this._upgradeHook.fromDenaliDocumentToUpgrade(e,this._docId)}}}},33373:(e,t,i)=>{i.d(t,{M:()=>_,U:()=>s});var s,n=i(23988),r=i(30040),a=i(11603),o=i(65621),l=i(15491),c=i(5692),d=i(89769),h=i(54988),p=i(44297),u=i(36840),m=i(81870),g=i(98719);class _{isUploaded(e,t){const i=(0,r.pipe)(this._appRouter.locationState,p.chain((e=>p.fromNullable(e.uploadedFileType)))),s=(0,r.pipe)(this._appRouter.locationState,p.chain((e=>p.fromNullable(e.uploadedFileName)))),n=void 0!==e?(0,r.pipe)(i,p.exists((t=>t===e))):p.isSome(i),a=void 0!==t?(0,r.pipe)(s,p.exists((e=>t.test(e)))):p.isSome(s);return n||a}dispose(){this.uploadModel.dispose()}constructor(e,t,i,r,h,p){(0,n._)(this,"_doxApi",void 0),(0,n._)(this,"_appRouter",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_upload",void 0),(0,n._)(this,"_navigateToDocument",void 0),(0,n._)(this,"uploadModel",void 0),(0,n._)(this,"state",void 0),this._doxApi=e,this._appRouter=t,this._notificationsManager=i,this._telemetry=r,this._environment=h,this._config=p,this._upload=e=>this._doxApi.createDocument(a.Jo.Create.file(e,a.Jo.UploadFileMode.plain)),this._navigateToDocument=(e,t)=>this._appRouter.navigate(m.Lz.routes.denali_editor.href({docId:e}),t),this.uploadModel=new g.DJ.UploadModelImpl((e=>this._upload(e)),this._navigateToDocument.bind(this),this._telemetry,this._notificationsManager,this._environment,this._config),this.state=this.uploadModel.state.pipe(o.J(),l.T((([e,t])=>c.j.isInProgress(t)?s.State.loading:c.j.isOk(t)||c.j.isIdle(t)&&c.j.isOk(e)?s.State.uploaded:s.State.idle)),d.Z(s.State.idle))}}!function(e){let t;!function(e){e.idle="idle",e.loading="loading",e.uploaded="uploaded"}(t=e.State||(e.State={})),e.Mock=class{isUploaded(e,t){throw new Error("Method not implemented.")}showUploadNotificationIfNeeded(){throw new Error("Method not implemented.")}constructor(){(0,n._)(this,"uploadModel",{navigated:u.Yi}),(0,n._)(this,"state",h.w),(0,n._)(this,"dispose",u.Yi)}}}(s||(s={}))},92468:(e,t,i)=>{i.d(t,{R:()=>T});var s=i(10334),n=i(17171),r=i(50659),a=i(86922),o=i(19967),l=i(14973),c=i(65873),d=i(11864),h=i(27199);const p={width:d.Ks.rem(31)},u={backgroundColor:h.Q1.CoreNeutral0,paddingBottom:0},m={paddingTop:d.Ks.rem(1)},g={display:"grid",gridTemplateColumns:"4fr 2fr 5fr",marginBottom:d.Ks.rem(1)},_={marginBottom:d.Ks.rem(.3)},f={paddingTop:d.Ks.rem(.3)},y={marginRight:d.Ks.rem(.25)},v={fontSize:d.Ks.rem(.75),color:h.Q1.CoreNeutral50,marginBottom:d.Ks.rem(2)},b=d.Ks.stylesheet({wrapper:[p],header:[u],content:[m],offer:[g],plan:[{display:"flex",flexDirection:"column"}],planTitle:[_],arrow:[f],badge:[y],subMonthlyPrice:[v]});var S=i(35198);const k=()=>r.createElement("svg",{"aria-hidden":!0,width:"31",height:"13",viewBox:"0 0 31 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M1 6.5H30M30 6.5L24.5 1M30 6.5L24.5 12",stroke:"#0E101A",strokeLinecap:"round"}));var C=i(83683);const w=({current:e})=>r.createElement("div",{className:b.plan},r.createElement(c.H4,{className:b.planTitle},e.title),r.createElement(c.C6,null,r.createElement(C.J9,(0,n._)((0,s._)({},e.regularPriceMoney),{periodInMonths:e.periodMonths})),r.createElement("div",{className:b.subMonthlyPrice},r.createElement(C.Ly,(0,n._)((0,s._)({},e.regularPriceMoney),{periodInMonths:e.periodMonths}))))),E=({offer:e,saved:t})=>{const i=r.useContext(a.S.Context).changePlan;return r.createElement("div",{className:b.plan},r.createElement(c.H4,{className:b.planTitle},e.title),r.createElement(c.C6,null,r.createElement(C.J9,(0,n._)((0,s._)({},e.regularPrice),{periodInMonths:e.periodInMonths})),"",r.createElement(S.E.Regular,{className:b.badge},i.savedBadge(t.percent)),r.createElement("div",{className:b.subMonthlyPrice},r.createElement(C.Ly,(0,n._)((0,s._)({},e.regularPrice),{periodInMonths:e.periodInMonths})))))},x=({current:e,offer:t,saved:i})=>r.createElement("div",{className:b.offer},r.createElement(w,{current:e}),r.createElement("div",{className:b.arrow},r.createElement(k,null)),r.createElement(E,{offer:t,saved:i})),M=e=>{const t=r.useContext(a.S.Context).changePlan,i=r.useContext(l.aF.TitleIdContext);return r.createElement(c.H2,{id:i},t.title(r.createElement(C.J9,(0,n._)((0,s._)({},e.savedPrice.pricePerYear),{periodInMonths:12}))))},T=({changePlanViewModel:{currentPlan:e,offer:t,savedPrice:i,nextPaymentDate:s,changePlan:n,close:d}})=>{const h=r.useContext(a.S.Context).changePlan;return r.createElement(l.aF,{className:b.wrapper},r.createElement(l.aF.Header,{className:b.header},r.createElement(M,{savedPrice:i})),r.createElement(l.aF.Body,{name:"change.plan.body",className:b.content},r.createElement(r.Fragment,null,r.createElement(x,{current:e,offer:t,saved:i}),r.createElement(c.jN,null,h.confirmationDescription(e.title,s,r.createElement(C.X0,t.price),r.createElement(C.X0,t.regularPrice),t.periodInMonths)))),r.createElement(l.aF.Footer,null,r.createElement(o.$n.Ghost,{name:"modal.cancel",onClick:d},h.cancelButton),r.createElement(o.$n.Primary,{name:"confirm.change.to.annual",onClick:n},h.confirmationButton(t.title))))}},83683:(e,t,i)=>{i.d(t,{J9:()=>l,Ly:()=>o,X0:()=>a});var s=i(50659),n=i(86922),r=i(38908);const a=({value:e,currency:t})=>{const i="USD"===t?"$":`${t} `;return s.createElement(s.Fragment,null,i,r.$g(e))},o=({value:e,currency:t,periodInMonths:i})=>{const r=e/Math.max(1,i),o=s.useContext(n.S.Context).changePlan;return s.createElement(s.Fragment,null,s.createElement(a,{currency:t,value:r}),"/",o.perMonth)},l=({value:e,currency:t,periodInMonths:i})=>{const r=e/Math.max(1,i)*12,o=s.useContext(n.S.Context).changePlan;return s.createElement(s.Fragment,null,s.createElement(a,{currency:t,value:r}),"/",o.perYear)}},9654:(e,t,i)=>{i.d(t,{uF:()=>De,zz:()=>Le,JG:()=>Oe});var s=i(23988),n=i(10334),r=i(50659),a=i(10047),o=i(30720),l=i(61198),c=i(61790),d=i(53005),h=i(15491),p=i(86562),u=i(80300),m=i(78450),g=i(76720),_=i(40884);class f{get isBusinessAdmin(){return _.DY.isBusinessAdmin(this._userAccount.features.denaliUserType)}constructor(e,t,i,n){(0,s._)(this,"_userAccount",void 0),(0,s._)(this,"_config",void 0),(0,s._)(this,"_environment",void 0),(0,s._)(this,"_telemetry",void 0),(0,s._)(this,"dismiss",void 0),(0,s._)(this,"updatePayment",void 0),this._userAccount=e,this._config=t,this._environment=i,this._telemetry=n,this.dismiss=()=>{this._userAccount.settings.incrementDunningDismissCount()},this.updatePayment=()=>{this._telemetry.gnarSpec.inProductDunningNoticationUpdatePaymentInformationButtonClick(this._telemetry.pageId),this._environment.actions.openPopup(new g.U(this._config.account.subscription))}}}var y=i(17171),v=i(80074),b=i(78323),S=i(66799),k=i(82636),C=i(29862),w=i(37107);const E=k.x.Category.Id.create(S.xD.SpecialCategory.InQuotes);class x{constructor(e,t,i,r){(0,s._)(this,"_denaliSettings",void 0),(0,s._)(this,"_categoriesModel",void 0),(0,s._)(this,"_features",void 0),(0,s._)(this,"_telemetry",void 0),(0,s._)(this,"_preferencesModel",void 0),(0,s._)(this,"_newPreferences",void 0),(0,s._)(this,"trackOpened",void 0),(0,s._)(this,"trackSuggestionManagementClicked",void 0),(0,s._)(this,"update",void 0),(0,s._)(this,"autoScrollToNextAlert",void 0),(0,s._)(this,"fontSize",void 0),(0,s._)(this,"suggestionsVisualMode",void 0),(0,s._)(this,"muteQuotedAlerts",void 0),this._denaliSettings=e,this._categoriesModel=t,this._features=i,this._telemetry=r,this._preferencesModel=this._denaliSettings.editorPreferences,this._newPreferences=v.s.create(this._denaliSettings.editorPreferences.get()),this.trackOpened=()=>{this._telemetry.gnarSpec.preferencesPopupShow(this._telemetry.pageId)},this.trackSuggestionManagementClicked=()=>{this._telemetry.gnarSpec.deactivatedSuggestionsSuggestionManagementClick(this._telemetry.pageId,"editorSettings",this._telemetry.pageSessionId)},this.update=()=>{const e=this._newPreferences.get(),t=this._categoriesModel.getMutedSpecialCategories().has(E),i=this.muteQuotedAlerts.get(),s=t!==i,n=!w.$u.eq.equals(this._preferencesModel.get(),e)||s;e.suggestionsVisualMode!==this._preferencesModel.get().suggestionsVisualMode&&this._telemetry.gnarSpec.suggestionsVisualModeFeatureToggled(this._telemetry.pageId,e.suggestionsVisualMode,this._telemetry.pageSessionId),n&&(this._denaliSettings.updateEditorPreferences(e),this._telemetry.gnarSpec.preferencesFormSuccess(this.autoScrollToNextAlert.get(),e.fontSize,i,this._telemetry.pageId,e.suggestionsVisualMode)),s&&(t?(this._categoriesModel.unmuteCategories([E]),this._telemetry.gnarSpec.muteQuotedAlertsFeatureToggled(this._telemetry.pageId,"unmuted",this._telemetry.pageSessionId)):(this._categoriesModel.muteCategories([E]),this._telemetry.gnarSpec.muteQuotedAlertsFeatureToggled(this._telemetry.pageId,"muted",this._telemetry.pageSessionId)))},this.autoScrollToNextAlert=this._newPreferences.lens("autoScrollToNextAlert").lens(C.O.unwrap(!this._features.autoJumpSettings.isDisabledByDefault)),this.fontSize=this._newPreferences.lens(b.J2.create((e=>e.fontSize===w.Z4.Large),((e,t)=>(0,y._)((0,n._)({},t),{fontSize:e?w.Z4.Large:w.Z4.Normal})))),this.suggestionsVisualMode=this._newPreferences.lens(b.J2.create((e=>e.suggestionsVisualMode===w.pK.Accessible),((e,t)=>(0,y._)((0,n._)({},t),{suggestionsVisualMode:e?w.pK.Accessible:w.pK.Default})))),this.muteQuotedAlerts=v.s.create(this._categoriesModel.getMutedSpecialCategories().has(E))}}var M=i(35382),T=i(63336),A=i(35413),I=i(36094),B=i(62723),P=i(6987),F=i(21216),N=i(14342),R=i(62822),L=i(88423),D=i(89769),O=i(38169),H=i(70365),K=i(88e3),$=i(44297),V=i(58889),U=i(69063);class G{constructor(e,t,i,n){(0,s._)(this,"reportViewModel",void 0),(0,s._)(this,"_documentModel",void 0),(0,s._)(this,"_notificationsManager",void 0),(0,s._)(this,"_modalOperations",void 0),(0,s._)(this,"state",void 0),(0,s._)(this,"onModalClose",void 0),this.reportViewModel=e,this._documentModel=t,this._notificationsManager=i,this._modalOperations=n,this.state=A.v((()=>I.RF((()=>this._documentModel.calculateStats())))).pipe(B.z(this._documentModel.checkingState,((e,t)=>(0,T.pipe)(e,$.filter((()=>"idle"===t))))),P.n($.fold((()=>F.of({type:K.K.State.Type.LOADING}).pipe(N.c(150))),V.fold((e=>(U.Bx.Logging.getLogger("editor.toolbar").error("Error on requesting document stats",e),this._notificationsManager.enqueue("statisticsError").pipe(R.u({type:K.K.State.Type.ERROR}),L.j((()=>this.onModalClose()))))),(e=>v.s.combine(this._documentModel.score,this._documentModel.counters,this._documentModel.documentLength.view("trimmed"),((t,i,s)=>(0,T.pipe)(t,$.fold((()=>({type:K.K.State.Type.SHORT_CONTENT})),(t=>({type:K.K.State.Type.READY,documentIsEmpty:0===s,score:t,counters:i,stats:e})))))))))),D.Z({type:K.K.State.Type.EMPTY}),O.H(1),H.B()),this.onModalClose=()=>{this._modalOperations.onClose()}}}var Q,W=i(30040),q=i(17223),z=i(98126),j=i(95168),J=i(58193),Y=i(22835),Z=i(36840),X=i(1424),ee=i(18286);!function(e){let t,i;!function(e){e[e.SMALL=0]="SMALL",e[e.LARGE=1]="LARGE"}(t=e.Type||(e.Type={})),function(e){e[e.SHOW_ALL=0]="SHOW_ALL",e[e.HIDE_PREV=1]="HIDE_PREV",e[e.HIDE_NEXT=2]="HIDE_NEXT",e[e.HIDE_BOTH=3]="HIDE_BOTH"}(i=e.NavigationControlDisplay||(e.NavigationControlDisplay={}))}(Q||(Q={}));class te{start(){this._currentStepIndex.set($.some(0)),this._onStart()}constructor(e,t,i,n,r=Z.Yi){(0,s._)(this,"type",void 0),(0,s._)(this,"_stepMap",void 0),(0,s._)(this,"_settings",void 0),(0,s._)(this,"_modalOperations",void 0),(0,s._)(this,"_onStart",void 0),(0,s._)(this,"_steps",void 0),(0,s._)(this,"_currentStepIndex",void 0),(0,s._)(this,"_abort",void 0),(0,s._)(this,"_getStepForIndex",void 0),(0,s._)(this,"descriptionMeta",void 0),(0,s._)(this,"currentStep",void 0),(0,s._)(this,"goToNext",void 0),(0,s._)(this,"goToPrev",void 0),this.type=e,this._stepMap=t,this._settings=i,this._modalOperations=n,this._onStart=r,this._steps=this.type===_.fO.TourType.migration?te._migrationTour:te._welcomeTour,this._currentStepIndex=v.s.create($.none),this._abort=()=>{this._settings.denaliWelcomeTourSeen(),this._modalOperations.onClose(),this._currentStepIndex.set($.none)},this._getStepForIndex=e=>{const t=this._steps[e],i=this._stepMap[t.stepId];switch(i.type){case Q.Type.LARGE:var s;return{stepId:t.stepId,type:i.type,index:e,content:i.renderContent(),description:i.renderDescription.bind(i),navigationControl:null!==(s=t.navigationControl)&&void 0!==s?s:Q.NavigationControlDisplay.SHOW_ALL};case Q.Type.SMALL:return{stepId:t.stepId,type:i.type,index:e,content:i.renderContent({type:this.type,abort:this._abort,goToNext:this.goToNext,goToPrev:this.goToPrev}),navigationControl:Boolean(t.navigationControl)?t.navigationControl:Q.NavigationControlDisplay.HIDE_BOTH};default:return(0,p.xb)(i)}},this.descriptionMeta=this._currentStepIndex.view($.map((e=>({index:e,steps:this._steps.length})))).view($.map((({index:e,steps:t})=>({index:e<1||e>=t-1?e:e-1,totalSteps:t-2})))),this.currentStep=this._currentStepIndex.view($.map(this._getStepForIndex)),this.goToNext=()=>this._currentStepIndex.modify($.chain((e=>{const t=e+1;return Boolean(this._steps[t])?$.some(t):(this._settings.denaliWelcomeTourSeen(),this._modalOperations.onClose(),$.none)}))),this.goToPrev=()=>this._currentStepIndex.modify($.map((e=>{const t=e-1;return Boolean(this._steps[t])?t:0})))}}(0,s._)(te,"_migrationTour",[{stepId:"welcomeOldUser"},{stepId:"fastApply",navigationControl:Q.NavigationControlDisplay.HIDE_PREV},{stepId:"assistant"},{stepId:"checkTypes"},{stepId:"goals"},{stepId:"finalOldUser",navigationControl:Q.NavigationControlDisplay.HIDE_NEXT}]),(0,s._)(te,"_welcomeTour",[{stepId:"welcomeNewUser"},{stepId:"fastApply",navigationControl:Q.NavigationControlDisplay.HIDE_PREV},{stepId:"assistant"},{stepId:"checkTypes"},{stepId:"goals"},{stepId:"finalNewUser",navigationControl:Q.NavigationControlDisplay.HIDE_NEXT}]);class ie{get showOnboardingTourA11yUpdates(){return this._features.showOnboardingTourA11yUpdates}constructor(e,t,i){(0,s._)(this,"_settings",void 0),(0,s._)(this,"_features",void 0),(0,s._)(this,"_modalOperations",void 0),(0,s._)(this,"close",void 0),this._settings=e,this._features=t,this._modalOperations=i,this.close=()=>{this._settings.denaliWelcomeTourSeen(),this._modalOperations.onClose()}}}var se=i(14973),ne=i(92468);const re=({changePlanViewModel:e})=>r.createElement(se.Gd,{positionType:"fixed",animate:!0,smallResolution:"resize",onClose:e.close},r.createElement(ne.R,{changePlanViewModel:e}));var ae=i(994),oe=i(19967),le=i(10486),ce=i(65873),de=i(19711),he=i(20408),pe=i(63839);const ue=JSON.parse('{"iE":"_8d820c72-feedback-popup-wrapper","h_":"_5a633a50-feedback-popup-description","TP":"_dde4098c-feedback-popup-briefDescriptionInput","cG":"_8af6c552-feedback-popup-feedbackInput","NZ":"_83d6ee84-feedback-popup-helpdesk","oB":"_52a56165-feedback-popup-feedbackPopupBody","F1":"_001a2b32-feedback-popup-feedbackPopupFooter"}'),me=()=>{const e=r.useContext(se.aF.TitleIdContext);return r.createElement(ce.H1,{id:e},"Send Product Feedback")},ge=({feedbackViewModel:e,modalOperations:t})=>{const i=r.useContext(he._.Context),s=v.s.create(!0);return r.useEffect((()=>{e.modalShown.next();const i=s.pipe(de.$((e=>!1===e))).subscribe(t.onClose);return()=>i.unsubscribe()}),[e.modalShown,s,t.onClose]),r.createElement(se.hJ,{positionType:"fixed",visible:s,preventClose:!0,animate:!0},r.createElement(se.aF,{className:ue.iE},r.createElement(se.aF.Header,null,r.createElement(me,null)),r.createElement(se.aF.Body,{className:ue.oB,name:"feedbackBody"},r.createElement(ce.P1,{className:ue.h_},"Tell us what you think. We promise to act on your feedback to make Grammarly even more awesome."),r.createElement(le.pd,{autofocus:!0,value:e.currentText.lens("brief"),placeholder:"Brief description",className:ue.TP}),r.createElement(le.fs,{placeholder:"Type your feedback",className:ue.cG,value:e.currentText.lens("detailed")}),r.createElement(ce.C6,null,"If you have a support or billing-related request, please go to"," ",r.createElement(pe.M,{href:i.support.mainPage,target:"_blank",className:ue.NZ},"Grammarly Helpdesk"))),r.createElement(se.aF.Footer,{className:ue.F1},r.createElement(oe.$n.Ghost,{name:"cancel",onClick:()=>s.set(!1)},"Cancel"),r.createElement(oe.$n.Primary,{name:"send",disabled:e.currentText.view((e=>""===e.brief||""===e.detailed)),onClick:()=>(s.set(!1),e.sendFeedback())},"Send"))))};var _e=i(19840),fe=i(86922),ye=i(27917),ve=i(11864),be=i(19772),Se=i(50581),ke=i(27199),Ce=i(85921);const we=e=>r.createElement(se.Gd,{positionType:"fixed",animate:!0,onClose:e.modalOperations.onClose},r.createElement(xe,{preferencesViewModel:e.preferencesViewModel,close:e.modalOperations.onClose})),Ee=()=>{const e=r.useContext(fe.S.Context),t=r.useContext(se.aF.TitleIdContext);return r.createElement(ce.H1,{id:t},e.editorSettingsModalHeader)},xe=({preferencesViewModel:e,close:t})=>{const i=r.useContext(fe.S.Context);return be.R.useEffectOnDidMount(e.trackOpened),be.R.useEffectOnWillUnmount(e.update),r.createElement(se.aF,{className:Re.popupWrapper},r.createElement(se.aF.Header,{className:Re.popupHeader},r.createElement(Ee,null)),r.createElement(se.aF.Body,{name:"preferencesBody",className:Re.popupBody},r.createElement(Be,{value:e.autoScrollToNextAlert,id:"autoScrollSwitcher",title:i.preferences.autoJumpToNextAlert,description:i.preferences.autoJumpToNextAlertDescription}),r.createElement(Be,{value:e.muteQuotedAlerts,id:"muteCitedAlerts",title:i.preferences.muteQuotedAlerts}),r.createElement(Be,{value:e.fontSize,id:"fontSizeIncreasedSwitcher",title:i.preferences.increaseFontSize}),r.createElement(Be,{value:e.suggestionsVisualMode,id:"suggestionsVisualModeSwitcher",title:i.preferences.suggestionsVisualMode.title,description:i.preferences.suggestionsVisualMode.descritionSDUI}),r.createElement(Ie,{onClick:e.trackSuggestionManagementClicked})),r.createElement(se.aF.Footer,null,r.createElement(oe.$n.Primary,{name:"pref-done-btn",className:Re.doneButton,onClick:t},i.done)))},Me=({children:e})=>r.createElement(ce.Oc,{className:Re.description},e),Te=({children:e,className:t})=>r.createElement("section",(0,_e.Ly)(Re.bodySection,t),e),Ae=e=>{const t=r.useContext(he._.Context),i=r.useContext(fe.S.Context).preferences;return r.createElement(oe.$n,{name:"manage-suggestions",href:t.account.suggestions,target:"_blank",onClick:e.onClick,className:Re.manageSuggestions},i.suggestionManagementLink,r.createElement(ye.In.OuterLink,{className:Re.manageSuggestionsIcon}))},Ie=e=>{const t=r.useContext(fe.S.Context).preferences;return r.createElement(Te,null,r.createElement(Ae,{onClick:e.onClick}),r.createElement(Me,null,t.suggestionManagementDescription))},Be=({value:e,id:t,title:i,description:s,className:n})=>r.createElement(Te,{className:Se.classes(Re.setting,n)},r.createElement("label",{id:t},r.createElement(ce.C6,null,i),Boolean(s)?r.createElement(Me,null,s):null),r.createElement(Ce.L,{checked:e,className:Re.toggle,name:t,ariaLabelledBy:t})),Pe=ve.Ks.rem(2),Fe=ve.Ks.rem(1),Ne=ke.Q1.CoreBlue50,Re=ve.Ks.prefixedStylesheet("preferencePopup",{popupWrapper:[{display:"flex",flexDirection:"column",width:ve.Ks.rem(27),userSelect:"none"}],popupHeader:[{padding:`${ve.Ks.rem(3)} ${Pe} ${Fe}`,backgroundColor:ke.Q1.CoreNeutral0}],popupBody:[{padding:`0 ${Pe}`}],doneButton:[{padding:ve.Ks.important(`0 ${Fe}`)}],bodySection:[{padding:`${Fe} 0`,borderTop:`1px solid ${ke.Q1.CoreNeutral20}`}],description:[{color:ke.Q1.CoreNeutral50,marginTop:ve.Ks.rem(.5),whiteSpace:"pre-line"}],selectableLabel:[{userSelect:"text",cursor:"text"}],setting:[{display:"flex",cursor:"pointer",justifyContent:"space-between"}],toggle:[{marginLeft:ve.Ks.rem(1.75),marginTop:ve.Ks.rem(.125)}],manageSuggestions:[{display:"flex",alignItems:"center",color:Ne,fontSize:ve.Ks.rem(ke.EY.BodySize),fontWeight:ke.EY.BodyWeight,lineHeight:ve.Ks.rem(2),marginTop:ve.Ks.rem(-.3125)}],manageSuggestionsIcon:[{stroke:"currentColor"}]});var Le,De;!function(e){e.Tour="Tour",e.WhatsNew="WhatsNew",e.Proofit="Proofit",e.Preferences="Preferences",e.Feedback="Feedback",e.ChangePlan="ChangePlan",e.Dunning="Dunning",e.SignOut="SignOut"}(Le||(Le={})),function(e){e.tour={type:Le.Tour},e.news={type:Le.WhatsNew},e.feedback={type:Le.Feedback},e.dunning={type:Le.Dunning},e.preferences={type:Le.Preferences},e.changePlan=e=>({type:Le.ChangePlan,model:e}),e.setGoals=l.ug.setGoals,e.performance=l.ug.performance,e.signOut={type:Le.SignOut}}(De||(De={}));class Oe{load(e){switch(e.type){case Le.ChangePlan:return this._loadChangePlanModal(e.model);case Le.Tour:return this._loadTour();case Le.WhatsNew:return this._loadWhatsNew();case Le.Preferences:return this._loadPreferences();case Le.Feedback:return this._loadFeedback();case Le.Dunning:return this._loadDunning();case l.f_.SetGoals:return this._loadSetGoals(e.source);case l.f_.Performance:return this._loadPerformance();case Le.Proofit:throw new Error(`Failed to load ${e} modal`);case Le.SignOut:return this._loadSignOut();default:return(0,p.xb)(e)}}_loadTour(){return i.e(1737).then(i.bind(i,52698)).then((({WelcomeModal:e})=>t=>{const i=new ie(this._userAccount.settings,this._userAccount.features.denali,t);return{instance:{type:Le.Tour},component:r.createElement(e,{welcomeModalViewModel:i})}}))}_loadWhatsNew(){return Promise.all([Promise.all([i.e(5637),i.e(8310)]).then(i.bind(i,89827)).then((({newsMedia:e,initStaticNewsData:t,ordNews:i})=>{const s=Object.values(t(this._textResources.base)).map((t=>({id:t.id,date:t.date,content:(0,n._)({title:t.title,body:t.body},e[t.id])}))),r=a.di(i)(Object.values(s).filter((e=>this._userAccount.features.denali.newsConfig[e.id].visible())));return r.forEach((e=>{(new Image).src=M.f.Content.isVideo(e.content)?e.content.poster:e.content.image})),r})),Promise.all([i.e(5637),i.e(8310)]).then(i.bind(i,7971))]).then((([e,{WhatsNewPopup:t}])=>i=>({instance:{type:Le.WhatsNew},component:r.createElement(t,{newsVM:new M.A(this._userAccount.settings),content:e,modalOperations:i})})))}_loadSetGoals(e){return Promise.resolve((t=>{const i=function(e,t,i,s,n,r,a,o=Z.Yi,l){return(0,T.pipe)(q.h(t,function(e,t,i){return{goalsPopupShow:t=>e.gnarSpec.goalsPopupShow(e.pageId,t),getPremiumButtonClick:()=>ee.J.create(e.gnarSpec).trackClick({pageId:e.pageId,bannerType:"goPremium",placement:"setGoalsPopup"}),goalsFormSuccess:(s,n)=>{const r=()=>J.gR("academic")(s.domain)&&t.features.denali.isStudentsOFE;return e.gnarSpec.goalsFormSuccess((0,T.pipe)(s.domain,$.getOrElse((()=>n.domain))),(0,T.pipe)(s.goals,$.map((e=>r()?[]:e)),$.getOrElse((()=>n.goals)),(e=>Array.from(e))),e.pageId,i,(0,T.pipe)(s.outcomeContext,$.filter(r),$.map(Y.Up("type")),$.toUndefined),(0,T.pipe)(s.audience,$.filter((0,W.not)(r)),$.toUndefined),(0,T.pipe)(s.outcomeContext,$.filter(r),$.map(Y.Up("citation")),$.toUndefined),(0,T.pipe)(s.style,$.filter((0,W.not)(r)),$.toUndefined))}}}(s,e,r),n,r,a,{demoMode:e.features.demoMode,isFree:e.features.isFree.get(),isStudentsOFE:e.features.denali.isStudentsOFE,isEligibleForFreeTrial:e.features.isEligibleForFreeTrial,isEligibleForFreeTrialEuUk:e.features.isEligibleForFreeTrialEuUk,assignToFreeTrialEuUkExperiment:i.assignToFreeTrialEuUkExperiment.bind(i),isEligibleForPro:e.features.proVsPremiumExperiment,assignToProVsPremiumExperiment:e.features.assignProVsPremiumExperiment},(()=>i.openUpgradeUrl(X.Y.Place.DenaliDocument.editorDenaliGoals)),e.settings.enableSetGoalsLoader.get(),o,l),u.n.extendActions(z.F(j.M((t=>{t.kind===c.b.ActionsKind.close&&e.settings.enableSetGoalsLoader.get()!==t.showOnLoad&&(e.settings.updateSetGoalsLoader(t.showOnLoad),s.gnarSpec.showGoalsNewDocumentFormSuccess(t.showOnLoad,s.pageId,r))})))))}(this._userAccount,this._documentContext,this._upgradeViewModel,this._telemetry,t,e,o.T0.defaultContextFallback,this._setGoalsA11yStatus.change,this._categoriesModel.getMutedCategories);return{instance:{type:l.f_.SetGoals,source:e},component:u.UI.mount(c.b.Modal,i)}}))}_loadPreferences(){const e=new x(this._userAccount.settings,this._categoriesModel,this._userAccount.features.denali,this._telemetry);return Promise.resolve((t=>({instance:{type:Le.Preferences},component:r.createElement(we,{preferencesViewModel:e,modalOperations:t})})))}_loadFeedback(){return Promise.resolve((e=>({instance:{type:Le.Feedback},component:r.createElement(ge,{feedbackViewModel:this._feedbackViewModel,modalOperations:e})})))}_loadSignOut(){return Promise.all([i.e(270),i.e(5464)]).then(i.bind(i,25185)).then((({SignOutPopup:e})=>t=>{const i=e.Flow(t,this._telemetry,this._userAccount.settings,this._userAccount.features,this._logout);return{instance:{type:Le.SignOut},component:u.UI.mount(e.View,i)}}))}_loadDunning(){return i.e(9234).then(i.bind(i,93710)).then((({DunningPopup:e})=>t=>{const i=new f(this._userAccount,this._config,this._environment,this._telemetry);return{instance:{type:Le.Dunning},component:r.createElement(e,{dunningViewModel:i,modalOperations:t})}}))}_loadPerformance(){return Promise.resolve((e=>{const t=new G(this._reportViewModel,this._documentModel,this._notificationsManager,e),i=u.UI.Knot.make(d.c.ModalView,{downloadButton:u.UI.Node.make((()=>r.createElement(ae.n,{reportViewModel:t.reportViewModel,state:t.state})))}),s=u.n.fromSideEffect((t=>{t.action.kind===d.c.ActionsKind.close?e.onClose():(0,p.xb)(t.action.kind)}),t.state.pipe(h.T((e=>({root:e})))));return{instance:{type:l.f_.Performance},component:u.UI.mount(i,s)}}))}_loadChangePlanModal(e){return Promise.resolve((t=>{const i=new m.g(e,t,this._notificationsManager,this._telemetry);return{instance:{type:Le.ChangePlan,model:e},component:r.createElement(re,{changePlanViewModel:i})}}))}constructor(e,t,i,n,r,a,o,l,c,d,h,p,u,m){(0,s._)(this,"_userAccount",void 0),(0,s._)(this,"_textResources",void 0),(0,s._)(this,"_documentContext",void 0),(0,s._)(this,"_upgradeViewModel",void 0),(0,s._)(this,"_config",void 0),(0,s._)(this,"_environment",void 0),(0,s._)(this,"_feedbackViewModel",void 0),(0,s._)(this,"_notificationsManager",void 0),(0,s._)(this,"_documentModel",void 0),(0,s._)(this,"_reportViewModel",void 0),(0,s._)(this,"_telemetry",void 0),(0,s._)(this,"_categoriesModel",void 0),(0,s._)(this,"_logout",void 0),(0,s._)(this,"_setGoalsA11yStatus",void 0),this._userAccount=e,this._textResources=t,this._documentContext=i,this._upgradeViewModel=n,this._config=r,this._environment=a,this._feedbackViewModel=o,this._notificationsManager=l,this._documentModel=c,this._reportViewModel=d,this._telemetry=h,this._categoriesModel=p,this._logout=u,this._setGoalsA11yStatus=m}}},1884:(e,t,i)=>{i.d(t,{gq:()=>we,tq:()=>Ee});var s=i(10334),n=i(17171),r=i(50659),a=i(30040),o=i(63336),l=i(80074),c=i(87574),d=i(19840),h=i(62228),p=i(86922),u=i(27917),m=i(61198),g=i(90883),_=i(60280),f=i(65873),y=i(41949),v=i(11864),b=i(38427),S=i(15491),k=i(78339),C=i(62822),w=i(89769),E=i(89011),x=i(82315),M=i(44297),T=i(58193),A=i(16721),I=i(40884),B=i(54610),P=i(34022),F=i(22751),N=i(19967),R=i(24290),L=i(80300),D=i(77167),O=i(24497),H=i(13607),K=i(57014);const $=.2,V={position:"relative",display:"block",zIndex:0,margin:`${v.Ks.rem(0)} ${v.Ks.rem(D.Jj)}`,fontSize:v.Ks.rem(.875),fontWeight:500,border:`${v.Ks.px(1)} solid transparent`,borderRadius:v.Ks.rem(.25),backgroundImage:"linear-gradient(to right, #526DD9 0%, #526DD9 25%, #3E7FFC 75%, #0FCEAF 100%)",backgroundSize:v.Ks.percent(400),backgroundPositionX:v.Ks.percent(99),transition:`background-position-x ${v.Ks.seconds($)}`,$nest:{svg:(0,n._)((0,s._)({},{"--path-fill-1":"#018374","--path-fill-2":"#018374","--path-fill-3":"#00FFCE","--path-fill-4":"#018374"}),{flex:"0 0 auto",$nest:{path:{transition:`fill ${v.Ks.seconds($)}`}}}),"&[data-active=true]":{fontWeight:600,color:O.NeutralGray60,backgroundPositionX:v.Ks.percent(1),$nest:{path:(0,s._)({},{"--path-fill-1":"#2551DA","--path-fill-2":"#018374","--path-fill-3":"#34BCFF","--path-fill-4":"#2551DA"})}}}},U={position:"relative",zIndex:1,lineHeight:v.Ks.rem(1.5),backgroundColor:O.White,color:O.NeutralGray90,padding:v.Ks.rem(D.CN),display:"flex",alignItems:"center",transition:`\n    color ${v.Ks.seconds($)},\n    background-color ${v.Ks.seconds($)}\n  `,$nest:{"[data-active='true'] > &":{backgroundColor:O.NeutralGray10,color:O.NeutralGray60},":not([data-disabled='true'])[data-hovered='true'] > &":{backgroundColor:O.NeutralGray10}}},G={fontSize:v.Ks.rem(.75),fontWeight:400,lineHeight:v.Ks.rem(1.125),color:O.NeutralGray90,$nest:{[K.$U.compactSidebar]:K.sM}},Q={minWidth:v.Ks.rem(1.5),minHeight:v.Ks.rem(1.5)},W={position:"relative",zIndex:H.kf},q=v.Ks.prefixedStylesheet("cheetah_button",{button:[V],buttonContent:[U],label:[{flex:"1 1 auto",display:"flex",flexDirection:"column",alignItems:"flex-start"}],subtitle:[G],icon:[Q],onboardingContainer:[W]});var z=i(29517);const j="Generative AI",J="By the way, you can also access our generative AI assistance here.",Y="Go beyond revision",Z="Generative AI can help you brainstorm ideas and even write a first draft.",X=e=>{const{hideOnboarding:t,stepContent:i,children:a}=e;return t?a:r.createElement(x.M7,(0,n._)((0,s._)({},i),{alignment:"bottom",eventType:"onclick",stepId:E.E.StepId.GrammarlyGOIdeationAssistant,dotPosition:{kind:"dotAtPosition",position:x.p3.center}}),a)},ee=e=>{const t=B.v.useCollapsibleNavbarThreshold(),i=e.viewModel.isInOnboardingTourA11yExperiment,s=b.zV([t,e.viewModel.onboardingViewModels]).pipe(S.T((([e,t])=>e?M.none:t))),n=i?{title:Y,message:Z}:{message:J};return r.createElement(c.F.Fragment,null,b.zV([t,e.isSidebarIdle]).pipe(S.T((([t,o])=>r.createElement(X,{stepContent:n,hideOnboarding:!o||i&&t},r.createElement(c.F.Fragment,null,r.createElement(N.$n,{tag:R.f.div,onClick:e.viewModel.navigation.handleCheetahButtonClick,onMouseDownCapture:e=>{e.stopPropagation()},active:e.viewModel.navigation.isGGOLensActive,name:"cheetah",className:q.button},r.createElement("div",{ref:e.viewModel.navigation.cheetahButtonRef,className:q.buttonContent},r.createElement("div",{className:q.label},r.createElement("span",null,j)),r.createElement(z.B.GrammarlyGO,{width:22,className:q.icon}))),s.pipe(S.T((0,a.flow)(M.map((e=>r.createElement("div",{className:q.onboardingContainer},L.UI.mount(P.M,(0,F.G)(e))))),M.toNullable)))))))))};var te=i(48732);const ie=".3s",se={width:v.Ks.percent(100)},ne={display:"block"},re={marginRight:v.Ks.rem(2)},ae={position:"relative",paddingTop:v.Ks.rem(3.5)},oe={paddingLeft:v.Ks.rem(.1)},le={position:"absolute",bottom:v.Ks.rem(.75)},ce={marginTop:0,marginBottom:0,border:"1px solid rgba(198, 203, 222, .7)",$nest:{'& [aria-busy="false"]':{display:"none"},[K.$U.compactSidebar]:{display:"flex",alignItems:"center",height:v.Ks.important("auto")}}},de={margin:`${v.Ks.rem(.5)} ${v.Ks.rem(1.75)}`,height:v.Ks.px(1),backgroundColor:O.BlueGray20,opacity:.7},he={display:"block",lineHeight:v.Ks.rem(1.125),$nest:{"&:after":{content:'" "'},[K.$U.compactSidebar]:{fontSize:v.Ks.rem(.875),lineHeight:v.Ks.rem(1.5),paddingRight:v.Ks.rem(.25)}}},pe={opacity:1,transition:`opacity ${ie}`},ue={opacity:0,transition:`opacity ${ie}`},me={top:v.Ks.rem(.55),position:"absolute",$nest:{[K.$U.compactSidebar]:{position:v.Ks.important("static")}}},ge={top:v.Ks.rem(.5)},_e={position:"absolute",top:v.Ks.rem(.55),opacity:1,transition:`opacity ${ie}`},fe={minHeight:v.Ks.rem(1.125),height:v.Ks.rem(1.125),opacity:1,transition:`opacity ${ie}`,transform:"translate(-.125rem, -.25rem)"},ye={height:v.Ks.rem(3.5)},ve={height:v.Ks.rem(5.25),$nest:{[K.$U.compactSidebar]:{height:"auto"}}},be={position:"absolute",right:0,bottom:v.Ks.rem(.25),$nest:{[K.$U.compactSidebar]:{bottom:"auto"}}},Se={$nest:{[K.$U.compactSidebar]:K.sM}},ke=v.Ks.prefixedStylesheet("header",{performanceOnboardingContainer:[se],goalsOnboardingContainer:[se,ne],goalsNotification:[re],headerWrapper:[ae,oe],headerWrapperHigh:[ae],headerWrapperCheetah:[ae,{display:"flex",flexDirection:"column"}],description:[ne,Se],descriptionLoading:[le],headerBtn:[ce],delimiter:[de],performanceScore:[he],performanceScoreFadeIn:[pe],performanceScoreFadeOut:[ue],spinner:[ne,me],spinnerScore:[ge],checkmark:[ne,_e],checkmarkA11yContrast:[ne,fe],checkmarkFadeOut:[ne,_e,ue],spinnerFadeIn:[ne,me,pe],spinnerFadeOut:[ne,me,ue],performanceBtnLow:[ce],performanceBtn:[ce,ye],performanceBtnHigh:[ce,ve],performanceDescription:[ne,{$nest:{"&:global(.checking-complete)":{marginTop:0}}}],arrowIcon:[be]}),Ce=e=>{const{hideOnboarding:t,onboardingStepInfo:i,themes:a,children:o}=e;return t?o:r.createElement(x.M7,(0,n._)((0,s._)({},i),{alignment:"bottom",eventType:"onclick",dotPosition:{kind:"findFirstButton",buttonOrder:0,position:x.p3.center},themes:a}),o)},we=({documentModel:e,isIdle:t,modalManager:i,navigationViewModel:o,cheetahViewModel:h,features:_})=>{const{goals:v}=r.useContext(p.S.Context),{gnarSpec:x,pageId:P}=r.useContext(A.Y.Context),F=i.state.view(M.exists((e=>e.instance.type===m.f_.SetGoals))),N=i.state.view(M.exists((e=>e.instance.type===m.f_.Performance))),R=_.denali.showOnboardingTourA11yUpdates,L=B.v.useCollapsibleNavbarThreshold(),D=()=>{o.events.next({type:"performance"}),x.documentStatisticsButtonClick(P)},O=l.s.combine(e.context,e.contextCompleteness,(({domain:e,outcomeContext:t},i)=>({domain:e,outcomeContext:t,completeness:i}))).view((({domain:e,completeness:t,outcomeContext:i})=>_.denali.isStudentsOFE&&T.gR("academic")(e)&&M.isSome(i)?v.button.subtitleAcademic(v.sections.format.formatTitle(T.$v(i).citation)):v.button.subtitle(t,y.AB.TOTAL_GOALS,y.AB.MIN_GOALS))),H={documentStats:R?{title:"Evaluate your text",message:"Check your Grammarly text score and other document stats."}:{message:"Check your text score and other document statistics."},goals:R?{title:"Set some goals",message:"Specify a writing style and audience for your document to get tailored feedback."}:{title:void 0,message:"Set goals to get tailored feedback based on your type of writing."}};return r.createElement(c.F.header,{className:ke.headerWrapperCheetah},b.zV([L,t]).pipe(S.T((([i,l])=>{const p=!l||R&&i;return r.createElement(r.Fragment,null,r.createElement(g.h,{small:!0}),r.createElement(Ce,{hideOnboarding:p,onboardingStepInfo:{stepId:E.E.StepId.Step8,title:H.documentStats.title,message:H.documentStats.message},themes:{containerWrapperClassName:ke.performanceOnboardingContainer}},r.createElement(Ee,{checkingState:e.checkingState,score:e.score,scoreStatus:e.scoreStatus,isActive:N,onClick:D})),r.createElement(g.h,{small:!0}),r.createElement(Ce,{hideOnboarding:p,onboardingStepInfo:{stepId:E.E.StepId.Step1,title:H.goals.title,message:H.goals.message},themes:{containerWrapperClassName:ke.goalsOnboardingContainer,notificationClassName:ke.goalsNotification}},r.createElement(te.C,(0,n._)((0,s._)({name:"set-goals",isActive:F,isDisabled:F,title:v.button.title,"aria-label":O.view((e=>`${v.button.title}: ${e}`))},(0,d.Ly)(ke.headerBtn)),{onClick:()=>{o.events.next({type:"setGoals"}),x.setGoalsButtonClick(P)}}),r.createElement(u.In.Arrow,{direction:u.bO.right,className:ke.arrowIcon}),r.createElement(f.Oc,{className:ke.description},O))),_.denali.oggy===I.kH.splitSharedAssistants?r.createElement(c.F.Fragment,null,h.isGenAiAvailable.pipe(k.p(a.identity),C.u(h),S.T((e=>r.createElement(r.Fragment,null,r.createElement(g.h,{small:!0}),r.createElement(ee,{viewModel:e,isSidebarIdle:t})))),w.Z(null))):null,r.createElement(g.h,{small:!0}),r.createElement("div",{className:ke.delimiter}))}))))},Ee=({checkingState:e,score:t,scoreStatus:i,isActive:s,onClick:n})=>{const m=r.useContext(p.S.Context),g=i.view((e=>(0,o.pipe)(e,M.map((e=>e===h.QB.ScoresStatus.SENSITIVE)),M.getOrElse(a.constFalse)))),_=l.s.combine(s,g,((e,t)=>e||t));return r.createElement(c.F.Fragment,null,l.s.combine(e,t,g,((e,t,i)=>{const a="idle"===e,l=a?(0,o.pipe)(t,M.filter((({rank:e})=>100===e)),M.fold((()=>m.performance.button.score),(()=>m.performance.button.score100))):null,c=e=>a?i?m.performance.button.statuses.paused:(0,o.pipe)(t,M.fold((()=>m.performance.button.statuses.unavailable),e)):m.performance.button.statuses.calculating;return r.createElement(te.C,{name:"performance",isActive:s,isDisabled:_,className:M.isNone(t)&&a?ke.performanceBtnLow:ke.performanceBtnHigh,"aria-label":c((e=>`${m.performance.button.score}: ${e.rank}%`)),onClick:n},r.createElement(xe,{checkingState:e,score:t}),r.createElement("div",null,l),r.createElement(f.Oc,(0,d.Ly)(a&&"checking-complete",ke.description,!a&&ke.descriptionLoading),c((()=>m.performance.button.statuses.available))),r.createElement(u.In.Arrow,{direction:u.bO.right,className:ke.arrowIcon}))})))},xe=({checkingState:e,score:t})=>{const i="idle"===e;return r.createElement(r.Fragment,null,r.createElement(_.y,{variation:"green",size:20,className:v.Ks.joinClasses([i?ke.spinnerFadeOut:ke.spinnerFadeIn,ke.spinnerScore]),isIdle:i,strokeWidth:5}),(0,o.pipe)(t,M.map((({rank:e})=>100===e?r.createElement(u.In.NotificationInfo,{width:18,className:i?ke.checkmarkA11yContrast:ke.checkmarkFadeOut}):r.createElement(f.$p,{className:v.Ks.joinClasses([ke.performanceScore,i?ke.performanceScoreFadeIn:ke.performanceScoreFadeOut])},e))),M.toNullable))}},48732:(e,t,i)=>{i.d(t,{C:()=>f,m:()=>y});var s=i(10334),n=i(17171),r=i(69384),a=i(50659),o=i(30040),l=i(19840),c=i(87574),d=i(86922),h=i(19967),p=i(24290),u=i(16117),m=i(82608),g=i(44297),_=i(86763);const f=e=>{var{title:t,tooltip:i,tooltipAlignment:o,isActive:c,isDisabled:d,className:u,children:g}=e,f=(0,r._)(e,["title","tooltip","tooltipAlignment","isActive","isDisabled","className","children"]);return a.createElement(h.$n,(0,s._)((0,n._)((0,s._)({},f),{styleType:m.Typography.Type.Base,active:c,tag:p.f.div,title:"string"==typeof i?a.createElement("div",{className:_.M.tooltip},i):i,titleAlign:o,disabled:d}),(0,l.Ly)(_.M.outcomeBtn,_.M.outcomeBtnBorders,u)),t,g)},y=({id:e,data:t,name:i,activeLensId:s,onClick:n})=>{const r=a.useContext(d.S.Context);return a.createElement(c.F.Fragment,null,t.view((0,o.flow)(g.map((t=>a.createElement(f,{id:e,key:t.id,name:i,title:t.title,isActive:s.view((t=>t===e)),onClick:n,className:_.M.premium},a.createElement(c.F.Fragment,null,t.alerts.view((e=>a.createElement(u.Q.OutcomeCounter,{theme:_.M,count:e})))),a.createElement(m.Typography.Small,{className:_.M.outcomeStatus},r.sidebar.advancedAlerts)))),g.toNullable)))}},86763:(e,t,i)=>{i.d(t,{M:()=>T});var s=i(10334),n=i(80152),r=i(13607),a=i(11864),o=i(27199),l=i(57014);const c=a.Ks.seconds(.2),d=e=>({$nest:{[l.$U.compactSidebar]:e}}),h={padding:`${a.Ks.rem(.5)} 0`,width:a.Ks.rem(9),whiteSpace:"normal",lineHeight:a.Ks.rem(1)},p={position:"relative",display:"block",borderRadius:a.Ks.rem(r.H0),fontWeight:500,lineHeight:a.Ks.rem(1.5),transition:`background-color ${c}`,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:n.Q.Background.Base.Subdued},"&[data-active='true']":{backgroundColor:n.Q.Background.Base.Subdued}}},u=(0,s._)({margin:a.Ks.rem(.5),padding:`${a.Ks.rem(o.Yq.ButtonOutcomeY)} ${a.Ks.rem(o.Yq.ButtonOutcomeX)}`},d({display:"flex",alignItems:"center"})),m={boxSizing:"border-box",margin:`${a.Ks.rem(.25)} ${a.Ks.rem(1)}`,padding:a.Ks.rem(.75),borderRadius:a.Ks.rem(r.H0),$nest:{"&[data-active='true']":{backgroundColor:o.Q1.CoreBlue1,border:`1px solid ${n.Q.Border.Base.Default}`,color:o.Q1.CoreBlue60,fontWeight:600},[l.$U.xs]:{paddingTop:a.Ks.rem(.5),paddingBottom:a.Ks.rem(.5)}}},g=(0,s._)({display:"block",color:o.EY.SmallLightColor,whiteSpace:"normal",letterSpacing:a.Ks.rem(o.EY.SmallLightLetterSpacing),fontWeight:o.EY.SmallLightWeight},d(l.sM)),_={overflow:"hidden",marginBottom:a.Ks.rem(-.25),width:a.Ks.percent(400),borderRadius:a.Ks.rem(.375),transition:`background-color ${c}`,transform:"scale(.25)",transformOrigin:"left"},f={marginLeft:a.Ks.percent(-100),width:a.Ks.percent(100),height:a.Ks.rem(.75),transition:`transform .5s, background-color ${c}`},y={stroke:"none",fill:o.Q1.CoreNeutral40},v={position:"absolute",top:a.Ks.rem(.25),width:a.Ks.rem(1),height:a.Ks.rem(1),stroke:"none",$nest:{"&:not([data-disabled='true'])[data-active='true']":y,"&:not([data-disabled='true'])[data-hovered='true']":y,"&[data-disabled='true']":y}},b={position:"absolute",top:a.Ks.rem(.25),right:a.Ks.rem(.5),padding:a.Ks.rem(.5),width:a.Ks.rem(2),height:a.Ks.rem(2),objectFit:"contain"},S={right:a.Ks.rem(.5)},k={position:"absolute",top:a.Ks.rem(.25),right:a.Ks.rem(.5),padding:a.Ks.rem(.5),width:a.Ks.rem(2),height:a.Ks.rem(2),objectFit:"contain"},C={right:a.Ks.rem(.25),opacity:0,transition:`opacity ${c}`,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{opacity:1}}},w={[l.$U.xs]:{paddingTop:a.Ks.rem(.25),paddingBottom:a.Ks.rem(.25)}},E=a.Ks.prefixedStylesheet("navigation",{tooltip:[h],outcomeBtn:[p,u],outcomeBtnBorders:[m],outcomeStatus:[g],progressBarBg:[_],progressBar:[f],icon:[v],voxLogo:[b],checkmarkIcon:[v,S],voxIconLeft:[k],infoIcon:[v,C],counterContent:[],inactive:[]}),x=(e,t)=>({$nest:{[`& .${E.checkmarkIcon}`]:{fill:e,$nest:{"&:not([data-disabled='true'])[data-active='true']":{fill:e},"&:not([data-disabled='true'])[data-hovered='true']":{fill:e}}},[`& .${E.progressBarBg}`]:{backgroundColor:t},[`& .${E.progressBar}`]:{backgroundColor:e},"&:not([data-disabled='true'])[data-active='true']":{$nest:{[`& .${E.progressBarBg}`]:{backgroundColor:o.Q1.CoreNeutral0}}},"&:not([data-disabled='true'])[data-hovered='true']":{$nest:{[`& .${E.progressBarBg}`]:{backgroundColor:o.Q1.CoreNeutral0}}},[`&.${E.inactive}`]:{$nest:{[`& .${E.checkmarkIcon}`]:{fill:t},[`& .${E.progressBarBg}`]:{backgroundColor:o.Q1.CoreNeutral0},[`& .${E.progressBar}`]:{backgroundColor:t},"&:not([data-disabled='true'])[data-active='true']":{$nest:{[`& .${E.progressBar}`]:{backgroundColor:e}}},"&:not([data-disabled='true'])[data-hovered='true']":{$nest:{[`& .${E.progressBar}`]:{backgroundColor:e}}}}}}}),M={position:"absolute",top:a.Ks.rem(.5),right:a.Ks.rem(.5),left:"auto",fill:o.Q1.CoreYellow20,$nest:{[`& .${E.counterContent}`]:{fill:o.Q1.CoreYellow80}}},T=(0,s._)({},a.Ks.prefixedStylesheet("navigation",{correctness:[p,x(o.Q1.CoreRed50,o.Q1.CoreRed10)],clarity:[p,x(o.Q1.CoreBlue50,o.Q1.CoreBlue10)],engagement:[p,x(o.Q1.CoreGreen50,o.Q1.CoreGreen10)],delivery:[p,x(o.Q1.CorePurple50,o.Q1.CorePurple10)],vox:[p,x(o.Q1.CoreNeutral50,o.Q1.CoreNeutral10)],knowledgeHub:[p,x(o.Q1.CoreNeutral50,o.Q1.CoreNeutral10)],plagiarism:[p,x(o.Q1.CoreCyan50,o.Q1.CoreCyan10)],counterWrapper:[M],premium:[w]}),E)},92198:(e,t,i)=>{i.d(t,{j:()=>g});var s=i(50659),n=i(32062),r=i(19967),a=i(64191),o=i(19772),l=i(92954),c=i(44297),d=i(35426),h=i(11864),p=i(72747),u=i(27199);const m=h.Ks.prefixedStylesheet("obtain_grades",{contentWrapper:[{padding:`${h.Ks.rem(1)} ${h.Ks.rem(2.75)} ${h.Ks.rem(1.25)} ${h.Ks.rem(1.25)}`,width:h.Ks.percent(100),maxWidth:h.Ks.rem(22.5),borderRadius:h.Ks.rem(p.H0),background:u.Q1.BackgroundNotification,color:u.Q1.CoreNeutral0,marginRight:0,marginLeft:"auto"}],icon:[{display:"none"}],header:[{fontSize:h.Ks.rem(.875),lineHeight:h.Ks.rem(1.25),fontWeight:700,marginBottom:h.Ks.rem(.4375)}],body:[{fontSize:h.Ks.rem(.875),lineHeight:h.Ks.rem(1.3125),marginBottom:h.Ks.rem(.9375)}],gradeButtons:[{marginBottom:h.Ks.rem(.9375)}],gradeButton:[{width:h.Ks.rem(5),textAlign:"center"}],submitButton:[{fontWeight:700}]});var g;!function(e){const t={content:{wrapper:m.contentWrapper,icon:m.icon}},i=({viewModel:e})=>s.createElement(r.$n.Group,{sticky:!0},Object.entries(e.grades).map((([t,i])=>s.createElement(l.U,{name:t,className:m.gradeButton,active:e.state.view(c.exists((e=>n.O.Outcomes.Students.Grade.eq.equals(e,i)))),onClick:()=>e.selectScore(i),key:t},t))));e.ObtainGrades=({onClose:e,onShow:n,notification:r,viewModel:h})=>{const p=s.useContext(d.k.Context).obtainGrades;return o.R.useEffectOnDidMount((()=>{h.show().finally(n)})),s.createElement(a.Rx.Wrapper,{notification:r,onClose:()=>{h.reject().finally(e)},theme:t},s.createElement(a.Rx.Content,null,s.createElement("div",{className:m.header},p.title),s.createElement("div",{className:m.body},""!==h.document.title?p.titleMessage(h.document.title):p.contentMessage(h.document.content)),s.createElement("div",{className:m.gradeButtons},s.createElement(i,{viewModel:h})),s.createElement(l.U,{name:"submit",className:m.submitButton,disabled:h.state.view(c.isNone),onClick:()=>{h.submit().finally(e)}},"Submit")))}}(g||(g={}))},994:(e,t,i)=>{i.d(t,{H:()=>y,n:()=>f});var s=i(23988),n=i(50659),r=i(63336),a=i(87574),o=i(80074),l=i(86922),c=i(19967),d=i(27917),h=i(60280),p=i(15491),u=i(88e3),m=i(44297),g=i(63911);const _=JSON.parse('{"$S":"_16595d1f-performance-downloadPdfReportButton","ej":"_5f117457-performance-preparingForReportLabel","wq":"_6fe9ef4b-performance-downloadPdfSpinner","NQ":"_31b5a8f7-performance-loaderContainer","kZ":"_6fac0ad7-performance-downloadIcon"}'),f=({reportViewModel:e,state:t})=>n.createElement(a.F.Fragment,null,(0,r.pipe)(e,m.map((e=>t.pipe(p.T((t=>n.createElement(y,{key:"downloadPdfReportButton",statsLoadingState:t.type,reportViewModel:e})))))),m.toNullable));class y extends n.Component{_getButtonState(e,t){const i=this.context.performance;return e?{disabled:!0,className:_.ej,children:n.createElement("span",{key:"stats-load-container",className:_.NQ},i.report.preparingPdfReport,n.createElement(h.y,{size:20,variation:"gray",wrapperClassName:_.wq}),n.createElement(g.K,{reportViewModel:this.props.reportViewModel}))}:Object.assign({className:_.$S,children:n.createElement("span",{key:"download-button"},n.createElement(d.In.Download,{className:_.kZ}),i.report.downloadPdfReport)},t===u.K.State.Type.READY?{disabled:!1}:{disabled:!0,title:t===u.K.State.Type.SHORT_CONTENT?i.notEnoughTextToGenerateReport:void 0})}componentWillUnmount(){this.props.reportViewModel.tryToInterrupt()}shouldComponentUpdate(){return!1}componentWillReceiveProps({statsLoadingState:e}){this._loadingState.set(e)}render(){return n.createElement(c.$n.Caps,{name:"download-pdf-report",title:this._buttonState.view("title"),className:this._buttonState.view("className"),disabled:this._buttonState.view("disabled"),onClick:this.props.reportViewModel.beginDownload},this._buttonState.view("children"))}constructor(...e){super(...e),(0,s._)(this,"context",void 0),(0,s._)(this,"_loadingState",o.s.create(this.props.statsLoadingState)),(0,s._)(this,"_buttonState",o.s.combine(this.props.reportViewModel.downloadStarted,this._loadingState,((e,t)=>this._getButtonState(e,t))))}}(0,s._)(y,"contextType",l.S.Context)},27024:(e,t,i)=>{i.d(t,{p:()=>d});var s=i(50659),n=i(82608),r=i(86922),a=i(19967),o=i(14973),l=i(34717);const c=JSON.parse('{"Xo":"_809bb1a6-order-success-timeWrapper","kB":"_f52fdec8-order-success-time","p6":"_35082421-order-success-date","h_":"_1fcde546-order-success-description"}'),d=({payload:e,close:t})=>{const i=s.useContext(r.S.Context),d=s.useContext(o.aF.TitleIdContext);return s.createElement("div",null,s.createElement(n.Typography,{nodeType:"h2",styleType:n.Typography.Type.H3,id:d},i.proofitSuccessModal.title),s.createElement("div",{className:c.Xo},s.createElement(n.Typography,{nodeType:"h3",styleType:n.Typography.Type.H2,className:c.kB,"data-name":"success-time"},l.Local.shortTime(e.dueDate)),s.createElement("div",{className:c.p6,"data-name":"success-date"},l.Local.fullDate(e.dueDate))),s.createElement(n.Typography.Base,{className:c.h_},i.proofitSuccessModal.description(e.email)),s.createElement(a.$n.Primary,{name:"got-it",onClick:t},i.actions.gotIt))}},50760:(e,t,i)=>{i.d(t,{I:()=>b,N:()=>v});var s=i(23988),n=i(10334),r=i(17171),a=i(50659),o=i(30040),l=i(87574),c=i(19840),d=i(19967),h=i(27917),p=i(78339),u=i(86562),m=i(44297),g=i(7813),_=i(58193),f=i(54872);const y=JSON.parse('{"iE":"_4e776e00-search_bar-wrapper","Up":"_0b54df74-search_bar-view","Mc":"_b64bef22-search_bar-searchInputWrapper","Rt":"_3d4f0e89-search_bar-searchInput","qc":"_8b70d1e9-search_bar-searchIcon","hJ":"_7b81c65e-search_bar-counter","b":"_83b88492-search_bar-closeButton","A6":"_6fdeb332-search_bar-roundButton","Ju":"_8bcca6bd-search_bar-lessIcon","eO":"_f2f84543-search_bar-lessIconUp _8bcca6bd-search_bar-lessIcon"}');class v extends a.Component{componentDidMount(){this._title&&(this._title.focus(),this._subs.push(this.props.searchViewModel.hotkeysActions.subscribe((e=>{switch(e){case f.xJ.focus:this._title&&(this._title.focus(),this._title.select());break;case f.xJ.next:this._resultFunctionOrSelect((e=>e.next()));break;case f.xJ.previous:this._resultFunctionOrSelect((e=>e.prev()));break;default:(0,u.xb)(e)}})),this.props.searchViewModel.visible.pipe(p.p(Boolean)).subscribe((()=>{requestAnimationFrame((()=>{this._title&&(this._title.focus(),this._title.select())}))}))))}componentWillUnmount(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_resultFunctionOrSelect(e){(0,o.pipe)(this.props.searchViewModel.result.get(),m.fold(this.props.searchViewModel.select,e))}render(){const e=this.props.searchViewModel;return a.createElement("div",{className:y.Up},a.createElement(l.F.div,{className:y.Mc},a.createElement(h.In.SearchQuestion,{className:y.qc}),a.createElement(l.F.input,(0,r._)((0,n._)({name:f.LT.SEARCH_INPUT_NAME,spellCheck:!1,mount:e=>this._title=e,placeholder:"Find in document",className:y.Rt,autoFocus:!0},(0,c.oI)({value:e.term})),{onKeyDown:e=>e.keyCode===g.D.ENTER_CODE&&this._resultFunctionOrSelect((e=>e.next()))})),e.result.view(m.getOrElse((()=>({count:0,current:0})))).view((({count:e,current:t})=>e>0&&a.createElement("span",{className:y.hJ,key:"count"},t,"/",e)))),a.createElement(d.$n.Tertiary,{className:y.A6,name:"search-prev",disabled:e.result.view(_.Lw((e=>1===e.current))),onClick:()=>this._resultFunctionOrSelect((e=>e.prev()))},a.createElement(h.In.Arrow,{className:y.eO})),a.createElement(d.$n.Tertiary,{className:y.A6,name:"search-next",disabled:e.result.view(_.Lw((e=>e.current===e.count))),onClick:()=>this._resultFunctionOrSelect((e=>e.next()))},a.createElement(h.In.Arrow,{className:y.Ju})),a.createElement(d.$n.Ghost,{className:y.b,name:"search-close",onClick:()=>e.visible.set(!1)},a.createElement(h.In.Close,null)))}constructor(...e){super(...e),(0,s._)(this,"_title",void 0),(0,s._)(this,"_subs",[])}}const b=({searchViewModel:e})=>a.createElement(l.F.div,{className:y.iE},e.visible.view((t=>t&&a.createElement(v,{searchViewModel:e}))))},29517:(e,t,i)=>{i.d(t,{B:()=>s});var s,n=i(50659),r=i(27917);!function(e){e.GrammarlyGO=({className:e,width:t=23})=>n.createElement(r.hh,{className:e,width:t,viewBox:"0 0 23 23"},n.createElement("path",{fill:"var(--path-fill-1, #2551DA)",fillRule:"evenodd",stroke:"none",d:"M14.9 17c.1-.8.6-1.5 1.2-2 1.3-1.3 2.1-3 2.1-5 0-3.9-3.2-7-7.2-7s-7.3 3.1-7.3 7c0 2 .9 3.7 2.2 5 .6.5 1 1.2 1.2 2H15Zm-7.6 1.5h7.4v.7c-.1 1-1 1.8-2 1.8H9.3c-1 0-1.9-.8-2-1.8v-.7Z",clipRule:"evenodd"}),n.createElement("mask",{id:"a",width:"16",height:"18",x:"3",y:"3",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},n.createElement("path",{fill:"var(--path-fill-2, #018374)",fillRule:"evenodd",stroke:"none",d:"M14.9 17c.1-.8.6-1.5 1.2-2 1.3-1.3 2.1-3 2.1-5 0-3.9-3.2-7-7.2-7s-7.3 3.1-7.3 7c0 2 .9 3.7 2.2 5 .6.5 1 1.2 1.2 2H15Zm-7.6 1.5h7.4v.7c-.1 1-1 1.8-2 1.8H9.3c-1 0-1.9-.8-2-1.8v-.7Z",clipRule:"evenodd"})),n.createElement("g",{filter:"url(#b)",mask:"url(#a)",opacity:".9"},n.createElement("mask",{id:"c",fill:"#fff"},n.createElement("path",{stroke:"none",fillRule:"evenodd",d:"M14.9 17c.1-.8.6-1.5 1.2-2 1.3-1.3 2.1-3 2.1-5 0-3.9-3.2-7-7.2-7s-7.3 3.1-7.3 7c0 2 .9 3.7 2.2 5 .6.5 1 1.2 1.2 2H15Zm-7.6 1.5h7.4v.7c-.1 1-1 1.8-2 1.8H9.3c-1 0-1.9-.8-2-1.8v-.7Z",clipRule:"evenodd"})),n.createElement("path",{fill:"var(--path-fill-3, #34BCFF)",fillRule:"evenodd",stroke:"none",d:"M14.9 17c.1-.8.6-1.5 1.2-2 1.3-1.3 2.1-3 2.1-5 0-3.9-3.2-7-7.2-7s-7.3 3.1-7.3 7c0 2 .9 3.7 2.2 5 .6.5 1 1.2 1.2 2H15Zm-7.6 1.5h7.4v.7c-.1 1-1 1.8-2 1.8H9.3c-1 0-1.9-.8-2-1.8v-.7Z",clipRule:"evenodd"}),n.createElement("path",{fill:"var(--path-fill-4, #2551DA)",stroke:"none",d:"m16.1 15-.7-.8.7.8ZM15 17v1h.8l.1-.8-1-.2Zm-9-2-.7.7.7-.7ZM7 17l-1 .2.2.8h.8v-1Zm7.6 1.5h1l.1-1h-1v1Zm-7.4 0v-1H6.2l.1 1h1Zm7.4.7-1-.1h1Zm-7.4 0h-1 1Zm8.1-5c-.6.7-1.3 1.5-1.5 2.6l2 .4c0-.5.4-1 1-1.5l-1.5-1.5Zm1.8-4.2c0 1.7-.6 3.2-1.8 4.2l1.4 1.5a7.9 7.9 0 0 0 2.4-5.7h-2ZM11 4c3.5 0 6.3 2.7 6.3 6h2c0-4.5-3.8-8-8.3-8v2Zm-6.3 6c0-3.3 2.8-6 6.3-6V2a8.1 8.1 0 0 0-8.3 8h2Zm1.9 4.2A5.9 5.9 0 0 1 4.8 10h-2c0 2.2.9 4.2 2.4 5.7l1.4-1.5ZM8 16.8c-.2-1-.9-2-1.5-2.6l-1.4 1.5c.5.5.8 1 1 1.5l2-.4ZM15 16H7v2H15v-2Zm-.2 1.5H7.3v2h7.4v-2Zm1 1.7v-.6l-2-.2v.7l2 .1Zm-3 2.8a3 3 0 0 0 3-2.8l-2-.1c0 .5-.5.9-1 .9v2Zm-3.4 0h3.4v-2H9.3v2Zm-3-2.8a3 3 0 0 0 3 2.8v-2a1 1 0 0 1-1-1l-2 .2Zm0-.6v.6l2-.1v-.7l-2 .2Z",mask:"url(#c)"})),n.createElement("g",{filter:"url(#d)"},n.createElement("path",{fill:"#fff",stroke:"none",d:"M14.5 10.6a3.8 3.8 0 0 0-2.8 2.8v.1c-.2.7-1.2.7-1.3 0a3.8 3.8 0 0 0-2.9-2.9c-.7-.1-.7-1 0-1.2a3.8 3.8 0 0 0 2.9-2.9c.1-.7 1-.7 1.2 0a3.8 3.8 0 0 0 2.9 2.9c.7.1.7 1 0 1.2Z"})),n.createElement("defs",null,n.createElement("filter",{id:"b",width:"26.5",height:"30",x:"-2.3",y:"-3",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),n.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_5277_13171",stdDeviation:"3"})),n.createElement("filter",{id:"d",width:"20",height:"20",x:"1",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",null),n.createElement("feGaussianBlur",{stdDeviation:"3"}),n.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),n.createElement("feColorMatrix",{values:"0 0 0 0 0.00392157 0 0 0 0 0.513726 0 0 0 0 0.454902 0 0 0 1 0"}),n.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5277_13171"}),n.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5277_13171",result:"shape"})))),e.Rewrite=({className:e,width:t=24})=>n.createElement(r.hh,{className:e,width:t,viewBox:"0 0 24 24"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.866 4.5C12.3877 4.22386 11.7761 4.38773 11.5 4.86603L10.2469 7.03649L14.577 9.53649L15.8301 7.36603C16.1063 6.88773 15.9424 6.27614 15.4641 6L12.866 4.5ZM13.8256 10.8379L9.49549 8.33793L6.2476 13.9634C6.07792 14.2573 5.98582 14.5896 5.97995 14.9289L5.91538 18.6643C5.90859 19.0569 6.33617 19.3038 6.67275 19.1016L9.87546 17.178C10.1664 17.0032 10.408 16.7573 10.5777 16.4634L13.8256 10.8379Z",fill:"#018374"}),n.createElement("mask",{id:"mask0_5345_15767",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"5",y:"4",width:"11",height:"16"},n.createElement("path",{d:"M12.8667 4.50011C12.3885 4.22397 11.7769 4.38784 11.5007 4.86613L10.2476 7.0366L14.5777 9.5366L15.8308 7.36613C16.107 6.88784 15.9431 6.27625 15.4648 6.00011L12.8667 4.50011Z",fill:"#018374"}),n.createElement("path",{d:"M13.8263 10.838L9.49621 8.33804L6.24832 13.9636C6.07864 14.2574 5.98653 14.5897 5.98067 14.929L5.9161 18.6644C5.90931 19.057 6.33689 19.3039 6.67347 19.1017L9.87618 17.1781C10.1671 17.0033 10.4088 16.7574 10.5784 16.4636L13.8263 10.838Z",fill:"#018374"})),n.createElement("g",{mask:"url(#mask0_5345_15767)"},n.createElement("g",{opacity:"0.9",filter:"url(#filter0_f_5345_15767)"},n.createElement("path",{d:"M12.9435 2.36572L17.2737 4.86572L10.676 16.2933L4.49997 22L6.34584 13.7933L12.9435 2.36572Z",fill:"#00FFCE"}),n.createElement("path",{d:"M13.1266 3.04874L16.5907 5.04874L10.2809 15.9775L5.34021 20.5429L6.81694 13.9773L13.1266 3.04874Z",stroke:"#018374"}))),n.createElement("path",{d:"M8.69157 4.88121C7.81024 5.08868 7.12071 5.77187 6.90771 6.64867L6.89649 6.69484C6.79751 7.10228 6.2155 7.1015 6.11762 6.69381L6.10975 6.66104C5.8991 5.78369 5.21143 5.09867 4.3307 4.88884L4.30738 4.88329C3.89754 4.78565 3.89754 4.20481 4.30738 4.10717L4.3307 4.10161C5.21144 3.89178 5.89911 3.20676 6.10975 2.32942L6.11532 2.30619C6.21334 1.89794 6.79643 1.89794 6.89445 2.30619L6.90002 2.32942C7.11067 3.20677 7.79833 3.89179 8.67907 4.10161L8.69262 4.10484C9.10303 4.20262 9.10224 4.78454 8.69157 4.88121Z",fill:"#018374"}),n.createElement("path",{d:"M17.6916 17.8812C16.8102 18.0887 16.1207 18.7719 15.9077 19.6487L15.8965 19.6948C15.7975 20.1023 15.2155 20.1015 15.1176 19.6938L15.1097 19.661C14.8991 18.7837 14.2114 18.0987 13.3307 17.8888L13.3074 17.8833C12.8975 17.7856 12.8975 17.2048 13.3074 17.1072L13.3307 17.1016C14.2114 16.8918 14.8991 16.2068 15.1097 15.3294L15.1153 15.3062C15.2133 14.8979 15.7964 14.8979 15.8944 15.3062L15.9 15.3294C16.1107 16.2068 16.7983 16.8918 17.6791 17.1016L17.6926 17.1048C18.103 17.2026 18.1022 17.7845 17.6916 17.8812Z",fill:"#018374"}),n.createElement("defs",null,n.createElement("filter",{id:"filter0_f_5345_15767",x:"-1.5",y:"-3.63428",width:"24.7737",height:"31.6343",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),n.createElement("feGaussianBlur",{stdDeviation:"3",result:"effect1_foregroundBlur_5345_15767"}))))}(s||(s={}))},86611:(e,t,i)=>{i.d(t,{D:()=>v});var s=i(50659),n=i(80074),r=i(19840),a=i(86922),o=i(19967),l=i(27917),c=i(60280),d=i(81930),h=i(52869),p=i(15491),u=i(93712);const m=JSON.parse('{"a2":"_4d8e3185-new_toggler-full","Tp":"_5010b49c-new_toggler-background","qC":"_c8dc0c53-new_toggler-labelReveal","SA":"_6af1dd0a-new_toggler-edgeBackground _5010b49c-new_toggler-background"}'),g="checking-complete",_=14,f=l.rX.size+2,y=(28-f)/2,v=e=>{const t=s.useContext(a.S.Context),i=n.s.combine(e.checking,e.hasErrors,((e,i)=>{const n=e?t.sidebar.checkingLabel:i?t.sidebar.fixErrorsLabel:t.sidebar.openLabel;return s.createElement("div",{className:m.qC,key:"label","data-name":n},n)})),r=d.X.fadeOutState(e.checking.pipe(h.j((e=>!1===e)))),l=e.checking.pipe(p.T((e=>e?"inProgress":"end"))),u=l.pipe(p.T((e=>"end"!==e?s.createElement(c.y.Svg,{role:"presentation",key:"loading",type:"white",size:f,strokeWidth:5,onTransitionEnd:r.complete,x:164+y,y}):null))),_=l.pipe(p.T((e=>"inProgress"===e?null:s.createElement("g",{"data-name":g,className:g,key:"complete"}))));return s.createElement(o.$n,{name:"assistant",className:m.a2,onClick:e.onClick},s.createElement(S,null,_,u),i)},b=(0,r.yY)((e=>s.createElement("g",e))),S=({children:e})=>{const t=s.useContext(u.OH.Context);return s.createElement("svg",{viewBox:"0 0 192 28",className:t.has(u.OH.Flag.supportsSVGTransitions)?m.Tp:m.SA},s.createElement("defs",null,s.createElement("mask",{id:"mask"},s.createElement("circle",{cx:_,cy:_,r:_,fill:"#fff"}),s.createElement("rect",{x:_,width:164,height:28,fill:"#fff"}),s.createElement("circle",{cx:178,cy:_,r:_,fill:"#fff"})),s.createElement("clipPath",{id:"clip"},s.createElement("circle",{cx:178,cy:_,r:_}),s.createElement("rect",{x:-14,width:192,height:28,fill:"#fff"}))),s.createElement("g",{clipPath:"url(#clip)"},s.createElement("rect",{id:"box",x:"0",y:"0",width:192,height:28,mask:"url(#mask)"})),s.createElement(b,null,e))}},79025:(e,t,i)=>{i.d(t,{v:()=>v});var s=i(50659),n=i(87574),r=i(80074),a=i(63967),o=i(16721),l=i(86611),c=i(86922),d=i(19967),h=i(16117),p=i(82608),u=i(86562),m=i(40884);const g=JSON.parse('{"iE":"_3ba74340-new_toggler-wrapper","OK":"_8813904e-new_toggler-counters"}'),_=JSON.parse('{"YL":"_1a1e3949-new_toggler-issuesWrapper","Zp":"_c866ffce-new_toggler-criticalCounterWrapper","nf":"_7ff7d450-new_toggler-criticalCounterContent","sZ":"_f5d3206f-new_toggler-advancedCounterWrapper","qf":"_91c5f753-new_toggler-advancedCounterContent"}'),f=({switchToCritical:e,switchToAdvanced:t,counters:i,features:a})=>{const l=s.useContext(c.S.Context),{pageId:f,gnarSpec:v}=s.useContext(o.Y.Context),b=a.denali.alertGroupNames===m.yK.CRITICAL_ADVANCED?{critical:l.sidebar.critical,advanced:l.sidebar.advanced,criticalLabel:l.sidebar.criticalLabel,advancedLabel:l.sidebar.advancedLabel}:{critical:l.sidebar.free,advanced:a.proVsPremiumExperiment?l.sidebar.pro:l.sidebar.premium,criticalLabel:l.sidebar.freeLabel,advancedLabel:l.sidebar.premiumLabel},S=function(e,t){const i=function(e){switch(e){case m.yK.CRITICAL_ADVANCED:return"critical";case m.yK.FREE_PREMIUM:return"free";default:return(0,u.xb)(e)}}(t.denali.alertGroupNames),s=y(t.denali.alertGroupNames);return t.isLongFormPremiumFeedEnabled?r.s.combine(e.view(i),e.view(s),((e,t)=>e+t)):e.view(i)}(i,a),k=function(e,t){const i=y(t.denali.alertGroupNames);return t.isLongFormPremiumFeedEnabled?r.s.combine(e.view(i),e.view("freePremium"),((e,t)=>e+t)):e.view(i)}(i,a);return s.createElement(n.F.div,{className:g.OK},S.view((t=>t>0?s.createElement(d.$n,{key:"critical-issues",name:"critical-issues","aria-label":b.criticalLabel(t),styleType:p.Typography.Type.H3Legacy,className:_.YL,onClick:()=>{e(),v.assistantOpenButtonClick(f,"critical")}},s.createElement(h.Q.OutcomeCounter,{theme:{counterWrapper:_.Zp,counterContent:_.nf},count:t}),s.createElement("span",null,"",b.critical(t))):null)),k.view((e=>e>0?s.createElement(d.$n,{key:"advanced-issues",name:"advanced-issues","aria-label":b.advancedLabel(e),styleType:p.Typography.Type.H3Legacy,className:_.YL,onClick:()=>{t(),v.assistantOpenButtonClick(f,"advanced")}},s.createElement(h.Q.OutcomeCounter,{theme:{counterWrapper:_.sZ,counterContent:_.qf},count:e}),s.createElement("span",null,"",b.advanced(e))):null)))};function y(e){switch(e){case m.yK.CRITICAL_ADVANCED:return"advanced";case m.yK.FREE_PREMIUM:return"paid";default:return(0,u.xb)(e)}}const v=({features:e,documentModel:t,navigationViewModel:i})=>{const{gnarSpec:c,pageId:d}=s.useContext(o.Y.Context);return s.createElement(n.F.section,{className:g.iE},s.createElement(f,{features:e,switchToCritical:()=>i.events.next({type:"switchToCritical",actionSource:a.Kz.sidebar}),switchToAdvanced:()=>i.events.next({type:"switchToAdvanced",actionSource:a.Kz.sidebar}),counters:t.counters}),s.createElement(l.D,{checking:t.checkingState.view((e=>"idle"!==e)),hasErrors:r.s.combine(t.counters.view("critical"),t.counters.view("advanced"),((e,t)=>e>0||t>0)),onClick:()=>{i.events.next({type:"toggleSidebar",actionSource:a.Kz.sidebar}),c.assistantOpenButtonClick(d,"default")}}))}},70490:(e,t,i)=>{i.d(t,{F:()=>f,v:()=>_});var s=i(50659),n=i(63336),r=i(87574),a=i(19967),o=i(65873),l=i(82608),c=i(58889),d=i(35426),h=i(58538),p=i(25299),u=i(54730);const m=({word:e,apply:t})=>s.createElement(a.$n.Primary,{name:"accept-synonym",className:u.AS,onClick:t(e)},e),g=({synonyms:e,apply:t})=>s.createElement("div",{className:u.nM},e.map(((e,i)=>s.createElement(m,{word:e,key:i,apply:t})))),_=({result:{synonymsOrGroups:e},apply:t})=>{const i=s.useContext(d.k.Context);return s.createElement(r.F.div,{className:u.iE},s.createElement(o.C6,{className:u.DD},i.synonyms.title),(0,n.pipe)(e,c.fold((e=>s.createElement(g,{key:"single",synonyms:e,apply:t})),(e=>s.createElement("ol",{className:u.p_},e.map((({meaning:e,words:i},n)=>s.createElement(l.Typography,{key:n,styleType:l.Typography.Type.Base,nodeType:"li",className:u.Os},s.createElement(o.C6,{className:u.SZ},e),s.createElement(g,{key:"single",synonyms:i,apply:t})))))))))},f=({synonymsInfo:e,apply:t})=>h._g.isEmpty(e.synonymsState)?s.createElement(p.c,{activeWord:e.activeWord.meta.value}):s.createElement(_,{key:"synonymsCard",apply:t,result:e.synonymsState.synonyms})},25299:(e,t,i)=>{i.d(t,{c:()=>a});var s=i(50659),n=i(35426),r=i(54730);const a=({activeWord:e})=>{const t=s.useContext(n.k.Context);return s.createElement("div",{className:r.Yu},t.synonyms.empty(s.createElement("span",{className:r.PG},e)))}},24376:(e,t,i)=>{i.d(t,{E:()=>ge});var s=i(10334),n=i(17171),r=i(50659),a=i(30040),o=i(63336),l=i(53651),c=i(12783),d=i(57035),h=i(87574),p=i(19840),u=i(11864),m=i(21607),g=i(76005),_=i(86922),f=i(35198),y=i(19967),v=i(14737),b=i(27917),S=i(88502),k=i(65873),C=i(19772),w=i(78339),E=i(14342),x=i(82718),M=i(90405),T=i(68745),A=i(95168),I=i(6987),B=i(65141),P=i(15491),F=i(21662),N=i(68533),R=i(42543),L=i(36094),D=i(30396),O=i(89769),H=i(11089),K=i(89011),$=i(82315),V=i(44297),U=i(50581),G=i(58193),Q=i(36840),W=i(58889),q=i(86562),z=i(22835),j=i(20408),J=i(60172),Y=i(93712),Z=i(11871),X=i(5731),ee=i(79239),te=i(26816),ie=i(24497),se=i(80152);const ne={display:"flex",width:u.Ks.percent(100),height:u.Ks.percent(100),alignItems:"center"},re={position:u.Ks.important("fixed"),left:u.Ks.important(u.Ks.rem(18.5)),minWidth:u.Ks.important("auto")},ae={color:ie.NeutralGray60,margin:`0 ${u.Ks.rem(1.7)} 0 auto`,fontSize:u.Ks.rem(.75)},oe=u.Ks.prefixedStylesheet("dropdown",{button:[ne],item:[{whiteSpace:"nowrap",textTransform:"capitalize"}],popover:[re],arrow:[ae]}),le={$nest:{"& div":{display:"flex",alignItems:"center",justifyContent:"center",minWidth:u.Ks.rem(2)},"&:hover svg path":{fill:se.Q.Background.Brand.Default}}},ce={position:"absolute",width:u.Ks.rem(.5),height:u.Ks.rem(.5),borderRadius:u.Ks.percent(100),backgroundColor:se.Q.Icon.Addition.Default},de=u.Ks.prefixedStylesheet("document-settings",{versionHistory:[le],greenDot:[ce]});var he=i(76720);function pe(e){switch(e){case"chrome":case"firefox":case"edge":case"safari":return e;default:return"other"}}function ue(e){switch(e){case"windows":case"mac":case"linux":case"android":case"ios":return e;default:return"other"}}const me=JSON.parse('{"K8":"_30784b8d-document_settings-leftSidebar","jd":"_70c2ea48-document_settings-documentSettings","wj":"_348ade1e-document_settings-documentSettingsExpanded _70c2ea48-document_settings-documentSettings","Ph":"_870aad65-document_settings-scrollableContent","ZW":"_5a636762-document_settings-toolbarCollapsed _fb8600bc-document_settings-toolbar","R8":"_15e661ea-document_settings-toolbarExpanded _fb8600bc-document_settings-toolbar","SQ":"_3dbbc993-document_settings-expandButtonContainer","Mf":"_d0325687-document_settings-expandButtonHiddenWhenSmall","fJ":"_9d895033-document_settings-expandButtonAnimationWrapperExpanded _237cd7aa-document_settings-expandButtonAnimationWrapper","od":"_291e4f38-document_settings-expandButtonSquashedWhenSmall","$F":"_136e4ceb-document_settings-expandButtonSquashed","lU":"_1f325472-document_settings-expandButtonAnimationWrapperCollapsed _237cd7aa-document_settings-expandButtonAnimationWrapper","X1":"_ed94873c-document_settings-expandButton","oK":"_2974ca1c-document_settings-expandButtonInlineAnimation","$o":"_0f89949d-document_settings-expandMenuIcon","f8":"_6d6371bd-document_settings-toolbarSupportButton","me":"_8dab8e44-document_settings-separator","rL":"_ff4e87bc-document_settings-menuButtonWrapper","AQ":"_333197d8-document_settings-menuButton","e4":"_5651fbaa-document_settings-menuTitle","Tz":"_cdf812a7-document_settings-menuText","Pf":"_8ab3b40d-document_settings-label","Kk":"_917fdd2e-document_settings-icon","wx":"_8fae830c-document_settings-header","TK":"_9d1b94f9-document_settings-headerText","A3":"_d6f0c040-document_settings-userNameHeader _8fae830c-document_settings-header","nT":"_065afd9b-document_settings-userName","UY":"_08a25b52-document_settings-emailHeader _8fae830c-document_settings-header","Rp":"_c5de6f5a-document_settings-email","kZ":"_f564a3b5-document_settings-menuHead","j_":"_9afd9458-document_settings-closeButtonWrapperExpanded _d0ae08ac-document_settings-closeButtonWrapper","R5":"_95e072ff-document_settings-closeButtonWrapperCollapsed _d0ae08ac-document_settings-closeButtonWrapper","g":"_186e70b6-document_settings-closeButtonExpanded _59e89c2a-document_settings-closeButton _333197d8-document_settings-menuButton","ag":"_0c2e3bfd-document_settings-closeButtonCollapsed _59e89c2a-document_settings-closeButton _333197d8-document_settings-menuButton","Uu":"_0471cda7-document_settings-closeButtonTitleExpanded _5651fbaa-document_settings-menuTitle","aw":"_79f093fd-document_settings-closeButtonTitleCollapsed _5651fbaa-document_settings-menuTitle","Dq":"_5348c61e-document_settings-oneItemContainer _ff4e87bc-document_settings-menuButtonWrapper","pU":"_4f2bb3ef-document_settings-accountHeaderLabel","b0":"_ef00e5e1-document_settings-freeLabel _4f2bb3ef-document_settings-accountHeaderLabel","Z8":"_20d57042-document_settings-iconCollapsed","T1":"_e6b5ae1d-document_settings-iconExpanded","xJ":"_0f6dd75f-document_settings-closeIconCollapsed _917fdd2e-document_settings-icon _20d57042-document_settings-iconCollapsed","pH":"_8f766e5d-document_settings-closeIconExpanded _917fdd2e-document_settings-icon _e6b5ae1d-document_settings-iconExpanded","G4":"_d46f3fce-document_settings-onboardingSpot"}'),ge=({documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s})=>{const{landmark:n}=r.useContext(_.S.Context);return r.createElement("aside",{className:me.K8,"aria-label":n.documentMenu},r.createElement(_e,{viewModel:e}),r.createElement(be,{documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s}))},_e=({viewModel:e})=>{const{ref:t,onMount:i}=C.R.useElWatcher(),s=r.useContext(_.S.Context);C.R.FocusTrap.useFocusTrap(e.visualState.pipe(w.p(Ae.isExpanded),E.c(500),x.K(t)));const n=t.pipe(M.oE),a=new T.t(0),l=e.visualState.pipe(w.p(Ae.isExpanded),A.M((()=>a.next(0)))),c=e.visualState.pipe(w.p(Ae.isExpanded),I.n((()=>B.R(document,"mousedown").pipe(P.T((e=>V.fromNullable(e.target)))))),F.E(n),w.p((([e,t])=>!(0,o.pipe)(e,V.exists((e=>U.isParent(t,e)))))),A.M((()=>e.visualState.set({type:ee.VV.Collapsed}))));C.R.useSubscriptionTo(l.pipe(N.h(c))),C.R.useSubscriptionTo((0,o.pipe)(n,I.n((t=>e.visualState.view(Ae.isExpanded).pipe(A.M((e=>e?t.removeAttribute("inert"):t.setAttribute("inert","true"))))))));const d=new R.B7;return r.createElement(h.F.Fragment,null,e.visualState.view((t=>{const n=Ae.isExpanded(t);return r.createElement("nav",{"aria-label":s.documentSettings.label,className:n?me.wj:me.jd,ref:i,onMouseEnter:e.onMenuHovered},r.createElement(ke,{viewModel:e}),r.createElement("div",{className:me.kZ}),r.createElement(S.G,{name:"documentSettingsScroll",showWhenScrollable:!0,className:me.Ph,scrollTo:a,key:t.type,onScroll:d},e.items.map(((e,i)=>te.W.Item.isViewItem(e)?Ae.isHeader(e.name)?r.createElement(Se,{item:e,key:i}):r.createElement("div",{ref:i=>{t.type===ee.VV.Expanded&&null!==i&&(0,o.pipe)(t.scrollTo,V.filter((t=>t.item===e.name)),G.Mi((e=>a.next(i.getBoundingClientRect().bottom-e.positionY))))},className:Ae.getItemClassName(e.name),key:i},r.createElement(Ce,{item:e,onScroll:d.pipe(P.T(Q.Yi))})):r.createElement(Te,{key:i})))))})))},fe=r.memo(X.B.createComponent({component:h.F.div,section:X.B.create(X.B.Id.menu),focusStrategy:H.a.FocusStrategy.focusRootOrLastFocusable}),a.constTrue),ye=r.memo(X.B.createComponent({component:y.$n,section:X.B.create(X.B.Id.support),behavior:H.a.FocusBehavior.captureTab}),a.constTrue),ve=e=>r.createElement("span",{style:{top:u.Ks.rem(e.top),left:u.Ks.rem(e.left)},className:de.greenDot}),be=({documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:a})=>{const d=r.useContext(_.S.Context);return r.createElement(h.F.Fragment,null,e.visualState.view((u=>{const m=Ae.isExpanded(u);return r.createElement("nav",{"aria-label":d.documentSettings.toolbarLabel,className:m?me.ZW:me.R8,key:"documentSettings-toolbar"},r.createElement("div",{className:me.SQ},r.createElement(h.F.div,(0,s._)({"data-name":"documentSettings-toolbarExpand"},(0,p.Ly)(m?me.lU:me.fJ,i?me.$F:t.view((0,Q.Sw)(me.od,null)))),r.createElement(fe,{className:me.X1},i?null:r.createElement(r.Fragment,null,r.createElement(y.$n,(0,n._)((0,s._)({name:"documentSettings-toolbarExpand-backToMyGrammarlyInline",title:"Grammarly Home","aria-label":"Grammarly Home"},(0,p.Ly)(me.oK,t.view((0,Q.Sw)(me.Mf,null)))),{onClick:e.onGoBackToGrammarlyHome}),r.createElement(l.I,{icon:c.c,accessibilityLabel:"Open Grammarly Home",className:m?me.Z8:me.T1}))),r.createElement($.M7,{alignment:"bottom",eventType:"onclick",stepId:K.E.StepId.Step10,title:a?d.documentSettings.detailedOnboarding.title:void 0,message:a?d.documentSettings.detailedOnboarding.message:d.documentSettings.onboarding.message,themes:{spotClassName:me.G4}},r.createElement(y.$n,{name:"documentSettings-toolbarExpand-openToolbar",title:"Menu","aria-label":"Menu",className:me.oK,onClick:e.onOpenToolbar},r.createElement(b.In.DocumentSettings.ExpandMenu,{className:me.$o}),L.wd(e.hasNewItems)(r.createElement(ve,{top:.3,left:1}),null)))))),r.createElement(ye,{name:"documentSettings-toolbarSupport",className:me.f8,title:d.documentSettings.supportTitle,"aria-label":d.documentSettings.supportTitle,onClick:t=>{e.visualState.set({type:ee.VV.Expanded,scrollTo:(0,o.pipe)(Ae.getClickEventY(t),V.map((e=>({item:ee.m1.support,positionY:e}))))})}},r.createElement(b.In.QuestionMark,null)))})))},Se=({item:e})=>r.createElement("div",{className:Ae.getItemClassName(e.name)},r.createElement(k.Oc,{className:(0,o.pipe)(Ae.getTextClassName(e.name),V.toUndefined)},e.title),r.createElement(Me,{item:e})),ke=({viewModel:e})=>{const t=Ae.isExpanded(e.visualState.get());return r.createElement("div",{className:t?me.j_:me.R5},r.createElement(y.$n.Flat,{name:`documentSettings-${e.head.name}`,active:e.head.active,disabled:e.head.disabled,animationMode:v.g.None,onClick:e.head.onClick,className:t?me.g:me.ag},r.createElement(b.In.Close,{className:t?me.pH:me.xJ}),r.createElement("span",{className:t?me.Uu:me.aw},e.head.title)))},Ce=({item:e,onScroll:t})=>{const i=r.useContext(j._.Context),a=r.useContext(Y.OH.Context),l=Ae.getLink(e.name,i,a),c=Ae.getUploadModel(e),d=r.useRef(null),p=()=>{e.onClick(),null!==d.current&&d.current.click()},u=r.createElement(r.Fragment,null,(0,o.pipe)(Ae.getIcon(e),V.fold((()=>r.createElement("span",{id:e.name,className:me.Tz},e.title)),(t=>r.createElement(r.Fragment,null,r.createElement(h.F.div,{"aria-hidden":!0,className:me.Kk},t,(0,o.pipe)(e.showGreenDot,V.map((e=>L.wd(e)(r.createElement(ve,{top:.3,left:1.95}),null))),V.toNullable)),r.createElement("span",{className:me.e4},e.title))))),r.createElement(Me,{item:e})),m=(0,o.pipe)(c,V.map((e=>r.createElement(Z.k,{documentUpload:e,multiple:!1,mount:e=>d.current=e,hideTooltip:!0,ariaHidden:!0}))),V.toNullable);return r.createElement(r.Fragment,null,(0,o.pipe)(l,V.map((t=>r.createElement(xe,{item:e,link:t,onClick:p},u))),G.NW((0,o.pipe)(e.nestedItem,V.chain(V.fromEither),V.filter(ee.LU.is),V.map((e=>r.createElement(Ee,(0,n._)((0,s._)({},Ae.getDropdownProps(e)),{onScroll:t}),u))))),V.getOrElse((()=>r.createElement(we,{item:e,onClick:p},u)))),m)},we=({item:e,children:t,onClick:i})=>r.createElement(y.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,onClick:i,className:me.AQ},t),Ee=({children:e,items:t,selected:i,onAction:a,onOpenChange:o,onScroll:l})=>r.createElement(h.F.Fragment,null,l.pipe(D.S((e=>++e),0),O.Z(0),P.T((l=>r.createElement(m.W.DropdownLifted,{key:l,label:r.createElement(r.Fragment,null,e,r.createElement("span",{className:oe.arrow,"aria-hidden":!0},"")),selectionMode:"single",placement:"right",theme:oe,button:y.$n.Flat,selectedKeys:i,onAction:a,items:i.view((e=>t.map((t=>(0,n._)((0,s._)({},t),{selected:e.has(t.text)}))))),onOpenChange:o},(e=>r.createElement(m.W.Item,{key:e.text,textValue:e.text},e.icon,r.createElement(m.W.ItemContent,null,`${e.text} English`)))))))),xe=({item:e,link:t,onClick:i,children:s})=>r.createElement(y.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,className:me.AQ,onClick:i,href:t,target:"_blank"},s),Me=({item:e})=>(0,o.pipe)(e.nestedItem,V.map(W.fold((e=>r.createElement(k.Oc,{className:me.Pf},e)),Ae.renderNestedItem)),V.toNullable),Te=()=>r.createElement("div",{className:me.me});var Ae;!function(e){function t(e){switch(e){case"american":return r.createElement(b.In.DocumentSettings.USFlag,null);case"british":return r.createElement(b.In.DocumentSettings.GBFlag,null);case"canadian":return r.createElement(b.In.DocumentSettings.CanadianFlag,null);case"australian":return r.createElement(b.In.DocumentSettings.AustralianFlag,null);case"indian":return r.createElement(b.In.DocumentSettings.IndianFlag,null);default:return(0,q.xb)(e)}}function i(e){const t=e.getBoundingClientRect();return t.bottom-t.height/2}e.getDropdownProps=e=>function(e){return{items:Object.values(J.Vi).map((e=>({text:e,icon:t(e)}))),selected:e.dialectSettings.dialectOrDefault.view((e=>new Set([e]))),onAction:e.changeDialect.bind(e),onOpenChange:e.onStateChange.bind(e)}}(e),e.renderNestedItem=e=>{switch(e.type){case ee.W7.uploadFile:return r.createElement(k.Oc,{className:me.Pf},e.label);case ee.W7.accountHeaderLabel:return r.createElement(h.F.Fragment,null,e.brandingSet.view((e=>(0,o.pipe)(e,V.fold((()=>null),(e=>"PREMIUM"===e?r.createElement(f.E.Premium,{className:me.pU},e):r.createElement(f.E.Regular,{className:"FREE"===e?me.b0:me.pU},e)))))));case ee.W7.whatsNewUpdates:case ee.W7.languageSettings:return r.createElement(r.Fragment,null);default:return(0,q.xb)(e)}},e.getLink=function(e,t,i){switch(e){case ee.m1.subscription:return V.some(t.account.subscription);case ee.m1.support:return V.some(t.support.mainPage);case ee.m1.privacyPolicy:return V.some(t.privacyPolicy);case ee.m1.termsOfService:return V.some(t.termsOfService);case ee.m1.reportABug:return V.some(function(e,t){return new he.U(e.api.inProductReportUrl).addParams({clientVersion:t.buildVersion.toString(),platformVersion:t.info.parsedVersion.toString(),application:window.location.origin,browser:pe(t.info.browser),os:ue(t.info.os),userType:"business",team:"editor"}).toString()}(t,i));case ee.m1.versionHistory:return V.some(t.urls.versionHistory);case ee.m1.close:case ee.m1.myGrammarly:case ee.m1.documentHeader:case ee.m1.newDocument:case ee.m1.uploadFile:case ee.m1.download:case ee.m1.print:case ee.m1.editHeader:case ee.m1.editorSettings:case ee.m1.accountHeader:case ee.m1.userName:case ee.m1.email:case ee.m1.upgradeToPremium:case ee.m1.language:case ee.m1.logout:case ee.m1.whatsNew:case ee.m1.feedback:case g.H2.undo:case g.H2.redo:case g.H2.cut:case g.H2.copy:case g.H2.paste:case g.H2.selectAll:return V.none;default:return(0,q.xb)(e)}},e.getUploadModel=(0,a.flow)(z.Up("nestedItem"),V.chain(V.fromEither),V.chain((e=>{switch(e.type){case ee.W7.uploadFile:return V.some(e.uploadViewModel.uploadModel);case ee.W7.accountHeaderLabel:case ee.W7.whatsNewUpdates:case ee.W7.languageSettings:return V.none;default:return(0,q.xb)(e)}}))),e.getIcon=function(e){const i=e.name;switch(i){case ee.m1.close:return V.some(r.createElement(b.In.Close,null));case ee.m1.myGrammarly:return V.some(r.createElement(b.In.DocumentSettings.Home,null));case ee.m1.newDocument:return V.some(r.createElement(b.In.DocumentSettings.NewDocument,null));case ee.m1.uploadFile:return V.some(r.createElement(b.In.DocumentSettings.UploadFile,null));case ee.m1.download:return V.some(r.createElement(b.In.ToolbarDownload,null));case ee.m1.print:return V.some(r.createElement(b.In.DocumentSettings.PrintFile,null));case g.H2.undo:return V.some(r.createElement(b.In.DocumentSettings.UndoGrey,null));case g.H2.redo:return V.some(r.createElement(b.In.DocumentSettings.Redo,null));case g.H2.cut:return V.some(r.createElement(b.In.DocumentSettings.Cut,null));case g.H2.copy:return V.some(r.createElement(b.In.Copy,null));case g.H2.paste:return V.some(r.createElement(b.In.DocumentSettings.Paste,null));case ee.m1.editorSettings:return V.some(r.createElement(b.In.Gear,null));case ee.m1.support:return V.some(r.createElement(b.In.QuestionMark,null));case ee.m1.upgradeToPremium:return V.some(r.createElement(b.In.Paid,null));case ee.m1.versionHistory:return V.some(r.createElement(l.I,{icon:d.k,accessibilityLabel:"",size:"large"}));case ee.m1.documentHeader:case ee.m1.editHeader:case ee.m1.accountHeader:case ee.m1.userName:case ee.m1.email:case ee.m1.language:return(0,o.pipe)(e.nestedItem,V.chain(V.fromEither),V.filter(ee.LU.is),V.map((e=>e.dialectSettings.dialectOrDefault.view(t))));case ee.m1.subscription:case ee.m1.logout:case ee.m1.whatsNew:case ee.m1.feedback:case ee.m1.privacyPolicy:case ee.m1.termsOfService:case ee.m1.reportABug:case g.H2.selectAll:return V.none;default:return(0,q.xb)(i)}},e.getItemClassName=function(e){switch(e){case ee.m1.myGrammarly:case ee.m1.editorSettings:return me.Dq;case ee.m1.documentHeader:case ee.m1.editHeader:case ee.m1.accountHeader:return me.wx;case ee.m1.userName:return me.A3;case ee.m1.email:return me.UY;case ee.m1.versionHistory:return de.versionHistory;case ee.m1.close:case ee.m1.newDocument:case ee.m1.uploadFile:case ee.m1.download:case ee.m1.print:case ee.m1.upgradeToPremium:case ee.m1.language:case ee.m1.subscription:case ee.m1.logout:case ee.m1.support:case ee.m1.whatsNew:case ee.m1.feedback:case ee.m1.privacyPolicy:case ee.m1.termsOfService:case ee.m1.reportABug:case g.H2.undo:case g.H2.redo:case g.H2.cut:case g.H2.copy:case g.H2.paste:case g.H2.selectAll:return me.rL;default:return(0,q.xb)(e)}},e.getTextClassName=function(e){switch(e){case ee.m1.userName:return V.some(me.nT);case ee.m1.email:return V.some(me.Rp);case ee.m1.documentHeader:case ee.m1.editHeader:case ee.m1.accountHeader:return V.some(me.TK);case ee.m1.close:case ee.m1.myGrammarly:case ee.m1.newDocument:case ee.m1.uploadFile:case ee.m1.download:case ee.m1.print:case ee.m1.editorSettings:case ee.m1.upgradeToPremium:case ee.m1.language:case ee.m1.subscription:case ee.m1.logout:case ee.m1.support:case ee.m1.whatsNew:case ee.m1.feedback:case ee.m1.privacyPolicy:case ee.m1.termsOfService:case ee.m1.reportABug:case ee.m1.versionHistory:case g.H2.undo:case g.H2.redo:case g.H2.cut:case g.H2.copy:case g.H2.paste:case g.H2.selectAll:return V.none;default:return(0,q.xb)(e)}},e.isHeader=function(e){switch(e){case ee.m1.documentHeader:case ee.m1.editHeader:case ee.m1.accountHeader:case ee.m1.userName:case ee.m1.email:return!0;case ee.m1.close:case ee.m1.myGrammarly:case ee.m1.newDocument:case ee.m1.uploadFile:case ee.m1.download:case ee.m1.print:case ee.m1.editorSettings:case ee.m1.upgradeToPremium:case ee.m1.language:case ee.m1.subscription:case ee.m1.logout:case ee.m1.support:case ee.m1.whatsNew:case ee.m1.feedback:case ee.m1.privacyPolicy:case ee.m1.termsOfService:case ee.m1.reportABug:case ee.m1.versionHistory:case g.H2.undo:case g.H2.redo:case g.H2.cut:case g.H2.copy:case g.H2.paste:case g.H2.selectAll:return!1;default:return(0,q.xb)(e)}},e.getClickEventY=function(e){return(0,o.pipe)(V.fromNullable(void 0!==e&&e.target),V.map(i))},e.getElementCenter=i,e.isExpanded=function(e){return e.type===ee.VV.Expanded}}(Ae||(Ae={}))},16140:(e,t,i)=>{i.d(t,{V4:()=>x});var s=i(50659),n=i(30040),r=i(63336),a=i(87574),o=i(86922),l=i(35098),c=i(35300),d=i(19967),h=i(10486),p=i(50993),u=i(98530),m=i(15491),g=i(38427),_=i(89769),f=i(86562),y=i(22835),v=i(58889),b=i(50581),S=i(14729),k=i(69063),C=i(1404);const w=JSON.parse('{"x6":"_e9f7b8c5-formatting-link-button","kU":"_69c9878e-formatting-link-positionedWrapper","iE":"_14d68179-formatting-link-wrapper","Sh":"_23728bfd-formatting-link-editorToViewportContainer","S":"_8a4031ab-formatting-link-urlHolder _a7f5146c-formatting-link-base","Y2":"_1b5a1557-formatting-link-urlInput _8a4031ab-formatting-link-urlHolder _a7f5146c-formatting-link-base","xG":"_8f61eea3-formatting-link-urlText","uV":"_27acff95-formatting-link-delimiter"}');class E extends f.eo{}const x=({vm:e})=>{const t=s.useContext(l.L.Context).pipe(m.T(y.Up("rect")));return s.createElement(a.F.div,{className:w.kU},g.zV(t,e.visualState).pipe(m.T((([e,t])=>(0,r.pipe)(t,v.fromOption((()=>new E("Viewport state is O.none"))),v.chain((t=>(0,r.pipe)(t.rect.getRect(),v.map((({clientRects:[t,...i],rootClientRect:s})=>({viewportLikeRect:b.absToRelative(e,s),rect:(0,r.pipe)(b.Rect.join(t,...i),v.getOrElse((()=>b.Rect.empty)))}))),v.map((({viewportLikeRect:e,rect:i})=>s.createElement(a.F.div,{className:w.Sh,style:{top:e.top,left:e.left}},s.createElement(u.P.ByAbsoluteRect,{rect:i,align:b.Rect.Axis.vertical,selector:A},s.createElement(c.Q,{hide:t.close},s.createElement("div",{className:w.iE},t.visualState===C.W.VisualState.EditingMode?s.createElement(M,{inputContent:t.inputContent,apply:t.apply,isValid:t.isValid}):s.createElement(T,{url:t.url,change:t.change,remove:t.remove})))))))))),v.fold((e=>(e instanceof E||k.Bx.Logging.getLogger("FormattingLink").error("Cannot render links popup",e),null)),n.identity)))),_.Z(null)))},M=({apply:e,inputContent:t,isValid:i})=>{const r=s.useContext(o.S.Context);return s.createElement(s.Fragment,null,s.createElement(h.pd,{name:"rtfLinks-urlInput",placeholder:r.toolbar.formatting.links.placeholder,autofocus:!0,className:w.Y2,value:t}),s.createElement(d.$n.Ghost,{name:"rtfLinks-apply",onClick:()=>{e()},disabled:i.view((0,n.not)(n.identity))},r.toolbar.formatting.links.apply))},T=({url:e,change:t,remove:i})=>{const n=s.useContext(o.S.Context);return s.createElement(s.Fragment,null,s.createElement(p.w,{href:e,className:w.S},s.createElement("span",{className:w.xG},e)),s.createElement(d.$n.Tertiary,{name:"rtfLinks-change",onClick:t,className:w.x6},n.toolbar.formatting.links.change),s.createElement("span",{className:w.uV}),s.createElement(d.$n.Tertiary,{name:"rtfLinks-remove",onClick:i,className:w.x6},n.toolbar.formatting.links.remove))},A=e=>{const t="bottom",i=S.w.Selector.Placement.left,s=S.w.Selector.takeBy(t,i)(e);return(({point:e})=>-1===Math.sign(e.x)||-1===Math.sign(e.y))(s.point)?S.w.Selector.preferBy(t,i)(e):s}},73566:(e,t,i)=>{i.d(t,{PT:()=>S,NI:()=>k});var s=i(10334),n=i(17171),r=i(50659),a=i(30040),o=i(63336),l=i(87574),c=i(19840),d=i(76005),h=i(19967),p=i(14737),u=i(27917),m=i(44297),g=i(58889),_=i(86562),f=i(80019),y=i(26816),v=i(57791);const b=JSON.parse('{"iE":"_983d53b0-formatting-toolbar-wrapper","yu":"_b6bf19bd-formatting-toolbar-toolbarBtn","nd":"_dfdcacb3-formatting-toolbar-panel","$e":"_666c5e1f-formatting-toolbar-panelAnimateIn","AS":"_8bbcd63e-formatting-toolbar-item","me":"_fd8a9183-formatting-toolbar-separator","Lr":"_6cd9fea9-formatting-toolbar-panelHorizontal","AC":"_a6657dff-formatting-toolbar-verticalSeparator","ti":"_f1c80523-formatting-toolbar-itemMini _8bbcd63e-formatting-toolbar-item","V1":"_e1edbba1-formatting-toolbar-iconMini","YL":"_642a89aa-formatting-toolbar-tooltip","Pf":"_87e57eee-formatting-toolbar-label","H4":"_149f8a5d-formatting-toolbar-hotkeyLabel","Cr":"_81ab552d-formatting-toolbar-bold","TN":"_2f2a5db0-formatting-toolbar-italic","mn":"_dba0a4bc-formatting-toolbar-underline","h1":"_e743e53e-formatting-toolbar-h1 _bd2149d3-formatting-toolbar-header3","h2":"_cb468ed0-formatting-toolbar-h2 _498bfbff-formatting-toolbar-header4","nf":"_e91f7f84-formatting-toolbar-link"}'),S=({viewModel:e})=>r.createElement(l.F.div,{className:b.iE},r.createElement(h.$n.Ghost,(0,n._)((0,s._)({},(0,c.Ly)(v.yu,b.yu)),{name:"head",animationMode:p.g.FromCenter,title:e.head.title,active:e.head.active,onClick:e.head.onClick}),r.createElement(u.In.Formatting.Head,null)),e.visualState.view((t=>t===f.Ht.VisualState.Expanded&&r.createElement(C,{viewModel:e,theme:{panel:(0,c.Ly)(b.nd,b.$e).className,item:b.AS,separator:b.me}})))),k=({viewModel:e})=>r.createElement(C,{viewModel:e,theme:{panel:b.Lr,item:b.ti,itemIcon:b.V1,separator:b.AC}}),C=({viewModel:e,theme:t})=>r.createElement(l.F.div,{key:"formatting-wrapper",className:t.panel},e.list.map(((e,i)=>y.W.Item.isViewItem(e)?r.createElement(w,{theme:{itemClass:t.item,iconClass:t.itemIcon},key:i,item:e}):r.createElement("div",{key:i,className:t.separator})))),w=({item:e,theme:t})=>{const i=x(e.name,t.iconClass);return r.createElement(h.$n,{name:`rtfToolbar-${e.name}`,title:r.createElement(E,{item:e,labelClass:i.labelClass}),titleAlign:"topCenter",active:e.active,className:t.itemClass,key:e.name,onClick:e.onClick,"aria-label":e.ariaLabel},i.icon)},E=({item:e,labelClass:t})=>r.createElement("div",{className:b.YL},(0,o.pipe)(e.tooltip,m.fold(a.constNull,(e=>r.createElement("span",(0,c.Ly)(b.Pf,t),e)))),(0,o.pipe)(e.nestedItem,m.fold(a.constNull,g.fold((e=>r.createElement("span",{className:b.H4},e)),a.constVoid)))),x=(e,t)=>{switch(e){case d.M_.Type.bold:return{icon:r.createElement(u.In.Formatting.Bold,{className:t}),labelClass:b.Cr};case d.M_.Type.italic:return{icon:r.createElement(u.In.Formatting.Italic,{className:t}),labelClass:b.TN};case d.M_.Type.underline:return{icon:r.createElement(u.In.Formatting.Underline,{className:t}),labelClass:b.mn};case d.M_.Type.header1:return{icon:r.createElement(u.In.Formatting.Header1,{className:t}),labelClass:b.h1};case d.M_.Type.header2:return{icon:r.createElement(u.In.Formatting.Header2,{className:t}),labelClass:b.h2};case d.M_.Type.link:return{icon:r.createElement(u.In.Formatting.Link,{className:t}),labelClass:b.nf};case d.M_.Type.bulletList:return{icon:r.createElement(u.In.Formatting.BulletList,{className:t})};case d.M_.Type.orderedList:return{icon:r.createElement(u.In.Formatting.OrderedList,{className:t})};case"clear":return{icon:r.createElement(u.In.Formatting.Clear,{className:t})};default:return(0,_.xb)(e)}}},41933:(e,t,i)=>{i.d(t,{M:()=>D});var s=i(10334),n=i(17171),r=i(50659),a=i(19377),o=i(85262),l=i(89754),c=i(63336),d=i(87574),h=i(19840),p=i(35300),u=i(92141),m=i(15491),g=i(58889),_=i(58193),f=i(44297),y=i(36840),v=i(24497),b=i(80152),S=i(11864);const k={width:S.Ks.rem(1.5),position:"absolute",alignItems:"end",overflow:"visible"},C={background:"white",zIndex:99999,display:"flex",flexDirection:"column",width:S.Ks.rem(40),borderRadius:S.Ks.rem(.5),border:"0.5px solid #CDD1DC",position:"absolute",padding:`0 ${S.Ks.rem(.875)} ${S.Ks.rem(.875)} ${S.Ks.rem(.875)}`,boxShadow:`0px 1px ${S.Ks.rem(.5)} 0.5px rgba(135, 141, 162, 0.5);`},w=(0,n._)((0,s._)({},C),{padding:"0"}),E={display:"flex",minHeight:S.Ks.rem(2.5),alignItems:"center"},x={marginRight:S.Ks.rem(.5)},M={fontSize:S.Ks.rem(.875),lineHeight:S.Ks.rem(1),padding:S.Ks.rem(.25),color:"#646B81",flex:6},T={flex:1,minWidth:S.Ks.rem(4)},A={position:"absolute",right:S.Ks.rem(1.125),top:S.Ks.rem(.875),cursor:"pointer",background:"white"},I={fontSize:S.Ks.rem(.875),lineHeight:S.Ks.rem(1.3125)},B=(0,n._)((0,s._)({},I),{paddingBottom:S.Ks.rem(.625)}),P=(0,n._)((0,s._)({},I),{background:"white",color:"#027E6F",border:"#027E6F solid 1px",marginRight:S.Ks.rem(.5),padding:`${S.Ks.rem(.25)} ${S.Ks.rem(.5)}`}),F=(0,n._)((0,s._)({},I),{background:"white",color:"#646B81",padding:`${S.Ks.rem(.25)} ${S.Ks.rem(.5)}`}),N={marginLeft:S.Ks.rem(.25),marginRight:S.Ks.rem(.25),$nest:{svg:{verticalAlign:"middle"}}},R={backgroundColor:v.Green60,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:v.Green80},path:{stroke:b.Q.Icon.Base.Inverse}}},L=S.Ks.stylesheet({vbarWrapper:[k],vbarInlineCard:[C],vbarInlineCardSDUI:[w],vbarInlineCardTitle:[E],vbarInlineCardTitleIcon:[x],vbarInlineCardTitleText:[M],vbarInlineCardTitleClose:[A],vbarInlineCardAlert:[B],vbarInlineCardToolbar:[{display:"flex",justifyContent:"space-between"}],vbarInlineCardReplaceBtn:[P],vbarInlineCardDismissBtn:[F],feedbackIcon:[N],feedbackButton:[R],insertedTextBold:[{fontWeight:"bold"}],retainedText:[{textDecoration:"none"}],vbarBetaLabel:[T]}),D=(e,t,i)=>s=>{const n=t.getInlineItemForAlert(s.alert.id),o=e=>{t.handleSDUIAction(e),e.actions.forEach((e=>{switch(e.type){case"applyAlerts":case"removeAlerts":case"removeRoot":case"closeCard":return void s.close();case"nativeOpenUserSatisfactionFeedback":return void s.giveFeedback();case"copyToClipboard":return void i(e.text);default:return}}))};return r.createElement(p.Q,{hide:()=>s.close()},r.createElement(d.F.Fragment,null,(0,c.pipe)(n,m.T(g.fold((()=>null),(t=>r.createElement(O,{item:t,maxWidth:e,position:s.position,designSystem:a.J,onSDUIAction:o})))))))},O=({item:e,position:t,maxWidth:i,onSDUIAction:a,designSystem:p})=>(r.useEffect((()=>{(0,c.pipe)(o.cK.findFirst(e.content,"inlineCard"),_.Mi((t=>{a({type:u.X9.Type.sduiCardAction,sourceId:t.id,cardId:e.id,actions:t.onFocus,scope:{alertRefs:[]}})})))})),r.createElement(d.F.div,(0,n._)((0,s._)({},(0,h.Ly)(L.vbarInlineCardSDUI)),{style:(0,n._)((0,s._)({},t),{maxWidth:i})}),r.createElement(l.R,{key:e.id,sduiRootId:e.id,content:e.content,designSystem:p,notify:(t,i,s)=>{a({type:u.X9.Type.sduiCardAction,sourceId:t,cardId:e.id,actions:i,scope:s})},transitions:[],prevContent:f.none,onAnimationEnd:y.Yi,onMount:y.Yi})))},82874:(e,t,i)=>{i.d(t,{g:()=>F});var s,n,r,a=i(23988),o=i(30040),l=i(65716),c=i.n(l),d=i(28091),h=i(30246),p=i(80629),u=i(88105),m=i(76005),g=i(42543),_=i(38920),f=i(36840),y=i(38908),v=i(58889),b=i(44297),S=i(50581),k=i(22835),C=i(69063),w=i(10334),E=i(17171),x=i(63336),M=i(18726),T=i(23210),A=i(28986),I=i(86562);!function(e){var t=e.normalizeSpacesInDelta=e=>e.reduce(((e,t)=>e.push(u.E.isInsert(t)&&"string"==typeof t.insert?(0,E._)((0,w._)({},t),{insert:t.insert.replace(/\s/g,(e=>"\n"===e||"\r"===e||"\t"===e?e:" "))}):t)),new A.R);function i(e,t){let i="";for(let s=e.ops.length-1;s>=0&&i.length<t.length;--s){const t=e.ops[s];if("string"!=typeof t.insert)break;i=t.insert+i}return i.slice(-1*t.length)===t}let n,a;e.sanitizeContent=e=>(0,x.pipe)(y.aj(e,{addTags:["o:p","del"],allowedAttrs:["href","style","class",r.TrailingSpaces.dataPreserveSpaces],forbidTags:["script","style","meta","img","video","embed","frame","iframe","area","source","track","template","canvas","audio"],allowDataAttrs:!1,returnHTML:!0}),(e=>(0,x.pipe)(S.traverseMutate(e,(e=>S.Guardians.isHTMLElement(e)||S.Guardians.isDocumentFragment(e)),(0,o.flow)(r.normalizeBold,r.TrailingSpaces.decodeTrailingSpaces,r.cleanupStyles(["whiteSpace","fontWeight","fontStyle","white-space","font-weight","font-style","mso-list"]))),v.fold((e=>(C.Bx.Logging.getLogger("HTML2Delta").warn("Cannot normalize html on paste",e),b.none)),(e=>b.some(e)))))),e.normalizeDelta=e=>(0,o.flow)(b.map(e),b.map(t)),e.trimTrailingNewLine=function(e,t={}){return s.deltaEndsWith(e,"\n")&&(null==e.ops[e.ops.length-1].attributes||t.table)?e.compose((new(c())).retain(e.length()-1).delete(1)):e},e.deltaEndsWith=i,function(e){let t;!function(e){e.and=(...e)=>t=>e.every((e=>e(t))),e.or=(...e)=>t=>e.some((e=>e(t))),e.includes=e=>t=>t.includes(e)}(t=e.Test||(e.Test={})),e.checks=[{name:m.j1.MSOutlook,test:t.and(t.includes('xmlns:w="urn:schemas-microsoft-com:office:word'),t.includes("span.EmailStyle15"))},{name:m.j1.MSWord,test:t.includes('xmlns:w="urn:schemas-microsoft-com:office:word')},{name:m.j1.MSExcel,test:t.includes('xmlns:x="urn:schemas-microsoft-com:office:excel')},{name:m.j1.MSOffice,test:t.includes('xmlns:o="urn:schemas-microsoft-com:office:office')},{name:m.j1.MSWordOnline,test:t.and(t.includes('xml:lang="EN-US"'),t.includes("TextRun"),t.includes("SCX"))},{name:m.j1.GDocs,test:t.includes('id="docs-internal-guid-')},{name:m.j1.GSheets,test:t.includes('<meta name="generator" content="Sheets"/>')},{name:m.j1.DropboxPaper,test:t.includes('class=" author-d-')},{name:m.j1.CocoaHTMLWriter,test:t.includes('<meta name="Generator" content="Cocoa HTML Writer">')},{name:m.j1.ProbablyMSOutlookOnline,test:t.or(t.includes("color: rgb(0, 0, 0); font-family: Calibri, Helvetica, sans-serif;"),t.includes("color: rgb(0, 0, 0); font-family: Calibri,Helvetica,sans-serif;"))},{name:m.j1.ProbablyGMail,test:t.or(t.includes("color: rgb(34, 34, 34); font-family: Arial, Helvetica, sans-serif;"),t.includes("color: rgb(34, 34, 34); direction: ltr; font-family: Arial,Helvetica,sans-serif;"))}],e.detectSource=(e,t)=>{const i=t.find((t=>t.test(e)));return i?i.name:m.j1.Unknown}}(n=e.SourceDetector||(e.SourceDetector={})),function(e){let t;function n(e,t){return S.Guardians.isP(e)&&"MsoNormal"===e.className&&1===e.childNodes.length&&e.firstChild&&e.firstChild.textContent===r.nbsp?(new A.R).insert("\n"):t}function a(e,t){let i=(new A.R).compose(t);if(0===t.ops.length)return v.right(i);const s=i.ops[0];if(!S.Guardians.isHTMLElement(e))return v.left(new Error("Cannot parse non-html element"));if(!u.E.isInsertString(s))return v.left(new Error("The first operation is not a string insert"));const n=s.insert.match(/^\s*?(\.||o|||)\s+/),r=s.insert.match(/^\s*?(\d+|[a-zA-Z]+)?[\.\)][\ \t\u202F\u00A0]+/);if(null===n&&null===r||r&&s.insert.length-1===r[0].length&&1===i.ops.length)return v.right(i);const a=null!==n?"bullet":"ordered",o=null!==n?n:r;i=(new A.R).insert(s.insert.substring(o[0].length,s.insert.length),s.attributes).concat(new A.R(i.ops.slice(1)));const l=i.ops[i.ops.length-1];var c;null!=l&&u.E.isInsertString(l)&&(i=new A.R(i.ops.slice(0,-1)).push({insert:l.insert.substring(0,l.insert.length-1),attributes:l.attributes}));const d=(null!==(c=e.getAttribute("style"))&&void 0!==c?c:"").replace(/\n+/g,"").match(/level(\d+)/),h=d?Number(d[1])-1:0;return i.push({insert:"\n",attributes:{list:a,indent:h}}),v.right(i)}!function(e){e.matchNewline=[Node.TEXT_NODE,(e,t,s)=>{var r;if(!i(t,"\n")&&Boolean(null===(r=e.nodeValue)||void 0===r?void 0:r.trim())){if(n(e,s)&&"TD"!==e.tagName&&(e.childNodes.length>0||e instanceof HTMLParagraphElement))return t.insert("\n");if(t.length()>0&&e.nextSibling){let i=e.nextSibling;for(;null!=i;){if(n(i,s)&&"TD"!==e.tagName)return t.insert("\n");const r=s.query(i);if(r&&r.prototype instanceof T.zo)return t.insert("\n");i=i.firstChild}}}return t}],e.matchText=[Node.TEXT_NODE,(e,t,i)=>{var r,a;let o=e.data;if("O:P"===(null===(r=e.parentElement)||void 0===r?void 0:r.tagName))return t.insert(o.trim());if("DEL"===(null===(a=e.parentElement)||void 0===a?void 0:a.tagName))return t;if(!s(e)){if(/^\n+$/.test(o)&&!function(e,t){return e.previousElementSibling&&e.nextElementSibling&&!n(e.previousElementSibling,t)&&!n(e.nextElementSibling,t)}(e,i))return t;const s=(e,t)=>{const i=e?/[^\u00a0 ]/g:/[^\u00a0]/g,s=t.replace(i,"");return s.length<1&&e?" ":s};o=o.replace(/\r\n/g," "),o.trim().length>0&&(o=o.replace(/^\n/,""),o=o.replace(/^\s+/," "),o=o.replace(/\n$/,"")),o=o.replace(/\n\s*/g," "),o=o.replace(/\s\s+/g,s.bind(s,!0)),(null==e.previousSibling&&null!=e.parentElement&&n(e.parentElement,i)||e.previousSibling instanceof Element&&n(e.previousSibling,i))&&(o=o.replace(/^\s+/,s.bind(s,!1))),(null==e.nextSibling&&null!=e.parentElement&&n(e.parentElement,i)||e.nextSibling instanceof Element&&n(e.nextSibling,i))&&(o=o.replace(/\s+$/,s.bind(s,!1)))}return t.insert(o)}];const t=new WeakMap;function s(e){return null!=e&&(t.has(e)||("PRE"===e.tagName?t.set(e,!0):t.set(e,s(e.parentNode))),t.get(e))}function n(e,t){if(!(e instanceof Element))return!1;const i=t.query(e);return!(i&&i.prototype instanceof M.EmbedBlot)&&["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(e.tagName.toLowerCase())}}(t=e.Text||(e.Text={})),e.fancyTable=[["td",(e,t)=>{const i=Number(e.getAttribute("colspan"))||1;return e.nextSibling?s.trimTrailingNewLine(t).insert("\t".repeat(i)):t}]],e.matchOutlookEmptyLine=n,e.outlookEmptyLine=["p.MsoNormal",n],e.matchMsWordList=a;const l=e=>(t,i)=>(0,x.pipe)(a(t,i),v.fold((t=>(e.info("Cannot parse MS Word List",t),i)),o.identity));e.getMSWordList=e=>{const t=l(e.getLogger("MSWordListMatcher"));return[["p.MsoListParagraph",t],["p.MsoListParagraphCxSpFirst",t],["p.MsoListParagraphCxSpMiddle",t],["p.MsoListParagraphCxSpLast",t],["p.MsoNoSpacing",t],["h1",t],["h2",t],["h3",t],["h4",t],["h5",t],["h6",t],["p.MsoHeading7",t],["p.MsoHeading8",t],["p.MsoHeading9",t],["p.MsoTitle",t],["p.MsoSubtitle",t],["p.MsoQuote",t],["p.MsoIntenseQuote",t],['p.MsoNormal[style*="mso-list"]',t]]}}(a=e.Matchers||(e.Matchers={}))}(s||(s={})),function(e){const t="color: #4a6ee0;",i=(e,t)=>{e.setAttribute("style",t.join("; "))};e.prepareHTML=(e,s)=>{const n=[`color: ${window.getComputedStyle(e).color};`,"background: transparent;","margin-top:0pt;","margin-bottom:0pt;"].join(" ");return(0,o.flow)(r.TrailingSpaces.normalizeTrailingSpaces,v.chain((e=>S.traverseMutate(e,S.Guardians.isHTMLElement,(e=>(S.Guardians.isSPAN(e)?i(e,[n,e.parentNode&&S.Guardians.isLink(e.parentNode)?t:""]):S.Guardians.isBR(e)||(S.Guardians.isLink(e)?i(e,[n,t]):S.Guardians.isH1(e)||S.Guardians.isH2(e)?i(e,[n,"font-weight: normal;"]):S.Guardians.isLI(e)&&e.parentNode?S.Guardians.isOL(e.parentNode)?i(e,[n,`list-style-type:${s(e)[1]};`]):S.Guardians.isUL(e.parentNode)&&i(e,[n,"list-style-type:disc"]):S.Guardians.isHTMLElement(e)&&i(e,[n])),e))))))}}(n||(n={})),function(e){e.removeAllSpans=e=>(0,x.pipe)(S.traverseMutate(e,S.Guardians.isHTMLElement,(e=>{if(S.Guardians.isSPAN(e)){const t=S.moveChildrenTo(document.createDocumentFragment(),e);return t.normalize(),t}return e})),v.map((e=>(e.normalize(),e))));var t=e.space=" ",i=e.nbsp="";const s=e=>{if(0===e.length)return"";if(1===e.length)return e;const s=e.length-1,n=(s-s%2)/2;return`${i}${`${t}${i}`.repeat(n)}${2*n===s?"":i}`};let n;!function(e){var t=e.dataPreserveSpaces="data-preserver-spaces";const i=/mso-spacerun:\s*yes/;e.decodeTrailingSpaces=e=>{var s;return S.Guardians.isSPAN(e)&&(e.hasAttribute(t)||i.test(null!==(s=e.getAttribute("style"))&&void 0!==s?s:""))&&e.setAttribute("style","white-space: pre-wrap"),e},e.normalizeTrailingSpaces=e=>S.traverseMutate(e,(e=>S.Guardians.isHTMLElement(e)),(e=>{if(e.nodeType!==Node.TEXT_NODE||null==e.textContent||e.parentNode&&S.Guardians.isSPAN(e.parentNode)&&e.parentNode.hasAttribute(t))return e;{const i=e.textContent.match(/^( *)(.*?)( *)$/);if(i){const e=document.createElement("span");return e.appendChild(document.createTextNode(`${s(i[1])}${i[2]}${s(i[3])}`)),e.setAttribute(t,"true"),e}throw new I.zU("Cannot parse textContent")}}))}(n=e.TrailingSpaces||(e.TrailingSpaces={})),e.normalizeBold=e=>!S.Guardians.isHTMLElement(e)||"B"!==e.nodeName&&"STRONG"!==e.nodeName||"normal"!==e.style.fontWeight?e:S.moveChildrenTo(document.createElement("span"),e),e.cleanupStyles=e=>t=>{if(!S.Guardians.isHTMLElement(t))return t;var i;const s=(null!==(i=t.getAttribute("style"))&&void 0!==i?i:"").split(";").map((e=>e.split(":"))).filter((([t])=>e.includes(t.trim()))).map((([e,t])=>`${e}:${t}`)).join(";");return t.setAttribute("style",s),t}}(r||(r={}));const B=(0,f.Bj)((()=>C.Bx.Logging.getLogger("DEd.Clipboard")));class P extends p.Ay{get rtfSupport(){return!1}get plainTextSources(){return[]}onCapturePaste(e){try{var t,i;if(this.clipboardShortcutUsed.next(),e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const s=this.quill.getSelection(!0);if(null==s)return void B().warn("Paste event handler aborted because selection is empty");const n=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/html"),r=null===(i=e.clipboardData)||void 0===i?void 0:i.getData("text/plain");this.onPaste(s,{html:n,text:r})}catch(e){B().error("Paste event handler failed",e)}}onPaste(e,{text:t,html:i,source:n}){this.rtfSupport?i&&i.length>0?(n=s.SourceDetector.detectSource(i,[...this._sourceChecks,...s.SourceDetector.checks]),this.plainTextSources.some((e=>e===n))&&(i=void 0)):n=m.j1.PlainText:(n=null!=n?n:m.j1.Unknown,i=void 0);const r=this.quill.getFormat(e.index),a=this.convert({text:t,html:i},r),o=u.E.calcAmountLength((0,_.y1)(a)),l=this.quill.getLength()-e.length+o,h=(new(c())).retain(e.index).delete(e.length).concat(a),p=this.quill.getText(),g=p.length-1,f=p.trim().length;if(l>this._maxAllowedTextLength)this._lengthExceededCallback();else{this._flushHistory((()=>{this._options.flush(),this.quill.updateContents(h,d.Ay.sources.USER),this._options.flush()})),this.quill.setSelection(h.length()-e.length,d.Ay.sources.SILENT),this.quill.scrollSelectionIntoView();const t=this._fetchTagsAmount((0,_.y1)(h)),i=0===f?"initial":e.length===g?"reset":"partial";this.textChangedAfterPaste.next({type:i,source:n,len:o,tags:t}),0===o&&B().warn("onPaste: pasted length is 0",{source:n,rtfSupport:this.rtfSupport,formats:r,pastedDeltaLength:o,lenAfterPaste:l,textLength:g,trimmedTextLength:f,type:i})}}onCaptureCopy(e,t=!1){var i;this.clipboardShortcutUsed.next(),super.onCaptureCopy(e,t),""===(null===(i=e.clipboardData)||void 0===i?void 0:i.getData("text/html"))&&e.clipboardData.clearData("text/html")}onCopy(e,t){const{html:i,text:s}=super.onCopy(e,t);if(!this.rtfSupport||!this._rangeHasFormatting(e))return{html:"",text:this.quill.getText(e.index,e.length)};let r;if(this.rtfSupport){const e=y.aj(i,{forbidTags:["span"],allowedAttrs:["class","href","style","target"],allowDataAttrs:!1,returnHTML:!0});r=(0,o.pipe)(e,n.prepareHTML(this.quill.root,P.getOrderedListLevel),v.getOrElse((()=>e)),(e=>{const t=document.createElement("div");return t.appendChild(e),t.innerHTML}))}else r=i;return{html:`<meta name='uuid' content='uuid${this._uuid}'>${r}`,text:s}}_rangeHasFormatting(e){return(e=>(0,_.y1)(this.quill.getContents(e.index,e.length)).ops.some((e=>b.isSome(u.E.getAttr(e,_.pR.QuillFormatNames.is)))))(e)||(e=>this.quill.scroll.path(e.index+e.length).some((([e])=>S.Guardians.isLI(e.domNode)||S.Guardians.isH1(e.domNode)||S.Guardians.isH2(e.domNode))))(e)}_flushHistory(e){this.quill.history.cutoff(),e(),this.quill.history.cutoff()}convert({html:e,text:t},i={}){if(!e)return(new(c())).insert(t||"",i);const n=(0,o.pipe)(s.sanitizeContent(e),b.chain((0,o.flow)(k.Up("childNodes"),b.fromPredicate((e=>e.length>0)))),b.map((e=>{const t=document.createElement("body");for(let i=0;i<e.length;i++)t.appendChild(e[i].cloneNode(!0));return t})),b.map((e=>{const t=new WeakMap,[i,s]=this.prepareMatching(e,t);return(0,p.hV)(this.quill.scroll,e,i,s,t)})),b.getOrElse((()=>(new(c())).insert(t||"",i))));return s.trimTrailingNewLine(n,i)}dangerouslyPasteHTML(){throw new Error("dangerouslyPasteHTML is not implemented")}constructor(e,t){var i,n;super(e,{matchers:[...s.Matchers.fancyTable,...s.Matchers.getMSWordList(B()),s.Matchers.outlookEmptyLine]}),(0,a._)(this,"quill",void 0),(0,a._)(this,"_options",void 0),(0,a._)(this,"_uuid",void 0),(0,a._)(this,"_sourceChecks",void 0),(0,a._)(this,"textChangedAfterPaste",void 0),(0,a._)(this,"clipboardShortcutUsed",void 0),(0,a._)(this,"_maxAllowedTextLength",void 0),(0,a._)(this,"_lengthExceededCallback",void 0),(0,a._)(this,"syntheticPaste",void 0),(0,a._)(this,"_fetchTagsAmount",void 0),this.quill=e,this._options=t,this._uuid=y.G7(12),this._sourceChecks=[{name:m.j1.DenaliSameDocSession,test:s.SourceDetector.Test.includes(this._uuid)},{name:m.j1.DenaliOtherDocSession,test:s.SourceDetector.Test.includes("<meta name='uuid' content='uuid")}],this.textChangedAfterPaste=new g.B7,this.clipboardShortcutUsed=new g.B7,this.syntheticPaste=e=>{try{this.onPaste(new h.Q(0),{text:e,source:m.j1.Synthetic})}catch(e){B().error("Synthetic paste event handler failed",e)}},this._fetchTagsAmount=e=>Array.from(e.reduce(((e,t)=>(u.E.match((t=>Object.keys(t.attributes||{}).forEach((t=>e.add(t)))),f.Yi,(t=>Object.keys(t.attributes||{}).forEach((t=>e.add(t)))))(t),e)),new Set)),this.matchers=[s.Matchers.Text.matchText,s.Matchers.Text.matchNewline].concat(this.matchers.filter((e=>e[0]!==Node.TEXT_NODE))),this._maxAllowedTextLength=null!==(i=t.maxAllowedTextLength)&&void 0!==i?i:1e5,this._lengthExceededCallback=null!==(n=t.lengthExceededCallback)&&void 0!==n?n:f.Yi}}(0,a._)(P,"getOrderedListLevel",(e=>{let t=0,i=e.parentElement;for(;i&&!0!==i.isContentEditable;)"OL"===i.tagName&&t++,i=i.parentElement;return[t,t%3==0?"lower-roman":t%2==0?"lower-alpha":"decimal"]}));const F=(e,t)=>class extends P{get rtfSupport(){return e}get plainTextSources(){return t}}},40857:(e,t,i)=>{i.d(t,{U:()=>y});var s=i(23988),n=i(10334),r=i(17171),a=i(30040),o=i(28091),l=i(3280),c=i(88105),d=i(28986),h=i(80837),p=i(11298),u=i(38920),m=i(36840),g=i(44297),_=i(69063),f=i(16208);class y extends l.A{commit(e){this.cutoff(),e(),this.cutoff()}redo(){try{this._log.info("History action: redo"),this.change("redo","undo")}catch(e){this._log.error("History action: redo error",e)}}canRedo(){return this.stack.redo.length>0}canUndo(){return this.stack.undo.length>0}undo(){try{this._log.info("History action: undo"),this.change("undo","redo")}catch(e){this._log.error("History action: undo error",e)}}getAnonymizedOperationsHistory(){return this._anonymizedOperationsCache.toArray()}dispose(){this._subs.dispose()}record(e,t){super.record(v(e),v(t))}transform(e){super.transform(v(e))}constructor(e,t){super(e,t),(0,s._)(this,"quill",void 0),(0,s._)(this,"_options",void 0),(0,s._)(this,"_subs",void 0),(0,s._)(this,"_log",void 0),(0,s._)(this,"_anonymizedOperationsCache",void 0),this.quill=e,this._options=t,this._subs=new h.y.Keeper,this._log=_.Bx.Logging.getLogger("DEd.History"),this._anonymizedOperationsCache=new f.N(20,!0);const i=(0,u.U3)(this.quill).pipe(p.u());this._subs.push(i.subscribe((e=>{e.name===o.Ay.events.TEXT_CHANGE&&this._anonymizedOperationsCache.push({ops:c.E.anonymizeTextAndStringAttrs(e.delta).ops,source:e.source})}))),(0,m.hJ)("dedOpsHistory",(()=>this._anonymizedOperationsCache.toArray())),delete e.keyboard.bindings.Z,delete e.keyboard.bindings.z,delete e.keyboard.bindings.y}}function v(e){return(0,a.pipe)(c.E.getOps(e),g.fold((()=>new d.R(e.ops)),(t=>{const i=e.reduce(((e,t)=>c.E.match((t=>e.insert(t.insert,t.attributes&&S(t.attributes))),(t=>e.delete(t.delete)),(t=>e.retain(t.retain,t.attributes&&S(t.attributes))))(t)),new d.R),s=i.ops[0];return Boolean(i.ops)&&1===i.ops.length&&c.E.isRetain(s)&&!s.attributes?new d.R:new d.R(i.ops)})))}const b=new RegExp(`^${u.rd}_`);function S(e){return Object.keys(e).reduce(((t,i)=>b.test(i)?t:(0,r._)((0,n._)({},t),{[i]:e[i]})),{})}},3656:(e,t,i)=>{i.d(t,{TV:()=>_});var s=i(23988),n=i(10334),r=i(17171),a=i(28091),o=i(70095),l=i(28986),c=i(38920),d=i(36840),h=i(50581);const p=o.Ay.DEFAULTS.bindings;class u extends o.Ay{}function m(e){return{key:e[0].toUpperCase(),shortKey:!0,handler:d.Yi}}const g={key:" ",collapsed:!0,shiftKey:!1,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*)$/,handler(e,t){const i=t.prefix.length,[s,n]=this.quill.getLine(e.index);if(n>i)return!0;const[r,o]=(e=>{switch(e){case"-":return["dashed",/^\s*?-/];case"*":return["bullet",/^\s*?\*/];default:return["ordered",/^\s*?\d+\./]}})(t.prefix.trim());if(s&&s.prev&&!h.Guardians.isUL(s.prev.domNode)&&!h.Guardians.isOL(s.prev.domNode)&&Boolean(s.prev.domNode.textContent)&&o.test(s.prev.domNode.textContent))return!0;this.quill.insertText(e.index," ",a.Ay.sources.USER),this.quill.history.cutoff();const d=(new l.R).retain(e.index-n).delete(i+1).retain(s.length()-2-n).retain(1,{list:r});return this.quill.updateContents((0,c.po)(d),a.Ay.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-i,0,a.Ay.sources.SILENT),!1}};var _;!function(e){let t;!function(e){e.plainTextBindings={indent:p.indent,outdent:p.outdent,"outdent backspace":p["outdent backspace"],tab:p.tab,"remove tab":p["remove tab"],bold:m("bold"),italic:m("italic"),underline:m("underline")},e.rtfBindings={indent:p.indent,outdent:p.outdent,"outdent backspace":p["outdent backspace"],tab:p.tab,"remove tab":p["remove tab"],"list empty enter":p["list empty enter"],"list autofill":g,"list autofill with shift":(0,r._)((0,n._)({},g),{shiftKey:!0}),"header enter":p["header enter"]}}(t=e.Bindings||(e.Bindings={})),e.getKeyboardWithBindings=e=>{class t extends u{}return(0,s._)(t,"DEFAULTS",{bindings:e}),t}}(_||(_={}))},17559:(e,t,i)=>{i.d(t,{O:()=>G});var s,n=i(23988),r=i(10047),a=i(30040),o=i(63336),l=i(28091),c=i(27110),d=i(88105),h=i(55340),p=i(7432),u=i(72106),m=i(21216),g=i(65141),_=i(15491),f=i(36094),y=i(19711),v=i(68745),b=i(42543),S=i(11298),k=i(78339),C=i(46669),w=i(38427),E=i(60269),x=i(62822),M=i(6987),T=i(40027),A=i(14342),I=i(38920),B=i(58889),P=i(44297),F=i(80755),N=i(23121),R=i(86562),L=i(45419),D=i(69063),O=i(12486);!function(e){e.rangeMismatch="range_mismatch",e.partialRemoveMismatch="partial_update_mismatch",e.noMarkInDom="no_mark_in_dom"}(s||(s={}));class H{toString(){return`${this.type} on action '${this.action}', expected: ${this.expected}, got: ${this.got}`}constructor(e,t,i){(0,n._)(this,"action",void 0),(0,n._)(this,"got",void 0),(0,n._)(this,"expected",void 0),(0,n._)(this,"type",void 0),this.action=e,this.got=t,this.expected=i,this.type=s.rangeMismatch}}class K{toString(){return`${this.type} on action '${this.action}', expected: ${this.expected}, got: ${this.got}`}constructor(e,t,i){(0,n._)(this,"action",void 0),(0,n._)(this,"got",void 0),(0,n._)(this,"expected",void 0),(0,n._)(this,"type",void 0),this.action=e,this.got=t,this.expected=i,this.type=s.partialRemoveMismatch}}class ${toString(){return`${this.type} on action '${this.action}' for range: ${this.got}`}constructor(e,t){(0,n._)(this,"action",void 0),(0,n._)(this,"got",void 0),(0,n._)(this,"type",void 0),this.action=e,this.got=t,this.type=s.noMarkInDom}}function V(e,t){var i;return null===(i=e.getAttribute("data-mark-id"))||void 0===i?void 0:i.startsWith(t.split("|")[0])}class U{fromMarkEvent(e){return(0,o.pipe)(this._getCachedDomNodes(),B.chain(P.fold((()=>B.left(new h.C.CollapsedMarkError("cannot animate collapsed mark"))),(([e])=>B.right(e)))),B.fold((e=>m.of(B.left(e))),(t=>g.R(t,e).pipe(_.T(B.right)))))}get range(){return this._getPosition(this.id)}getRect(){return(0,o.pipe)(this._getCachedDomNodes(),B.chain(P.fold((()=>B.left(new h.C.CollapsedMarkError("Cannot get rect for collapsed mark"))),(([e,t])=>(0,o.pipe)(F.ci(e===t?Array.from(e.getClientRects()):[...Array.from(e.getClientRects()),...Array.from(t.getClientRects())]),P.fold((()=>B.left(new Error("getClientRects returned nothing "))),(e=>B.right({rootClientRect:this._getParentRect(),clientRects:e}))))))))}_getCachedDomNodes(){return(0,o.pipe)(this.range(),B.fold((()=>B.right(P.none)),(e=>{const t=p.vY.size(e);return null!==this._cachedNodes&&null!==this._cachedNodes[0].parentElement&&null!==this._cachedNodes[1].parentElement&&this._cachedMarkLength===t&&V(this._cachedNodes[0],this.id)&&V(this._cachedNodes[1],this.id)?B.right(P.some(this._cachedNodes)):(0,o.pipe)(this._getUnderlines(),B.map(P.map((([e,i])=>(this._cachedNodes=[e.domNode,i.domNode],this._cachedMarkLength=t,this._cachedNodes)))))})))}_getUnderlines(){return(0,o.pipe)(this.range(),B.fold((()=>B.right(P.none)),(e=>N.zb((()=>{const{start:t,end:i}=e,s=this._getNodeAt(t+1)[0],n=this._getNodeAt(i)[0],r=I.gl.findUnderlineUp(s),a=I.gl.findUnderlineUp(n);return(0,R.V1)(null!==r&&null!==a,"Cannot find corresponding Marker. Looks like we are trying to show/hide non-existing alert/underline",(()=>`id=${this.id}; first=${r}; firstNode=${s}; last=${a}; lastNode=${n}, getContents=${this._getQuillContents(e,20)}`)),P.some([r,a])})))))}_getQuillContents(e,t){const{start:i,end:s}=e,n=i-t,r=this._getContents(n<0?0:n,s+t),a=d.E.anonymizeTextAndStringAttrs(r);return JSON.stringify(a)}constructor(e,t,i,s,r){(0,n._)(this,"id",void 0),(0,n._)(this,"_getParentRect",void 0),(0,n._)(this,"_getPosition",void 0),(0,n._)(this,"_getNodeAt",void 0),(0,n._)(this,"_getContents",void 0),(0,n._)(this,"_cachedMarkLength",void 0),(0,n._)(this,"_cachedNodes",void 0),this.id=e,this._getParentRect=t,this._getPosition=i,this._getNodeAt=s,this._getContents=r,this._cachedMarkLength=p.vY.size(B.getOrElse((()=>p.vY.empty))(this.range())),this._cachedNodes=null}}class G extends c.A{_getMarksByBlot(e){return(0,o.pipe)(P.fromNullable(I.gl.getMarksIdsByBlot(e)),P.filterMap((0,a.flow)(r.x1((0,a.flow)((e=>this._marks.get(e)),P.fromNullable)),F.ci)))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_marksValidation(e,t,i){const s=e.filter((e=>!(e.action!==h.C.Change.ActionType.remove&&e.action!==h.C.Change.ActionType.update||p.IL.is(e.meta.range())||(0,I.Vc)(e.id)))).map((e=>({id:e.id,action:e.action,range:p.vY.copy(e.meta.range())})));s.length>0&&f._F.inRic(m.of(void 0),2e3).pipe(_.T((()=>function(e,t){return(0,o.pipe)((i=e,N.zb((()=>{const{deltaMarks:e}=i.ops.reduce((({deltaMarks:e,deltaLength:t},i)=>{if(!d.E.isInsert(i))throw new Error(`Quill marks: insert delta expected ${i}`);const s=d.E.getInsertLength(i),n=i.attributes||{},r=Object.keys(n);return 0===r.length||r.filter(I.Z5).forEach((i=>{const r=p.vY.create(t,t+s,n[i]);if(e.has(i)){const t=e.get(i);if(t.start>r.end+1)throw new Error(`Corrupted partial range. End part1: ${r.end}, start part2: ${t.start}`);e.set(i,p.vY.join(r,t))}else e.set(i,r)})),{deltaMarks:e,deltaLength:t+s}}),{deltaMarks:new Map,deltaLength:0});return e}))),B.map((e=>(0,o.pipe)(t.map((t=>(0,o.pipe)(P.fromNullable(e.get((0,I.VL)(t.id))),(e=>function(e,t){return(0,o.pipe)(t,P.fold((()=>p.vY.isEmpty(e.range)?P.none:P.some(B.right(new $(e.action,e.range)))),(t=>e.action===h.C.Change.ActionType.remove&&e.removeType===u.J.Change.RemoveType.partial?p.vY.contains(e.range,t)?P.none:P.some(B.left(new K(e.action,e.range,t))):p.vY.ord.equals(t,e.range)?P.none:P.some(p.vY.contains(t,e.range)?B.right(new H(e.action,e.range,t)):B.left(new H(e.action,e.range,t))))))}(t,e))))),r.YO.sequence(P.option),P.getOrElse((()=>[]))))));var i}(t,s))),y.$()).subscribe({next:B.fold((e=>this._log.warn("Cannot collect marks to validate",e)),(e=>e.forEach(B.fold((e=>{this._log.warn("Got invalid marks",{error:e,opsHistory:i})}),(e=>this._log.info("Range does not match with mark",{rangeMismatch:e,opsHistory:i}))))))})}_createMarkModel(e){const t=new U(e.id,(()=>this.quill.container.getBoundingClientRect()),(()=>()=>{const t=e.meta.range();return p.vY.isEmpty(t)?B.left(t):B.right(t)}),(e=>this.quill.getLeaf(e)),((e,t)=>(0,I.y1)(this.quill.getContents(e,t))));return this._marks.set(t.id,t),(0,I.is)(t.id),t}_getMarksModels(e){return e.reduce(((e,t)=>{switch(t.action){case h.C.Change.ActionType.create:const i=this._createMarkModel(t);e.created.set(i.id,B.right(i));break;case h.C.Change.ActionType.update:this._marks.has(t.id)?e.created.set(t.id,B.right(this._marks.get(t.id))):e.updated.set(t.id,B.left(new R.zU("Cannot update unknown mark")));break;case h.C.Change.ActionType.remove:if(!this._marks.has(t.id))throw e.removed.set(t.id,B.left(new R.zU("Cannot remove unknown mark"))),new R.zU("Cannot remove unknown mark");this._marks.delete(t.id),this._ensureActive(t.id),e.removed.set(t.id,B.right(void 0));break;default:(0,R.xb)(t)}return e}),h.C.Change.Result.getEmpty())}_getMarkAttributes(e){const t=(0,I.VL)(e.id);switch(e.action){case h.C.Change.ActionType.create:return{[t]:{action:h.C.Change.ActionType.create,id:e.id,classes:e.meta.classes,order:e.meta.order}};case h.C.Change.ActionType.update:return{[t]:{action:h.C.Change.ActionType.update,id:e.id,classes:e.meta.classes,order:e.meta.order}};case h.C.Change.ActionType.remove:return{[t]:!1};default:return(0,R.xb)(e)}}_ensureActive(e){(0,o.pipe)(this.activeMarks.getValue(),P.filter((t=>t.some((t=>t.id===e)))),P.map((()=>{this.activeMarks.next(P.none)}))),(0,o.pipe)(this.hoveredMarks.getValue(),P.filter((t=>t.some((t=>t.id===e)))),P.map((()=>this.hoveredMarks.next(P.none))))}_findInsertsToUnwrap(e,t){return this.quill.scroll.path(e+1).reduce(((i,[s,n])=>s instanceof I.z2?((1===n&&!I.gl.hasSameIdSibling(s,I.gl.LOOKUP_DIRECTION.left)||n+t-1===s.length()&&!I.gl.hasSameIdSibling(s,I.gl.LOOKUP_DIRECTION.right))&&i.push(u.J.Change.getRemoveAction({range:()=>p.vY.create(e,e+t)},u.J.Change.RemoveType.partial)(s.markId)),i):i),[])}_unwrapMarkExtension(e){const{toRemove:t}=e.reduce((({start:e,toRemove:t},i)=>((0,I.eB)(i)&&t.push(...this._findInsertsToUnwrap(e,d.E.getInsertLength(i))),{start:e+(0,I.wq)(i),toRemove:t})),{start:0,toRemove:[]});t.length&&this.quill.updateContents((0,I.po)((0,I.QW)(t,this._getMarkAttributes)),l.Ay.sources.API)}constructor(e,t){super(e,t),(0,n._)(this,"quill",void 0),(0,n._)(this,"options",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_marks",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"activeMarks",void 0),(0,n._)(this,"hoveredMarks",void 0),(0,n._)(this,"markChangeApplied",void 0),(0,n._)(this,"getMarkById",void 0),(0,n._)(this,"changeMarks",void 0),this.quill=e,this.options=t,this._subs=[],this._marks=new Map,this._log=D.Bx.Logging.getLogger("MarksManager",O.$.DEBUG),this.activeMarks=new v.t(P.none),this.hoveredMarks=new v.t(P.none),this.markChangeApplied=new b.B7,this.getMarkById=e=>(0,o.pipe)(this._marks.get(e),B.fromNullable(new Error(`Cannot find mark by id: ${e}`))),this.changeMarks=e=>{if(0===e.length)return h.C.Change.Result.getEmpty();const t=this._getMarksModels(e);return this._marksValidation(e,(0,I.y1)(this.quill.editor.delta),this.options.getOpsHistory()),this.quill.updateContents((0,I.po)((0,I.QW)(e,this._getMarkAttributes)),l.Ay.sources.API),e.forEach((e=>e.action===h.C.Change.ActionType.remove&&(0,I.p0)(e.id))),this.markChangeApplied.next(e.map((e=>e.id))),t};const i=(0,I.U3)(this.quill).pipe(S.u());this._subs.push(i.pipe(k.p(I.wM)).subscribe((({delta:e})=>{this._unwrapMarkExtension(e.ops)})),i.pipe(k.p(I.vi),k.p((({range:e})=>Boolean(e)&&0===e.length)),C.F(((e,t)=>e.range.index===t.range.index&&e.range.length===t.range.length)),_.T((({range:e,source:t})=>t===l.Ay.sources.USER?(0,o.pipe)(P.fromNullable(e),P.chain((e=>{const t=this.quill.getLeaf(e.index)[0],i=this.quill.getLeaf(e.index+1)[0];if(null===t)return P.none;if(i!==t&&i){const e=(0,o.pipe)(this._getMarksByBlot(t),P.fold((()=>[]),a.identity)),s=(0,o.pipe)(this._getMarksByBlot(i),P.fold((()=>[]),a.identity));return L.FM(e.concat(s))}return this._getMarksByBlot(t)}))):P.none))).subscribe(this.activeMarks),w.zV([E.h(g.R(this.quill.root,"mouseenter").pipe(x.u(!0)),g.R(this.quill.root,"mouseleave").pipe(x.u(!1))).pipe(C.F()),this.options.ongoingSelection]).pipe(M.n((([e,i])=>i?m.of(P.none):e?E.h(t.contentUpdated.pipe(x.u(P.none)),t.scrollPositionChanged.pipe(x.u(P.none)),g.R(this.quill.root,"mousemove",{passive:!0}).pipe(T.Z(50),_.T((e=>{const t=document.elementFromPoint(e.clientX,e.clientY);try{const e=l.Ay.find(t,!0);return!Boolean(e)||e instanceof l.Ay?P.none:this._getMarksByBlot(e)}catch(e){return P.none}})))):m.of(P.none).pipe(A.c(200)))),C.F(P.getEq({equals:(e,t)=>e.length===t.length&&e.every(((e,i)=>t[i]===e))}).equals)).subscribe(this.hoveredMarks))}}(0,n._)(G,"DEFAULTS",{})},91177:(e,t,i)=>{i.d(t,{H:()=>b,_:()=>v});var s=i(23988),n=i(10334),r=i(17171),a=i(50659),o=i(87574),l=i(19840),c=i(35098),d=i(19772),h=i(90405),p=i(19711),u=i(95168),m=i(15491),g=i(74168),_=i(46669),f=i(89769),y=i(36094);class v extends a.Component{componentDidMount(){this.props.onMount&&this.props.onMount(this._editorWrapEl)}shouldComponentUpdate(){return!1}render(){const{theme:e={},children:t,onMouseDown:i}=this.props;return a.createElement("div",{className:e.editorContentWrap,onMouseDown:i},a.createElement(o.F.div,(0,r._)((0,n._)({},(0,l.Ly)(e.editorContent)),{mount:e=>e&&(this._editorWrapEl=e)}),t))}constructor(...e){super(...e),(0,s._)(this,"_editorWrapEl",void 0)}}const b=e=>{const t=a.useContext(c.L.Context),{ref:i,onMount:s}=d.R.useElWatcher();d.R.useSubscriptionTo(i.pipe(h.Kc((i=>e.scrollEl.pipe(h.oE,p.$(),u.M((s=>e.denaliEditor.attach(i,s,t.pipe(m.T((e=>e.rect))))))))))),d.R.useSubscriptionTo(i.pipe(h.Kc((t=>g.sc(t).pipe(m.T((e=>e.height)),_.F(),f.Z(t.getBoundingClientRect().height),u.M(y.H9(e.editorHeight))))))),a.useEffect((()=>()=>e.denaliEditor.dispose()));const{theme:n={},children:r}=e;return a.createElement(v,{theme:n,onMount:s},r)}},94808:(e,t,i)=>{i.d(t,{W:()=>Pe,H:()=>Fe.H});var s=i(23988),n=i(10334),r=i(17171),a=i(10047),o=i(47370),l=i(30040),c=i(63336),d=i(28091),h=i(62146),p=i(72396),u=i(65789),m=i(78477),g=i(80074),_=i(49004),f=i(88105),y=i(28986),v=i(76005),b=i(7432),S=i(72106),k=i(34980),C=i(15114),w=i(46669),E=i(62822),x=i(36094),M=i(68594),T=i(65141),A=i(78339),I=i(10540),B=i(48209),P=i(95168),F=i(6987),N=i(3346),R=i(54988),L=i(15491),D=i(28066),O=i(90405),H=i(38427),K=i(58347),$=i(21216),V=i(60269),U=i(21662),G=i(88423),Q=i(8331),W=i(61586),q=i(80837),z=i(59183),j=i(68745),J=i(42543),Y=i(60246),Z=i(43308),X=i(14342),ee=i(83541),te=i(81930),ie=i(11298),se=i(62723),ne=i(89769),re=i(24946),ae=i(40027),oe=i(19711),le=i(36735),ce=i(98814),de=i(38920),he=i(50581),pe=i(86562),ue=i(44297),me=i(58889),ge=i(36840),_e=i(58193),fe=i(23121),ye=i(34717),ve=i(69063),be=i(12486),Se=i(36644),ke=i(29145),Ce=i(82874),we=i(40857),Ee=i(3656),xe=i(17559),Me=i(19101);const Te=(e,t)=>{const i=Boolean(d.Ay.imports[e])?d.Ay.import(e):null;return d.Ay.register(e,t,!0),()=>{d.Ay.imports[e]===i&&(Boolean(i)?d.Ay.register(e,i,!0):delete d.Ay.imports[e])}};var Ae,Ie,Be;!function(e){var t,i,s,n,r=e.withDefaultThemeClasses=(e={})=>({editor:he.classes(Me.EN,e.editor),containerClass:null!==(t=e.containerClass)&&void 0!==t?t:"",scrollWrap:null!==(i=e.scrollWrap)&&void 0!==i?i:"",markExtraClass:null!==(s=e.markExtraClass)&&void 0!==s?s:"",markClassesTheme:null!==(n=e.markClassesTheme)&&void 0!==n?n:(0,C.TM)()});e.getDefaultThemeClasses=()=>r({})}(Ae||(Ae={})),function(e){e.api="api",e.dox="dox",e.user="user"}(Ie||(Ie={})),(Ie||(Ie={})).toQuillSources=e=>{switch(e){case Ie.dox:case Ie.user:return d.Ay.sources.USER;case Ie.api:return d.Ay.sources.API;default:return(0,pe.xb)(e)}},function(e){e.isLocalDelta=e=>"dox"!==e.source&&_.lY.isDelta(e.change)}(Be||(Be={}));class Pe{_initQuill(e,t){const i=[...Object.entries(t.modules).map((([e,t])=>Te(`modules/${e}`,t))),...t.formats.map((e=>Te(`formats/${e.blotName}`,e)))],s=(0,r._)((0,n._)({},Object.keys(t.modules).reduce(((e,t)=>(e[t]=!0,e)),{})),{keyboard:!0,clipboard:{maxAllowedTextLength:1e5,lengthExceededCallback:()=>alert("Oops, Document size exceeded!"),flush:this._flush,deltaFilter:this._deltaFilter},history:{userOnly:!0,delay:1e3,maxStack:100,flush:this._flush},marks:{scrollPositionChanged:this.scrollPosition.pipe(w.F(),E.u(x.q6),M.i(1)),contentUpdated:this.contentUpdated,scrollContainer:this._scrollEl,ongoingSelection:this.ongoingSelection.pipe(w.F()),getOpsHistory:()=>this._history.getAnonymizedOperationsHistory()}}),a=new d.Ay(this._editorEl,{modules:s});a.root.setAttribute("spellcheck","false");const o=a.container.className,l=a.root.className;return this._subs.push(e.subscribe((e=>{a.root.className=he.classes(e.editor,l),a.container.className=he.classes(e.containerClass,o)}))),i.forEach((e=>e())),a}_pushDelta(e){void 0===this._outgoingChanges?this._outgoingChanges=_.lY.delta(this._deltaFilter(e),this._textLength):this._outgoingChanges.delta=this._outgoingChanges.delta.compose(this._deltaFilter(e));const t=f.E.calcAmountLength(e);!Boolean(this._outgoingChanges.isEmpty)&&(t>100||this._textLength-t<=1||void 0!==e.ops.find((e=>(0,de.h)(e)||(0,de.eB)(e)))||ue.isSome(this.activeMarks.getValue()))?this._applyingExternalChanges||this.flushChanges():(void 0!==this._changesSyncTimer&&clearTimeout(this._changesSyncTimer),this._changesSyncTimer=setTimeout(this.flushChanges,1500))}_setTextLength(e,t){const i=this._textLength-e;this._textLength=e;const s="api"===t?v.LN.Meta.Source.api:v.LN.Meta.Source.user,n="api"===t?{}:this.getFormatting(b.vY.create(e-1,0)),{index:r,length:a}=this.getCursor();r+a>=e&&this.selection.next({index:r,length:a-i,meta:{source:s,formatting:n}})}_handleFreezeFocus(){const e=(e,t)=>e===t||this._allowNavigationTo(e),t=T.R(document,"click").pipe(A.p((t=>!e(t.target,this.quill.root))),I.QE(B.$),A.p((()=>!e(document.activeElement,this.quill.root))),P.M((()=>this._restoreFocus("navigatedFromQuill"))));return this._freezeFocus.state.pipe(F.n(x._F.rafScheduler),P.M((e=>e?this._restoreFocus("focusFreeze"):this.quill.blur())),F.n(x.vh(t)),N.W((e=>(this._log.warn("unexpected exception in freezeFocus",e),R.w)))).subscribe()}attach(e,t,i){if(Boolean(this._wrapper))throw new Error("Editor already attached");this._wrapper=e,this._scrollEl.next(ue.some(t)),this._viewportRect=i,e.appendChild(this._editorEl),this._textLength?me.getOrElse((e=>this._log.error(`Failed to reset cursor on ded attach ${e}`)))(this.setCursor(0,0)):this.quill.root.focus(),(0,ge.hJ)("dedBlockFlush",(()=>this._isFlushBlocked=!0)),(0,ge.hJ)("dedAllowFlush",(()=>this._isFlushBlocked=!1)),(0,ge.hJ)("dedForceFlush",(()=>this.flushChanges())),(0,ge.hJ)("dedGetText",this.getText),(0,ge.hJ)("dedSetCursor",((e,t)=>me.getOrElse((e=>this._log.error(e)))(this.setCursor(e,t,d.Ay.sources.USER)))),(0,ge.hJ)("dedGetCursor",(()=>this.getCursor())),(0,ge.hJ)("dedType",(e=>{this.flushChanges(),this._pushChanges(_.lY.ins(this.getCursor().index,e,this.getText().length),Ie.user)})),(0,ge.hJ)("dedQuill",this.quill),(0,ge.hJ)("ded",this),(0,ge.hJ)("getPossibleCursorPosition",((e,t,i)=>this.getPossibleCursorPosition("string"==typeof e?me.left(e):me.right(e),"string"==typeof t?me.left(t):me.right(t),i))),this._subs.push(this._handleFreezeFocus(),T.R(this.quill.root,"mouseup").pipe(L.T((e=>({clicks:e.detail,range:ue.fromNullable(this.quill.getSelection())}))),L.T((({clicks:e,range:t})=>(0,c.pipe)(t,ue.chain((e=>(0,de.a3)(this.quill.getText(),e.index))),ue.filter((e=>""!==e.meta.value)),ue.map(b.h0.create(e)))))).subscribe(this.clickedWord),this._scrollTo.pipe(D.w()).subscribe(this._setScroll),this._scrollEl.pipe(O.oE,F.n((e=>T.R(e,"scroll").pipe(L.T(this._getScroll))))).subscribe(this.scrollPosition),H.zV(this._contentChange.pipe(A.p((({source:e})=>e===d.Ay.sources.USER))),this._viewportRect).subscribe((([,e])=>{requestAnimationFrame((()=>{(0,c.pipe)(this._getCursorRect(),me.fold((e=>(this._log.warn("Typing enhancer: Cannot get cursor rect",e),ue.none)),l.identity),_e.Mi((t=>{const i=Math.ceil(t.top+t.height),s=Math.ceil(.7*Math.max(e.top+e.height));i>s&&this._scrollTo.next(this._getAnimation({scrollTop:this._getScroll()+Math.round(i-s),animate:v.nA.initial},this._getScroll()))})))}))})),H.zV([this._scrollEl.pipe(O.oE),this._historyChanged]).subscribe((([e])=>requestAnimationFrame((()=>{(0,c.pipe)(this._getCursorRect(),me.fold((e=>(this._log.warn("Undo/Redo: Cannot get cursor rect",e),ue.none)),l.identity),_e.Mi((t=>{const i=e.getBoundingClientRect();(t.top<i.top||t.top>i.bottom)&&this._scrollTo.next(this._getAnimation({scrollTop:this._getScroll()+Math.round(t.top-i.top-i.height/2),animate:v.nA.none},this._getScroll()))})))})))),H.zV(this._viewportRect,this.scrollPosition.pipe(K.B(150))).pipe(L.T(a.d5),O.Kc((0,l.flow)(this._calculateViewport,$.of))).subscribe(this.viewport),V.h(T.R(this.quill.root,"blur").pipe(E.u(!1)),T.R(this.quill.root,"focus").pipe(E.u(!0))).subscribe(this.isEditorFocused),this._execCommandAfterFocus.pipe(U.E(this.isEditorFocused)).subscribe((([e,t])=>{t||this._restoreFocus("Restore focus after copy/cut"),document.execCommand(e)})))}dispose(){this._subs.dispose(),this._marker.dispose(),this._history.dispose(),this.quill.emitter.removeAllListeners()}setContents(e,t=Ie.api){const i=(0,de.H6)(e),s=void 0!==this._outgoingChanges,n=e.delta.compose(i.delta),r=f.E.calcDiffLength(n),a=this._deltaFilter(n),o=f.E.calcDiffLength(a);this._log.debug("reset content",{shouldNormalizeCRLF:!i.isEmpty,hasOutgoingChanges:s,deltaLength:r,deltaWithoutAttrsLength:o,deltaLengthMismatch:r!==o}),this.quill.setContents((0,de.po)(a),"api"),this._setTextLength(r,t),t!==Ie.dox||i.isEmpty||(this._log.warn("Received Reset from DOX without trailing linebreak. Pushing linebreak delta to DOX",i),this._doxSync.pushChanges(i)),"api"!==t?this._changes.next({change:_.lY.unsafeRes(n),source:t}):i.isEmpty||this._changes.next({change:i,source:t})}getCursor(){const e=this.selection.getValue();return(0,r._)((0,n._)({},e),{meta:(0,r._)((0,n._)({},e.meta),{formatting:this.getFormatting(v.LN.toTextRange(e))})})}getLastPossibleCursorPosition(){return this._textLength-1}getSelectionRect(e){return(0,c.pipe)(this._getDocumentRange(e||this.getCursor()),me.map((e=>new de.Yc(e,(()=>this.quill.container.getBoundingClientRect())))))}changeMarks(e){this.flushChanges(),this._log.debug("change marks",e.map(S.J.Change.addRange));const t=this._marker.changeMarks(e);return this.isEditorFocused.getValue()&&this._restoreFocus("changeMarks"),t}_scrollToPosition(e){const t=this._getScroll(),i=this._normalizeScrollOffset(e.scrollTop-this._getScrollTop());this._scrollTo.next(this._getAnimation({scrollTop:t+i,animate:e.animate},t).pipe(G.j((()=>{const e=this._getScroll();this._scrollTo.next(this._getAnimation({scrollTop:e,animate:v.nA.none},e))}))))}get contentRect(){return(0,c.pipe)(ue.fromNullable(this._wrapper),ue.map((e=>e.getBoundingClientRect())))}getMarkRect(e){return(0,c.pipe)(this._marker.getMarkById(e),me.chain((e=>e.getRect())))}getMarkById(e){return this._marker.getMarkById(e)}scrollToMark(e,t={animate:v.nA.none,paddingTop:0}){return(0,c.pipe)(this._marker.getMarkById(e),me.chain((e=>this._getMarkRect(e))),me.fold((e=>(this._log.error("Cannot scroll to given mark",e),Q.$(e))),(e=>{const i=t.animate||v.nA.none,s=this._getScrollTop(),n=this._normalizeScrollOffset(e.top-(t.paddingTop?t.paddingTop:s));return new W.c((e=>(e.next(void 0),this._scrollTo.next(this._getAnimation({scrollTop:this._getScroll()+n,animate:i},this._getScroll()).pipe(G.j((()=>{e.complete()})))),()=>{this._scrollTo.next(this._getAnimation({scrollTop:this._getScroll(),animate:v.nA.none},this._getScroll()))})))})))}undo(e="user"){this._history.undo(),this._historyChanged.next({source:e})}canUndo(){return this._history.canUndo()}clearHistory(){this._history.clear()}redo(e="user"){this._history.redo(),this._historyChanged.next({source:e})}canRedo(){return this._history.canRedo()}cut(){this._execCommandAfterFocus.next("cut")}copy(){this._execCommandAfterFocus.next("copy")}dontFreezeWhen(e,t){return!0===this._options.freezeFocusFeature?this._freezeFocus.watch(x.B8(e),t):q.y.EMPTY}_getScrollTop(){return(0,c.pipe)(this._getScrollRect(),ue.fold((()=>0),(e=>e.top)))}_getMarkRect(e){return(0,c.pipe)(e.getRect(),me.map(k.W.relativeToViewport),me.map((e=>({top:e.top,bottom:e.bottom}))))}_getCursorRect(){return me.tryCatch((()=>(0,c.pipe)(ue.fromNullable(this.quill.getSelection()),ue.filter((e=>0===e.length)),ue.chain((e=>ue.fromNullable(this.quill.getBounds(e.index,1)))),ue.map((e=>{const t=this.quill.container.getBoundingClientRect();return{bottom:e.bottom+t.top,height:e.height,left:e.left+t.left,right:e.right+t.left,top:e.top+t.top,width:e.width}})))),(e=>e))}_ensureSelection(e){const t=this.quill.getSelection();e(),t&&t.length>0&&this._clearSelection((()=>{this.quill.setSelection(t.index,t.length,d.Ay.sources.API)}))}_clearSelection(e){const t=Boolean(window.getSelection)?window.getSelection():document.selection;Boolean(t)&&(Boolean(t.removeAllRanges)?t.removeAllRanges():Boolean(t.empty)&&t.empty()),e&&requestAnimationFrame(e)}_addFormatting(e,t,i){t===v.M_.Type.link?this._applyFormatting(v.M_.Type.link,e,i):this._applyFormatting(t,e)}_removeFormatting(e,t){t===v.M_.Type.link?this._applyFormatting(v.M_.Type.link,e,!1):this._applyFormatting(t,e,!1)}_clearFormatting(e){b.vY.isEmpty(e)&&(v.M_.asList.forEach((e=>{const{key:t}=de.pR.mapEditorFormatToQuill(e);this.quill.format(t,!1,"user")})),this._contentUpdatedInternal.next({type:v.D_.Type.onlyFormatting,source:"user",delta:new y.R})),this.quill.removeFormat(e.start,b.vY.size(e),d.Ay.sources.USER)}_applyFormatting(e,t,i){const{key:s,value:n}=de.pR.mapEditorFormatToQuill(e),r=void 0!==i?i:n;if(b.vY.isEmpty(t)){if(e===v.M_.Type.link)return;this.quill.format(s,r,"user"),this._contentUpdatedInternal.next({type:v.D_.Type.onlyFormatting,source:"user",delta:new y.R})}else this._getFormattingFn(e)(t.start,b.vY.size(t),s,r,"user")}getFormatting(e){return de.pR.mapQuillFormatsToDenali(this.quill,e)}constructor(e,t,i,n,r){(0,s._)(this,"_doxSync",void 0),(0,s._)(this,"_allowedAttrs",void 0),(0,s._)(this,"_allowedEmbeds",void 0),(0,s._)(this,"_options",void 0),(0,s._)(this,"_log",void 0),(0,s._)(this,"_freezeFocus",void 0),(0,s._)(this,"_subs",void 0),(0,s._)(this,"_editorEl",void 0),(0,s._)(this,"_scrollEl",void 0),(0,s._)(this,"_viewportRect",void 0),(0,s._)(this,"_wrapper",void 0),(0,s._)(this,"_quillEditorChange",void 0),(0,s._)(this,"_scrollTo",void 0),(0,s._)(this,"_textLength",void 0),(0,s._)(this,"_outgoingChanges",void 0),(0,s._)(this,"_changesSyncTimer",void 0),(0,s._)(this,"_marker",void 0),(0,s._)(this,"_history",void 0),(0,s._)(this,"_historyChanged",void 0),(0,s._)(this,"_allowNavigationTo",void 0),(0,s._)(this,"_clipboard",void 0),(0,s._)(this,"_contentChange",void 0),(0,s._)(this,"_isFlushBlocked",void 0),(0,s._)(this,"quill",void 0),(0,s._)(this,"textChangedAfterPaste",void 0),(0,s._)(this,"shortcutUsed",void 0),(0,s._)(this,"_deltaFilter",void 0),(0,s._)(this,"_userClasses",void 0),(0,s._)(this,"flushChanges",void 0),(0,s._)(this,"_flush",void 0),(0,s._)(this,"_changes",void 0),(0,s._)(this,"changes",void 0),(0,s._)(this,"_contentUpdatedInternal",void 0),(0,s._)(this,"contentUpdated",void 0),(0,s._)(this,"selection",void 0),(0,s._)(this,"selectedFormatting",void 0),(0,s._)(this,"clickedWord",void 0),(0,s._)(this,"scrollPosition",void 0),(0,s._)(this,"activeMarks",void 0),(0,s._)(this,"hoveredMarks",void 0),(0,s._)(this,"markChangeApplied",void 0),(0,s._)(this,"scrollPercentage",void 0),(0,s._)(this,"ongoingSelection",void 0),(0,s._)(this,"viewport",void 0),(0,s._)(this,"viewportRange",void 0),(0,s._)(this,"isEditorFocused",void 0),(0,s._)(this,"_execCommandAfterFocus",void 0),(0,s._)(this,"_validateSelection",void 0),(0,s._)(this,"_documentRangeCache",void 0),(0,s._)(this,"_getDocumentRange",void 0),(0,s._)(this,"_setNativeSelection",void 0),(0,s._)(this,"_restoreFocus",void 0),(0,s._)(this,"_scrollToCursor",void 0),(0,s._)(this,"restoreFocus",void 0),(0,s._)(this,"_getAnimation",void 0),(0,s._)(this,"_applyingExternalChanges",void 0),(0,s._)(this,"_pushChanges",void 0),(0,s._)(this,"pushChanges",void 0),(0,s._)(this,"_text",void 0),(0,s._)(this,"getText",void 0),(0,s._)(this,"getHTML",void 0),(0,s._)(this,"getTextLength",void 0),(0,s._)(this,"getContents",void 0),(0,s._)(this,"setCursor",void 0),(0,s._)(this,"scrollToTitle",void 0),(0,s._)(this,"_getScrollRect",void 0),(0,s._)(this,"_getScroll",void 0),(0,s._)(this,"_normalizeScrollOffset",void 0),(0,s._)(this,"_setScroll",void 0),(0,s._)(this,"_calculateViewport",void 0),(0,s._)(this,"containsElement",void 0),(0,s._)(this,"getPossibleCursorPosition",void 0),(0,s._)(this,"setFormatting",void 0),(0,s._)(this,"_getFormattingFn",void 0),this._doxSync=t,this._allowedAttrs=i,this._allowedEmbeds=n,this._options=r,this._log=ve.Bx.Logging.getLogger("DEd",be.$.DEBUG,be.I.Model.getColor("DEd")),this._freezeFocus=new z.p.Impl("freezeFocus",!0===this._options.freezeFocusFeature?z.p.everyTrue:()=>!1),this._subs=new q.y.Keeper,this._editorEl=document.createElement("div"),this._scrollEl=new j.t(ue.none),this._scrollTo=new J.B7,this._textLength=0,this._outgoingChanges=void 0,this._historyChanged=new J.B7,this._isFlushBlocked=!1,this.shortcutUsed=new J.B7,this._deltaFilter=f.E.cleanDelta(this._allowedEmbeds,this._allowedAttrs),this._userClasses=this._options.classes?this._options.classes.view(Ae.withDefaultThemeClasses):g.s.create(Ae.getDefaultThemeClasses()),this.flushChanges=(e=Ie.api)=>{if(!this._isFlushBlocked&&void 0!==this._outgoingChanges){this._log.trace("flushChanges");const t=this._outgoingChanges;this._outgoingChanges=void 0,void 0!==this._changesSyncTimer&&(clearTimeout(this._changesSyncTimer),this._changesSyncTimer=void 0),Boolean(t.isEmpty)||(this._log.debug("emit changes",{textLength:this.getTextLength(),deltaLength:t.length,deltaAmount:t.amount,deltaTargetLen:t.prevLen}),this._changes.next({change:t,source:e}))}},this._flush=()=>{this.flushChanges(),this._changes.next({change:_.lY.flush(),source:Ie.api})},this._changes=new Y.m,this.changes=this._changes.pipe(Z.E("change")),this._contentUpdatedInternal=new J.B7,this.contentUpdated=this._contentUpdatedInternal.pipe(X.c(1)),this.selection=new j.t(v.LN.empty),this.selectedFormatting=V.h(this._contentUpdatedInternal.pipe(A.p((e=>e.type===v.D_.Type.onlyFormatting)),U.E(this.selection,((e,t)=>t))),this.selection).pipe(L.T((e=>this.getFormatting(v.LN.toTextRange(e)))),ee.shareReplay({bufferSize:1,refCount:!0})),this.clickedWord=new J.B7,this.scrollPosition=new j.t(0),this.ongoingSelection=new j.t(!1),this.viewport=new j.t({text:he.Rect.empty,wrapper:he.Rect.empty}),this.isEditorFocused=new j.t(!0),this._execCommandAfterFocus=new J.B7,this._validateSelection=({index:e,length:t})=>fe.zb((()=>((0,pe.V1)(e+t>=0,"Selection is less than zero",(()=>`index: ${e}, length: ${t}`)),(0,pe.V1)(e+t<this._textLength,"Selection is greater than text length",(()=>`index: ${e}, length: ${t}, text length: ${this._textLength}`)),{index:e,length:t}))),this._documentRangeCache=ce.l.createCache(5),this._getDocumentRange=(0,l.flow)(this._validateSelection,me.chain((e=>(0,c.pipe)(this._documentRangeCache.get(e),ue.fold((()=>(0,c.pipe)(e,ce.l.BoundaryPoint.getPoints((t=>{const i=this.quill.getLeaf(t);return(0,pe.V1)(null!==i[0],"Failed to get boundary point",(()=>JSON.stringify({quillTextLength:this.quill.getLength(),path:this.quill.scroll.path(t).map((([e,t])=>[e.statics.blotName,t])),dedTextLength:this._textLength,position:t,selection:e}))),(0,de.RU)(i)})),me.chain(ce.l.BoundaryPoint.toNativeRange))),me.right),me.map((t=>(this._documentRangeCache.set(e,t),t))))))),this._setNativeSelection=(e,t)=>(0,c.pipe)(this._getDocumentRange(e),me.map((e=>{const i=window.getSelection()||document.selection;i.removeAllRanges(),i.addRange(e),this.quill.focus({preventScroll:t})}))),this._restoreFocus=e=>(0,c.pipe)(this.getCursor(),this._setNativeSelection,me.getOrElse((t=>this._log.error("Cannot reset focus",t,e)))),this._scrollToCursor=()=>(0,c.pipe)(this._getCursorRect(),me.getOrElse((e=>(this._log.warn("Scroll to cursor: Cannot get cursor rect",e),ue.none))),ue.chain((e=>(0,c.pipe)(this._getScrollRect(),ue.map((t=>({cursorRect:e,wrapperRect:t})))))),_e.Mi((({cursorRect:e,wrapperRect:t})=>this._scrollToPosition({scrollTop:Math.round(e.top-t.top-t.height/2),animate:v.nA.initial})))),this.restoreFocus=e=>{this._restoreFocus(e),this._scrollToCursor()},this._getAnimation=(e,t)=>{switch(e.animate){case v.nA.none:return $.of(e.scrollTop);case v.nA.fast:return te.X.createAnimationObservable(t,e.scrollTop,100);case v.nA.initial:return te.X.createAnimationObservable(t,e.scrollTop,200);case v.nA.fake:return function(e,t,i){return W.c.create((s=>{const n=Math.abs(e-t)<250?0:e-t>0?Math.min(e-t,250):Math.max(e-t,-250);i.style.transform=`translateY(${n}px)`,i.style.transition="",s.next(e);const r=requestAnimationFrame((()=>{i.style.transition="transform 150ms linear",i.style.transform=""}));return()=>{cancelAnimationFrame(r),i.style.transition="",i.style.transform=""}}))}(e.scrollTop,t,this._wrapper);default:return(0,pe.xb)(e.animate)}},this._applyingExternalChanges=!1,this._pushChanges=(e,t)=>{this._log.trace("pushChanges",e),_.lY.isFlush(e)?this.flushChanges(t):_.lY.isReset(e)?(this._log.debug("get reset",{source:t,textLength:this.getTextLength(),deltaLength:e.length}),this._outgoingChanges=void 0,this.setContents(e,t)):(this._log.debug("get changes",{source:t,textLength:this.getTextLength(),deltaLength:e.length,deltaAmount:e.amount,deltaTargetLen:e.prevLen,change:e}),(0,pe.V1)(void 0===this._outgoingChanges,"There should be no outgoing changes in the editor when pushChanges() is called. Use flush()"),e.prevLen!==this._textLength&&this._log.error("Incoming change for a wrong text len",{expected:this._textLength,incoming:e.prevLen}),this._ensureSelection((()=>{this._history.commit((()=>{this._applyingExternalChanges=!0,f.E.splitToDeleteThenInsert(e.delta).filter(f.E.nonEmpty).forEach((e=>{this.quill.updateContents((0,de.po)(e),Ie.toQuillSources(t))})),this._applyingExternalChanges=!1,this.flushChanges(t)}))})))},this.pushChanges=(e,t)=>{this._pushChanges(e,"api"===t?Ie.api:Ie.user)},this._text=null,this.getText=()=>(null===this._text&&(this._text=this.quill.getText()),this._text),this.getHTML=()=>(this.flushChanges(),this._editorEl.outerHTML),this.getTextLength=()=>this._textLength,this.getContents=(e,t)=>_.lY.unsafeRes(this._deltaFilter((0,de.y1)(this.quill.getContents(e,t)))),this.setCursor=(e,t=0,i="api")=>(0,c.pipe)(this._setNativeSelection({index:e,length:t,meta:{source:"api"===i?v.LN.Meta.Source.api:v.LN.Meta.Source.user,formatting:this.getFormatting(b.vY.create(e,t))}},"silent"===i),me.map((()=>{this.quill.setSelection(e,t,i)}))),this.scrollToTitle=()=>{this._scrollTo.next(this._getAnimation({scrollTop:0,animate:v.nA.initial},this._getScroll()))},this._getScrollRect=()=>(0,c.pipe)(this._scrollEl.getValue(),ue.map((e=>e.getBoundingClientRect()))),this._getScroll=()=>((0,pe.V1)(ue.isSome(this._scrollEl.getValue()),"DEd should be attached"),_e.$v(this._scrollEl.getValue()).scrollTop),this._normalizeScrollOffset=e=>{(0,pe.V1)(ue.isSome(this._scrollEl.getValue()),"DEd should be attached");const t=_e.$v(this._scrollEl.getValue()),i=t.scrollTop,s=t.scrollHeight-t.offsetHeight;return e+i<s?e+i>0?e:-i:s-i},this._setScroll=e=>((0,pe.V1)(ue.isSome(this._scrollEl.getValue()),"DEd should be attached"),_e.$v(this._scrollEl.getValue()).scrollTop=e),this._calculateViewport=e=>{const t=this.quill.root.getBoundingClientRect();return{text:(0,c.pipe)(he.Rect.intersection(e,t),ue.getOrElse((()=>t))),wrapper:e}},this.containsElement=e=>he.isParent(this.quill.root,e),this.getPossibleCursorPosition=(e,t,i=!1)=>{const s=this.viewport.value.text,n=(0,c.pipe)(e,me.fold(v.Yd.X.toViewport(s),l.identity)),r=(0,c.pipe)(t,me.fold(v.Yd.Y.toViewport(s),l.identity));return(0,c.pipe)(de.pi.getNativeCursorByPosition(n,r,s,this.quill.root,this._log.isEnabled(be.$.TRACE)||i),me.map(de.pi.getPositionByNativeCursor(this.quill.root)))},this.setFormatting=e=>{const t=Array.from(Object.entries(e.meta.formatting));if(0===t.length)return;const i=v.LN.toTextRange(e);t.length===v.M_.asList.length&&t.every((([e,t])=>!1===t||void 0===t))?this._clearFormatting(i):(0,c.pipe)(t,a.jB((([e,t])=>t)),(({left:e,right:t})=>{e.forEach((([e])=>this._removeFormatting(i,e))),t.forEach((([e])=>this._addFormatting(i,e)))}))},this._getFormattingFn=e=>(de.pR.isBlockFormat(e)?this.quill.formatLine:this.quill.formatText).bind(this.quill),this._allowNavigationTo=r.allowNavigationTo||(()=>!1),this.quill=this._initQuill(this._userClasses,e),this._marker=this.quill.getModule("marks"),this._history=this.quill.getModule("history"),this._clipboard=this.quill.getModule("clipboard"),this.textChangedAfterPaste=this._clipboard.textChangedAfterPaste,this.activeMarks=this._marker.activeMarks,this.hoveredMarks=this._marker.hoveredMarks,this.markChangeApplied=this._marker.markChangeApplied,this._quillEditorChange=(0,de.U3)(this.quill).pipe(ie.u()),this._contentChange=this._quillEditorChange.pipe(A.p((0,de.oF)(this._allowedAttrs)),ie.u()),this._log.isEnabled(be.$.DEBUG)&&function(e,t,i,s=ue.some){const n=e[t].bind(e);e[t]=(...e)=>((0,c.pipe)(s(...e),_e.Mi((e=>i.debug(`trace call of ${t}`,{args:e,stack:(new Error).stack})))),n(...e))}(this.quill,"updateContents",this._log.getLogger("quill.core"),((e,t)=>"user"!==t&&f.E.calcDiffLength(e)<0?ue.some({delta:f.E.anonymizeTextAndStringAttrs(e),source:t}):ue.none)),this.scrollPercentage=this.scrollPosition.pipe(se.z(this._scrollEl.pipe(se.z(V.h(T.R(window,"resize"),this._contentChange).pipe(K.B(500),ne.Z(x.q6)),(e=>e)),L.T((e=>(0,c.pipe)(e,ue.chain((e=>{const t=e.scrollHeight-e.clientHeight;return t>0?ue.some(t):ue.none}))))),w.F(ue.getEq(o.US).equals))),L.T((([e,t])=>(0,c.pipe)(t,ue.map((t=>e/t))))),w.F(ue.getEq(o.US).equals),ee.shareReplay({bufferSize:1,refCount:!0}));const h=this._quillEditorChange.pipe(A.p(de.vi),A.p((e=>Boolean(e)&&Boolean(e.range))));this._subs.push(this._contentChange.subscribe((({delta:e,source:t})=>{void 0!==e.ops&&(this._text=null,t===d.Ay.sources.USER?this._pushDelta(e):this._log.debug("skip emit",{source:t,textLength:this.getTextLength(),deltaLength:f.E.calcDiffLength(e),delta:f.E.anonymizeTextAndStringAttrs(e)}),this._setTextLength(this._textLength+f.E.calcDiffLength(e),t))})),this._contentChange.pipe(re.s(1)).subscribe((()=>(0,Se.TE)("dedChangeContent"))),V.h([this._historyChanged.pipe(A.p((({source:e})=>"keyboard"===e))),this._clipboard.clipboardShortcutUsed]).pipe(E.u(void 0)).subscribe(this.shortcutUsed),this._contentChange.pipe(L.T((e=>({type:e.delta.ops.some((e=>!f.E.isRetain(e)))?v.D_.Type.textMaybeWithFormatting:v.D_.Type.onlyFormatting,source:e.source,delta:e.delta})))).subscribe(this._contentUpdatedInternal),h.pipe(L.T((({range:{index:e,length:t},source:i})=>({index:e,length:t,meta:{source:Boolean(i)?i:v.LN.Meta.Source.user,formatting:this.getFormatting(b.vY.create(e,e+t))}}))),w.F(v.LN.eq.equals)).subscribe(this.selection),V.h(T.R(this.quill.root,"mousedown",{passive:!0}).pipe(E.u(!0)),T.R(document,"mouseup",{passive:!0}).pipe(E.u(!1)),T.R(document,"dragend",{passive:!0}).pipe(E.u(!1)),T.R(document,"click",{passive:!0}).pipe(E.u(!1))).pipe(F.n((0,ge.Sw)(T.R(document,"mousemove",{passive:!0}).pipe(ae.Z(50),A.p((()=>!window.getSelection().isCollapsed)),oe.$(),E.u(!0)),$.of(!1)))).subscribe(this.ongoingSelection),t.changes.subscribe((e=>this._pushChanges(e,Ie.dox))),this._changes.pipe(A.p(Be.isLocalDelta),Z.E("change")).subscribe(t.pushChanges),this.changes.pipe(L.T((()=>this._textLength)),w.F(),le.c(5*ye.mZ)).subscribe((e=>ve.Bx.TimeSeries.rootFemetrics.getTimer("text_length").recordTime(e)))),this.viewportRange=this.viewport.pipe(w.F(),se.z(this.scrollPosition),K.B(300),L.T((([{text:e}])=>(0,c.pipe)((0,l.tuple)((0,c.pipe)(de.pi.getNativeCursorByPosition(e.left,e.top,this.viewport.value.text,this.quill.root),me.map(de.pi.getPositionByNativeCursor(this.quill.root))),(0,c.pipe)(de.pi.getNativeCursorByPosition(e.right,e.bottom,this.viewport.value.text,this.quill.root),me.map(de.pi.getPositionByNativeCursor(this.quill.root)))),fe.fP(b.vY.create),me.fold((e=>(this._log.error("Cannot calculate viewportRange",e),b.vY.empty)),l.identity)))),ee.shareReplay({bufferSize:1,refCount:!0}))}}!function(e){class t extends Pe{fakeAttach(){this.attach(document.createElement("div"),document.createElement("div"),$.of(he.Rect.empty))}get mutationObserverPeriod(){return Boolean(MutationObserver._period)?MutationObserver._period:t.defaultMutationObserverPeriod}get container(){return this.quill.root}setContents(e,t=Ie.api){super.setContents(e,t)}getCursor(){return this._envSupportsSelection?super.getCursor():v.LN.empty}static create({modules:e,allowedAttrs:i,allowedEmbeds:s,options:n,dox:r}){return new t(e,i,s,n,r?ke.N.Mock(r):void 0)}constructor(e=t.DEFAULT_MODULES,i=f.E.skipAny,n=f.E.skipAny,r={},a=ke.N.Mock()){(0,de.gw)(),super(e,a,i,n,r),(0,s._)(this,"markChangeApplied",void 0),(0,s._)(this,"selectedFormatting",void 0),(0,s._)(this,"_envSupportsSelection",void 0),this.markChangeApplied=this._marker.markChangeApplied,this.selectedFormatting=new J.B7,this._envSupportsSelection=Boolean(window.getSelection),this._envSupportsSelection||Object.assign(this.quill,{setSelection:(e,t)=>{if(null===e)return;const i="object"==typeof e?e.index:e;(0,pe.V1)(i>=0,"range selection can not accept negative values")}})}}(0,s._)(t,"defaultMutationObserverPeriod",100),(0,s._)(t,"DEFAULT_MODULES",{modules:{history:we.U,clipboard:(0,Ce.g)(!1,[]),keyboard:Ee.TV.getKeyboardWithBindings(Ee.TV.Bindings.plainTextBindings),marks:xe.O},formats:[h.A,u.A,m.A,p.A]}),e.Mock=t}(Pe||(Pe={}));var Fe=i(91177)},61098:(e,t,i)=>{i.d(t,{z:()=>s});var s,n=i(23988),r=i(10334),a=i(17171),o=i(50659),l=i(80074),c=i(87574),d=i(80837),h=i(6987),p=i(54988),u=i(60269),m=i(65141),g=i(15491),_=i(78339),f=i(62822),y=i(95168),v=i(44297),b=i(50581),S=i(59636),k=i(7813),C=i(58889),w=i(69063);!function(e){e.getSelectionHOCs=e=>({withNeutralForSelection:t=>function(e,t){return class extends o.Component{componentDidMount(){this._subs.push(this._neutralForSelection(),...this._preventOnMouseMove())}componentWillUnmount(){this._subs.dispose()}render(){return o.createElement(e,(0,a._)((0,r._)({},this.props),{onMount:this._onMount}))}constructor(...e){super(...e),(0,n._)(this,"_el",l.s.create(v.none)),(0,n._)(this,"_subs",new d.y.Keeper),(0,n._)(this,"_onMount",(e=>{this._el.set(v.fromNullable(e)),this.props.onMount&&e&&this.props.onMount(e)})),(0,n._)(this,"_neutralForSelection",(()=>this._el.pipe(h.n(v.fold((()=>p.w),(e=>u.h(m.R(document,"mousedown").pipe(g.T((e=>e.target)),_.p((t=>!(t===e||b.isParent(e,t)))),f.u(!0)),m.R(document,"mouseup").pipe(f.u(!1))).pipe(y.M((t=>{e.style.pointerEvents=t?"none":"auto"}))))))).subscribe())),(0,n._)(this,"_preventOnMouseMove",(()=>{const e=l.s.create(!1);return[t.dontFreezeWhen(e,"prevent-focus"),this._el.pipe(h.n(v.fold((()=>p.w),(e=>u.h(m.R(e,"mousedown").pipe(f.u(!0)),m.R(e,"mouseup").pipe(f.u(!1)))))),y.M((t=>e.set(t)))).subscribe()]}))}}}(t,e),withSelectionEffect:(t,s)=>i.withSelectionEffect(t,e,s)});const t=e=>t=>o.createElement(e,t);let i;e.getPassThrough=()=>({withNeutralForSelection:t,withSelectionEffect:t}),e.Context=o.createContext(S.o.invariantContent("DenaliEditorSelection")),function(e){e.PlainContainer=({children:e,onMouseDown:t,onMount:i,className:s})=>o.createElement(c.F.div,{className:s,onMouseDown:t,mount:i},e),e.withSelectionEffect=function(e,t,i){return class extends o.Component{_onMouseDown(e){k.C.isLeftMouseButtom(e)&&i(t,e)}render(){return o.createElement(e,(0,a._)((0,r._)({},this.props),{onMouseDown:this._onMouseDown}))}}},e.collapse=(e,t)=>{const i=e.getCursor().index;C.getOrElse((e=>w.Bx.Logging.getLogger("Selection").error("Failed to set cursor on selection collapse",e,{index:i})))(e.setCursor(i+e.getCursor().length,0,"silent")),t.stopPropagation()},e.resetAsap=(e,t)=>{setTimeout((()=>{const{index:t,length:i}=e.getCursor();C.getOrElse((e=>w.Bx.Logging.getLogger("Selection").error("Failed to set cursor on selection reset.",e,{index:t,length:i})))(e.setCursor(t,i))}),0),t.stopPropagation()},e.prevent=(e,t)=>{t.stopPropagation()}}(i=e.Effect||(e.Effect={}))}(s||(s={}))},44011:(e,t,i)=>{i.r(t),i.d(t,{annotatorEmptyDocument:()=>l,bulkAcceptDemoText:()=>a,fullSentenceDemoText:()=>n,listTransformDemoText:()=>o,mutedAlertsDemoText:()=>r,premiumDemoDocument:()=>s});const s={title:"Welcome to Grammarly Premium!",text:""},n={title:"",text:"As many people in the Lima region wait with much hopeful anticipation for all of the impact Rhodes State College will have on our downtown area, many others have concerns due to the lack of activity after the demolition of most of the buildings downtown earlier this year.\n\nAs a business man with local interests, I have always tried to be as supportive as it is possible for me to be of our entire community. I can become passionte about all of the positive opportunities that arise. I could also become frustrated with all of the negative comments and roadblocks that stand in the way of the progress of our community.\n\nI feel it is time the public realizes and supports the impact this facility would have on the community and the reason the project has been slowed down.\n\nThe vision of the doctor and board to build a new medical school in the heart of our county and city is a model of community spirit and partnership for the betterment of so many aspects of our region. The 500 to 700 students and faculty that will be in our Town Square on a daily basis will bring foot traffic and youth, talent and opportunity. Many of the young people will fill many job openings and remain in our community for many years to come.\n\nAs a community full of positive thinkers and optimists, lets not just be passive and ask ourselves five years from now what could we have done! Let us all gather together and demand answers, demand progress and let our voices ring through city hall."},r={title:"",text:"Regarding our vaction policy, a decision was made to give everyone an extra day off. The decision was based on the fact that lots people are extra stressed now and not taking time off. We really hope that this will give everyone a good rest. If you have any comments or questions please send them to us promptly. The feedback has always been appreciated.\nAdditionally, please review the latest changes in our work from home police that have been updated this month. The new page was added to our Wiki. It includes a number of new recommendations on how to stay productive remotely."},a={title:"",text:"Welcome to the Grammarly Editor, the best place to write whats important.\n\nRed underlines mean that Grammarly has spotted a mistake in your writing. Youll sea one if you mispell something. (See what we did there?) Youll also see an underline, if you misuse a punctuation mark.If youre worry about typos or grammatical errors that could effect your credibility, Grammarly will helps you fix those to. Click any of Grammarlys suggested corrections to apply them to your text, or open a brief explanation to learn more about error and how to fix it.\n\nBut theres more to good writing than speling, punctuation and grammar. (Sorry, couldnt resist.)\n\nBrilliant sentences are clear and concise. Underlines that are blue indicate that Grammarly has spotted a sentence that is unnecessarily wordy. Grammarly scores each text based on how clear it will be to your readers and gives you guidance in order to do a revision of it in an effortless manner. Afterall, there are some sentences that are gramatically correct but still awkward and hard to follow. It goes without saying that sometimes you can actually improve a sentence by completely eliminating words that are basically unnecessary."},o={title:"",text:"The last few day have been full of a lot of thinking about what our goals should be for the development of great new features for our users. While there is a ton we could be doing, there's a few areas where I see us helping our users next year: making sure their message is clear and is able to get through to their readers, helping them sound friendlier and develop stronger and more authentic connections with their coworkers, appearing reputable with correct grammar and proper formatting, and feeling more confident about their writing. I hope you're all as excited by these opportunity as I am. The workmanship in our products will be evident to all of our users.  Send me your thoughts and any additional ideas by October 1st."},l={title:"",text:""}},92935:(e,t,i)=>{e.exports=i.p+"files/85c9adfbbe6c323245d2/mutedAlerts.mp4"},76387:(e,t,i)=>{e.exports=i.p+"files/eb5b3b9bc627c8b7bf87/mutedAlerts.png"},28882:e=>{e.exports=JSON.parse('{"Td":"_b7b0ef4d-view-firstTier","m$":"_363949ce-view-firstTierLoader _b7b0ef4d-view-firstTier","EN":"_7897b0b2-view-editor"}')},54730:e=>{e.exports=JSON.parse('{"FG":"_b2c6e27c-synonyms-contentWrapper","P0":"_08c665f9-synonyms-iconWrapper","wG":"_0c3de60c-synonyms-loader","AA":"_94add495-synonyms-synonymsPopupWrapper","iE":"_fbad2f66-synonyms-wrapper","Yu":"_c203692f-synonyms-emptyResultWrapper","PG":"_8adb8bf0-synonyms-activeWord","DD":"_738f37b5-synonyms-title","p_":"_602411e1-synonyms-list","Os":"_4fdf6736-synonyms-group","SZ":"_752acd81-synonyms-groupTitle","nM":"_44351849-synonyms-row","AS":"_2e566ea7-synonyms-item"}')},57791:e=>{e.exports=JSON.parse('{"yJ":"_b57d7ffb-header-fakeToolbarWrapper","Vv":"_83b0cecd-header-fakeToolbarTitle","hl":"_a0de5151-header-fakeToolbarTitleMacEditor","yu":"_00d699e4-header-toolbarBtn","j2":"_11861f7c-header-backIcon"}')},19101:e=>{e.exports=JSON.parse('{"EN":"_b4dbc6b7-denali-editor-editor","UH":"_38e369d9-denali-editor-graySelection"}')}}]);