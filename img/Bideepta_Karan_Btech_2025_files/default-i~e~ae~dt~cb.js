"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[1302],{34681:(e,t,i)=>{i.d(t,{n:()=>d,r:()=>p});var r=i(83531),n=i(23988),o=i(31784),s=i(30040),a=i(80172),c=i(10047),l=i(69063),g=i(93712);class d{get withoutAccessToken(){return{csrfToken:this.csrfToken,containerId:this.containerId,clientName:this.clientName,clientVersion:this.clientVersion}}constructor(e,t,i,o){(0,n._)(this,"_gnarClient",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_env",void 0),(0,n._)(this,"_oauthClient",void 0),(0,n._)(this,"_cookieStorage",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"csrfToken",void 0),(0,n._)(this,"containerId",void 0),(0,n._)(this,"clientName",void 0),(0,n._)(this,"clientVersion",void 0),(0,n._)(this,"accessToken",void 0),this._gnarClient=e,this._config=t,this._env=i,this._oauthClient=o,this._cookieStorage=new a.W6(this._config.domains.cookie),this._log=l.Bx.Logging.root.getLogger("base.fingerprints"),this.csrfToken=()=>this._cookieStorage.safeGetValue("csrf-token").then((e=>(Boolean(e)||this._log.warn("Missing CSRF token: token is empty"),e))).catch((e=>{throw this._log.warn("Missing CSRF token: error",e),e})),this.containerId=this._gnarClient.getContainerId(),this.clientName=this._env.names.auth,this.clientVersion=this._env.buildVersion;var s,c=this;this.accessToken=(s=this._env.platform)===g.OH.Platform.MACEDITOR||s===g.OH.Platform.IPAD?void 0:(0,r._)((function*(){try{return yield c._oauthClient(c.withoutAccessToken).getAccessToken()}catch(e){return}}))}}const u=(0,s.flow)(c.yU(["X-CSRF-Token","X-Container-Id","X-Client-Version","X-Client-Type","Authorization"]),c.pb((e=>void 0!==e[0])),c.Tj(o.wg),c.TS({},((e,[t,i])=>(e[t]=i,e))));function p(e){return()=>Promise.all([e.csrfToken(),e.containerId.catch(s.constUndefined),e.clientVersion.toString(),e.clientName,Promise.resolve("function"==typeof e.accessToken?e.accessToken():e.accessToken).then((e=>void 0===e?e:`Bearer ${e}`))]).then(u)}},91731:(e,t,i)=>{i.d(t,{Tr:()=>E,pq:()=>F});var r,n=i(23988),o=i(10334),s=i(17171),a=i(69384),c=i(60251),l=i(80172),g=i(99678),d=i(71483),u=i(98384),p=i(30514),h=i(19285),f=i(87840),_=i(88265),m=i(63724),v=i(48581),C=i(36840),b=i(86562),S=i(60172),w=i(69063),T=i(20739),y=i(74056),I=i(34681),k=i(60269),M=i(65141),O=i(62822),A=i(54988);class P{constructor(){(0,n._)(this,"generalActivity",k.h(M.R(window.document,"mousemove",{capture:!0,passive:!0}).pipe(O.u(void 0)),M.R(window.document,"wheel",{capture:!0,passive:!0}).pipe(O.u(void 0)),M.R(window.document,"keydown",{capture:!0,passive:!0}).pipe(O.u(void 0))))}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"generalActivity",A.w)}}}(r||(r={}));var E,x=i(8094);!function(e){e.create=({persistentApp:e,env:t,platformEnv:i,config:r,router:n,telemetryPageContext:a,createGnarStorages:_=q})=>{w.Bx.Logging.root.debug(`Constructing model for ${r.env} on the client`);const k=function(e,t,i=q){if("disabled"!==e.tracking.state){const{primaryStorage:r,altStorages:n}=i(e);return function(e,t,i,r,n){const o=e.api.gnarApi.url,s=new l.q2(i,r,new l.Mj(w.Bx.Logging.root.getLogger("gnar.containerIdManager"),w.Bx.TimeSeries.rootFemetrics.getMetric("gnar.containerIdManager")));return new l.Ob(o,n.names.tracking,n.buildVersion.toString(),t,s,new U(w.Bx.Logging.root.getLogger("gnar"),w.Bx.TimeSeries.rootFemetrics.getMetric("gnar")),!1,B)}(e,v.pM.request({target:"gnar",cache:"default"}),r,n,t)}{const e=new l.Aj;return e.getContainerId=()=>Promise.resolve("dummyContainerId"),e}}(r,t,_);k.getContainerId().then((e=>w.Bx.Logging.root.context.add({containerId:e}))).catch((e=>w.Bx.Logging.root.debug("cant get containerId",e)));const M=new I.n(k,r,t,F(window.location.origin,r.api.tokensUrl)),O=new P,A=function(e,t){switch(e){case y.OH.Platform.IPAD:return new T.BO(D(t));case y.OH.Platform.MACEDITOR:return new T.qb(D(t));case y.OH.Platform.WEB:return new T.vp(D(t));default:return(0,b.xb)(e)}}(t.platform,k),E=new T.Y$(k,O,r.pingMaybeGnarDelay,t);(0,C.hJ)("getEnv",(()=>t));const N=t.has(y.OH.Flag.useForceNoCacheOption)?"no-cache":"default",R=[v.pM.request({target:"manakin",cache:N}),{getApplicationHeaders:(0,I.r)(M)},r.env===S.OH.fb||r.env===S.OH.dev?"prod":r.env];return l=>l({persistentApp:e,authApi:new g.Nj(r.api.authUrl,d.j.createTE(v.pM.request({target:g.Nj.targetTag,cache:N})),M.withoutAccessToken),dapi:new m.lK(r.api.dapiUrl,d.j.createTE(v.pM.request({target:m.lK.targetTag,cache:N})),M),institution:new p.X9(r.api.institutionUrl,d.j.create(v.pM.request({target:p.X9.targetTag,cache:N})),M),treatmentService:new c.eb(...R),gateService:new c.mP(...R),subscriptionApi:new u.DI(r.api.subscriptionUrl,d.j.create(v.pM.request({target:u.DI.targetTag,cache:N})),M),settingsRegistryApi:new f.v(r.api.settingsRegistryUrl,d.j.createTE(v.pM.request({target:f.v.targetTag,cache:N})),M),telemetry:(0,s._)((0,o._)({gnarSpec:A},a),{bootstrap:E,getContainerId:k.getContainerId.bind(k)}),gnarClient:k,config:r,router:n,userActivity:O,env:t,platformEnv:i,fingerprints:M,vitoClient:new x.WG(M),passportClient:new h.t.PassportClient(r.api.passportUrl,d.j.create(v.pM.request({target:u.DI.targetTag,cache:N})),M)})}}(E||(E={}));class U{nextPingDateReadError(e){this._metric.getCounter("nextPingDate.read.failure").increment(),this._logger.warn("nextPingDate.read.failed",e)}nextPingDateWriteError(e){this._metric.getCounter("nextPingDate.write.failure").increment(),this._logger.warn("nextPingDate.write.failed",e)}sendError(){this._metric.getCounter("send.failure").increment()}trackBeforeSetUser(e){this._metric.getCounter("trackBeforeSetUser").increment(),this._logger.debug("trackBeforeSetUser",e)}constructor(e,t){(0,n._)(this,"_logger",void 0),(0,n._)(this,"_metric",void 0),this._logger=e,this._metric=t}}const B={ga:e=>(0,C.Yi)(),setUserId:e=>(0,C.Yi)(),getClientId:()=>Promise.resolve("disabled_GA")};function q(e){return{primaryStorage:new l.W6(e.domains.cookie),altStorages:[new l.DT,new l.XG]}}const F=(e,t)=>(0,C.Bj)((i=>new _.dN({clientId:i.clientName,redirectUri:e,domain:t,fetch:v.pM.request({target:"oauth",cache:"no-cache"}),httpClientOptions:{getApplicationHeaders:(0,I.r)(i)}})),((...e)=>{const[t]=e;return t.clientName}));function D(e){const t=w.Bx.Logging.root.getLogger("gnar.events");return(0,s._)((0,o._)({},e),{track:i=>{const{eventName:r}=i,n=(0,a._)(i,["eventName"]);return t.info(r,n),e.track(i).catch((e=>(t.error("Failed to track gnar event (modern)",{eventName:r,props:i,error:e}),Promise.resolve())))}})}},8094:(e,t,i)=>{i.d(t,{WG:()=>p,y9:()=>r});var r,n=i(83531),o=i(23988),s=i(38819),a=i(48581),c=i(36840),l=i(69063),g=i(704),d=i(34681),u=i(80029);class p{getFreeTrialEligibility(){return!(!this._eligibilitySpecialOffers||!this._eligibilitySpecialOffers.free_trial_rollout)&&this._eligibilitySpecialOffers.free_trial_rollout.eligibility}getFreeTrialEuUkEligibility(){return!(!this._eligibilitySpecialOffers||!this._eligibilitySpecialOffers.free_trial_eu_uk)&&this._eligibilitySpecialOffers.free_trial_eu_uk.eligibility}getFreeTrialForNewUsersEligibility(){return!(!this._eligibilitySpecialOffers||!this._eligibilitySpecialOffers.free_trial_new_users)&&this._eligibilitySpecialOffers.free_trial_new_users.eligibility}constructor(e){(0,o._)(this,"_fingerprints",void 0),(0,o._)(this,"_vitoClient",void 0),(0,o._)(this,"_eligibilitySpecialOffers",void 0),(0,o._)(this,"_initVitoClient",void 0),(0,o._)(this,"requestSpecialOffersEligibility",void 0),this._fingerprints=e;var t=this;this._initVitoClient=(0,n._)((function*(){const e=yield(0,d.r)(t._fingerprints)(),i=new s.Configuration({basePath:(0,u.W)().api.vito,fetchApi:a.pM.request({target:"vito",cache:"default"}),headers:{"X-CSRF-Token":e["X-CSRF-Token"],"X-Container-Id":e["X-Container-Id"],"X-Client-Version":e["X-Client-Version"],"X-Client-Type":e["X-Client-Type"]},credentials:"include"});t._vitoClient=new s.VitoApi(i)}));var i,r=this;this.requestSpecialOffersEligibility=(i=(0,n._)((function*(e){r._vitoClient||(yield r._initVitoClient());try{l.Bx.TimeSeries.rootFemetrics.getMetric(g.b.Metrics.SpecialOfferEligibility).getCounter(g.b.MetricsActions.RequestAttemptsTotal).increment(),r._eligibilitySpecialOffers=yield r._vitoClient.specialOffersGet({names:e}),l.Bx.TimeSeries.rootFemetrics.getMetric(g.b.Metrics.SpecialOfferEligibility).getCounter(g.b.MetricsActions.RequestSuccessTotal).increment()}catch(t){l.Bx.Logging.getLogger("VitoService").error(`Special offer eligibility request failed: ${e}`,t),l.Bx.TimeSeries.rootFemetrics.getMetric(g.b.Metrics.SpecialOfferEligibility).getCounter(g.b.MetricsActions.RequestFailuresTotal).increment()}})),function(e){return i.apply(this,arguments)}),this._initVitoClient()}}!function(e){e.Mock=class{constructor(){(0,o._)(this,"requestSpecialOffersEligibility",(()=>c.Yi)),(0,o._)(this,"getFreeTrialEligibility",(()=>!1)),(0,o._)(this,"getFreeTrialEuUkEligibility",(()=>!1)),(0,o._)(this,"getFreeTrialForNewUsersEligibility",(()=>!1))}}}(r||(r={}))},704:(e,t,i)=>{var r,n;i.d(t,{P:()=>r,b:()=>n}),function(e){let t,i,r,n,o;!function(e){e.GetPremiumButton="get_premium_button"}(t=e.Metrics||(e.Metrics={})),function(e){e.Click="clicks",e.Show="shows",e.Dismiss="dismisses"}(i=e.MetricsActions||(e.MetricsActions={})),function(e){e.AdvancedIssues="advancedIssues",e.Tooltip="tooltip",e.Navigation="navigation"}(r=e.UpgradeHookName||(e.UpgradeHookName={})),function(e){e.Assistant="assistant",e.Sidebar="sidebar",e.PlagiarismTooltip="plagiarismTooltip",e.ProofreadingTooltip="proofreadingTooltip"}(n=e.UpgradeHookSlot||(e.UpgradeHookSlot={})),function(e){e.premium="premium",e.premiumTrial="premiumTrial",e.pro="pro"}(o=e.UpgradeHookVariant||(e.UpgradeHookVariant={}))}(r||(r={})),function(e){let t,i;!function(e){e.SpecialOfferEligibility="special_offer_eligibility"}(t=e.Metrics||(e.Metrics={})),function(e){e.RequestAttemptsTotal="request_attempts_total",e.RequestSuccessTotal="request_success_total",e.RequestFailuresTotal="request_failures_total"}(i=e.MetricsActions||(e.MetricsActions={}))}(n||(n={}))},16721:(e,t,i)=>{i.d(t,{Y:()=>r});var r,n=i(50659),o=i(63336),s=i(39212),a=i.n(s),c=i(80172),l=i(59636),g=i(38908),d=i(44297),u=i(23121),p=i(58889),h=i(20739);!function(e){var t=e.Context=n.createContext(l.o.invariantContent("Telemetry.Context")),i=e.createPageSessionId=()=>g.G7(10),r=e.ContextProvider=e=>n.createElement(t.Provider,{value:Object.create({},{gnarSpec:{get:()=>e.gnarSpec},pageId:{get:()=>e.pageId},pageSessionId:{get:()=>e.pageSessionId},getSessionUuid:{get:()=>e.sessionUuidGetter},sessionUuid:{get:()=>(0,o.pipe)(e.sessionUuidGetter(),d.getOrElse((()=>"")))},docId:{get:()=>{if(Boolean(e.docId))return e.docId;throw new Error("docId is not specified. Please provide it thru the PageContextProvider")}},isTouchDevice:{get:()=>(0,o.pipe)(u.zb(a()),p.getOrElse((()=>!1)))}})},n.Children.only(e.children));e.ContextProviderInherited=e=>n.createElement(t.Consumer,null,(i=>n.createElement(t.Provider,{value:Object.create({},{gnarSpec:{get:()=>i.gnarSpec},pageId:{get:()=>Boolean(e.pageId)?e.pageId:i.pageId},pageSessionId:{get:()=>i.pageSessionId},docId:{get:()=>Boolean(e.docId)?e.docId:i.docId},isTouchDevice:{get:()=>(0,o.pipe)(u.zb(a()),p.getOrElse((()=>!1)))}})},n.Children.only(e.children)))),e.ContextProviderMock=e=>n.createElement(r,{gnarSpec:new h.vp(new c.Aj),pageId:Boolean(e.pageId)?e.pageId:"mockPageId",pageSessionId:i(),docId:Boolean(e.docId)?e.docId:"mockDocId",sessionUuidGetter:()=>d.none},e.children)}(r||(r={}))}}]);